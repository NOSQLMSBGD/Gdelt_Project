{"paragraphs":[{"text":"%dep\nz.reset()\nz.load(\"org.mongodb.spark:mongo-spark-connector_2.11:2.2.6\")","user":"anonymous","dateUpdated":"2019-01-24T13:36:19+0100","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res0: org.apache.zeppelin.dep.Dependency = org.apache.zeppelin.dep.Dependency@1a2ea6ae\n"}]},"apps":[],"jobName":"paragraph_1548333379715_1925693459","id":"20190118-150551_1969200344","dateCreated":"2019-01-24T13:36:19+0100","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:16968"},{"text":"%md\n## IMPORTS des classes utiles\n\nTout jusqu'à spark.sql mais pas mongo.sql à cause des conflits de nom de classe\n","user":"anonymous","dateUpdated":"2019-01-24T14:39:52+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>IMPORTS des classes utiles</h2>\n<p>Tout jusqu&rsquo;à spark.sql mais pas mongo.sql à cause des conflits de nom de classe</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548333401401_-637751001","id":"20190124-133641_1420832651","dateCreated":"2019-01-24T13:36:41+0100","dateStarted":"2019-01-24T14:39:52+0100","dateFinished":"2019-01-24T14:39:52+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16969"},{"text":"// IMPORTS \nimport sys.process._\nimport java.net.URL\nimport java.io.File\nimport java.nio.file.{Files, StandardCopyOption}\nimport java.net.HttpURLConnection\nimport org.apache.spark.sql\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.SQLContext\nimport org.apache.spark.input.PortableDataStream\nimport java.util.zip.ZipInputStream\nimport java.io.{BufferedReader, InputStreamReader}\nimport org.apache.spark.rdd\nimport org.bson.Document\n\nval sqlContext = new SQLContext(sc)\n\n\n","user":"anonymous","dateUpdated":"2019-01-24T13:36:41+0100","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import sys.process._\nimport java.net.URL\nimport java.io.File\nimport java.nio.file.{Files, StandardCopyOption}\nimport java.net.HttpURLConnection\nimport org.apache.spark.sql\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.SQLContext\nimport org.apache.spark.input.PortableDataStream\nimport java.util.zip.ZipInputStream\nimport java.io.{BufferedReader, InputStreamReader}\nimport org.apache.spark.rdd\nimport org.bson.Document\nwarning: there was one deprecation warning; re-run with -deprecation for details\nsqlContext: org.apache.spark.sql.SQLContext = org.apache.spark.sql.SQLContext@38b1b138\n"}]},"apps":[],"jobName":"paragraph_1548333379720_-49077790","id":"20190118-150556_2015457198","dateCreated":"2019-01-24T13:36:19+0100","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16970"},{"text":"%md\n\n## Environnement\n\nLes modifs sur les variables d'environnement / config de spark\nInfos de bucket S3","user":"anonymous","dateUpdated":"2019-01-24T13:40:55+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Environnement</h2>\n<p>Les modifs sur les variables d&rsquo;environnement / config de spark<br/>Infos de bucket S3</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548333580904_1185990093","id":"20190124-133940_935706172","dateCreated":"2019-01-24T13:39:40+0100","dateStarted":"2019-01-24T13:40:55+0100","dateFinished":"2019-01-24T13:40:55+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16971"},{"text":"//import org.apache.spark.SparkConf\n\nspark.conf.set(\"spark.driver.maxResultSize\",\"0\") //0 means unlimited\nspark.conf.set(\"spark.driver.memory\", \"2g\")\nspark.conf.set(\"spark.executor.memory\", \"2g\")\n\nspark.conf.set(\"spark.scheduler.mode\",\"FIFO\")\nspark.conf.set(\"spark.speculation\",\"false\")\nspark.conf.set(\"spark.reducer.maxSizeInFlight\",\"64m\") //défaut 48m\nspark.conf.set(\"spark.serializer\",\"org.apache.spark.serializer.KryoSerializer\") //bonne option recommandée\nspark.conf.set(\"spark.kryoserializer.buffer.max\",\"1g\") // valeur par défaut 64Mo !\nspark.conf.set(\"spark.shuffle.file.buffer\",\"64k\") //default 32k\n\nimport spark.implicits._\n\nspark.sparkContext.hadoopConfiguration.set(\"fs.s3a.access.key\", \"XXX\") // mettre votre ID du fichier credentials.csv\nspark.sparkContext.hadoopConfiguration.set(\"fs.s3a.secret.key\", \"YYY\") // mettre votre secret du fichier credentials.csv\nspark.sparkContext.hadoopConfiguration.set(\"fs.s3a.connection.maximum\",\"1000\")","user":"anonymous","dateUpdated":"2019-01-24T13:40:54+0100","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import spark.implicits._\n"}]},"apps":[],"jobName":"paragraph_1548333379721_-1115565632","id":"20190118-150728_206248882","dateCreated":"2019-01-24T13:36:19+0100","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16972"},{"text":"%md\n## CONSTANTES\n\n(à adapter pour passer d'un environnement local à AWS ou d'un cluster à un autre)","user":"anonymous","dateUpdated":"2019-01-24T13:43:53+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>CONSTANTES</h2>\n<p>(à adapter pour passer d&rsquo;un environnement local à AWS ou d&rsquo;un cluster à un autre)</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548333661877_-1566028917","id":"20190124-134101_1284477425","dateCreated":"2019-01-24T13:41:01+0100","dateStarted":"2019-01-24T13:43:53+0100","dateFinished":"2019-01-24T13:43:53+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16973"},{"text":"val IP_MASTER = \"172.31.33.253\"\nval IP_SLAVE1 = \"172.31.44.85\"\nval IP_SLAVE2 = \"172.31.47.231\"\n\nval MONGO_URI = \"mongodb://\"+ IP_MASTER +\":27017,\"+IP_MASTER +\":27018,\"+IP_SLAVE1 +\":27019,\"+IP_SLAVE1 +\":27020,\"+ IP_SLAVE2 +\":27021,\"+IP_SLAVE2 +\":27022/Gdelt.\"\n\n// collections Stable 1ere etape en batchs append\nval MONGO_URI_REQUETE1 = MONGO_URI + \"Requete1\"\nval MONGO_URI_REQUETE2 = MONGO_URI + \"Requete2\"\nval MONGO_URI_REQUETE31 = MONGO_URI + \"Requete31\"\nval MONGO_URI_REQUETE5 = MONGO_URI + \"Requete5\"\n\n// collections Stable 2e etage consolidations globale overwrite\nval MONGO_URI_REQUETE32 = MONGO_URI + \"Requete32\"\nval MONGO_URI_REQUETE42 = MONGO_URI + \"Requete42\"\nval MONGO_URI_REQUETE5BIS = MONGO_URI + \"Requete5bis\"\n\n// anciennes colonnes/contenu NE PLUS UTILISER\n// ET1\nval MONGO_URI_REQUETE3 = MONGO_URI + \"Requete3\"\n// ET2\nval MONGO_URI_REQUETE3BIS = MONGO_URI + \"Requete3Bis\"\nval MONGO_URI_REQUETE4 = MONGO_URI + \"Requete4\"\n\n\n// fichiers de \"decode\" pour rendu des dropdown\nval LOCAL_SRC_CAMEOEVENTCODE = \"s3a://stephane-mulard-telecom-gdelt2018/CAMEO.eventcodes.txt\"\nval LOCAL_SRC_CAMEOCOUNTRYCODE = \"s3a://stephane-mulard-telecom-gdelt2018/CAMEO.country.txt\"\nval LOCAL_SRC_FIPSCOUNTRYCODE = \"s3a://stephane-mulard-telecom-gdelt2018/FIPS.country.txt\"\n\n\n// Inutile (chargement uniquement ??)\nval LOCAL_DATA_ZIP_PATH = \"s3a://stephane-mulard-telecom-gdelt2018\"\n\nval GDELT_SRC_CAMEOEVENTCODE = \"https://www.gdeltproject.org/data/lookups/CAMEO.eventcodes.txt\"\nval GDELT_SRC_CAMEOCOUNTRYCODE = \"https://www.gdeltproject.org/data/lookups/CAMEO.country.txt\"\nval GDELT_SRC_FIPSCOUNTRYCODE = \"https://www.gdeltproject.org/data/lookups/FIPS.country.txt\"\n\n","user":"anonymous","dateUpdated":"2019-01-24T13:52:34+0100","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"IP_MASTER: String = 172.31.33.253\nIP_SLAVE1: String = 172.31.44.85\nIP_SLAVE2: String = 172.31.47.231\nMONGO_URI: String = mongodb://172.31.33.253:27017,172.31.33.253:27018,172.31.44.85:27019,172.31.44.85:27020,172.31.47.231:27021,172.31.47.231:27022/Gdelt.\nMONGO_URI_REQUETE1: String = mongodb://172.31.33.253:27017,172.31.33.253:27018,172.31.44.85:27019,172.31.44.85:27020,172.31.47.231:27021,172.31.47.231:27022/Gdelt.Requete1\nMONGO_URI_REQUETE2: String = mongodb://172.31.33.253:27017,172.31.33.253:27018,172.31.44.85:27019,172.31.44.85:27020,172.31.47.231:27021,172.31.47.231:27022/Gdelt.Requete2\nMONGO_URI_REQUETE3: String = mongodb://172.31.33.253:27017,172.31.33.253:27018,172.31.44.85:27019,172.31.44.85:27020,172.31.47.231:27021,172.31.47.231:27022/Gdelt.Requete3\nMONGO_URI_REQUETE4: String = mongodb://172.31.33.253:27017,172.31.33.253:27018,172.31.44.85:27019,172.31.44.85:27020,172.31.47.231:27021,172.31.47.231:27022/Gdelt.Requete4\nMONGO_URI_REQUETE5: String = mongodb://172.31.33.253:27017,172.31.33.253:27018,172.31.44.85:27019,172.31.44.85:27020,172.31.47.231:27021,172.31.47.231:27022/Gdelt.Requete5\nMONGO_URI_REQUETE3BIS: String = mongodb://172.31.33.253:27017,172.31.33.253:27018,172.31.44.85:27019,172.31.44.85:27020,172.31.47.231:27021,172.31.47.231:27022/Gdelt.Requete3Bis\nMONGO_URI_REQUETE31: String = mongodb://172.31.33.253:27017,172.31.33.253:27018,172.31.44.85:27019,172.31.44.85:27020,172.31.47.231:27021,172.31.47.231:27022/Gdelt.Requete31\nMONGO_URI_REQUETE32: String = mongodb://172.31.33.253:27017,172.31.33.253:27018,172.31.44.85:27019,172.31.44.85:27020,172.31.47.231:27021,172.31.47.231:27022/Gdelt.Requete32\nMONGO_URI_REQUETE42: String = mongodb://172.31.33.253:27017,172.31.33.253:27018,172.31.44.85:27019,172.31.44.85:27020,172.31.47.231:27021,172.31.47.231:27022/Gdelt.Requete42\nMONGO_URI_REQUETE52: String = mongodb://172.31.33.253:27017,172.31.33.253:27018,172.31.44.85:27019,172.31.44.85:27020,172.31.47.231:27021,172.31.47.231:27022/Gdelt.Requete52\nMONGO_URI_REQUETE5BIS: String = mongodb://172.31.33.253:27017,172.31.33.253:27018,172.31.44.85:27019,172.31.44.85:27020,172.31.47.231:27021,172.31.47.231:27022/Gdelt.Requete5bis\nLOCAL_DATA_ZIP_PATH: String = s3a://stephane-mulard-telecom-gdelt2018\nLOCAL_SRC_CAMEOEVENTCODE: String = s3a://stephane-mulard-telecom-gdelt2018/CAMEO.eventcodes.txt\nLOCAL_SRC_CAMEOCOUNTRYCODE: String = s3a://stephane-mulard-telecom-gdelt2018/CAMEO.country.txt\nLOCAL_SRC_FIPSCOUNTRYCODE: String = s3a://stephane-mulard-telecom-gdelt2018/FIPS.country.txt\nGDELT_SRC_CAMEOEVENTCODE: String = https://www.gdeltproject.org/data/lookups/CAMEO.eventcodes.txt\nGDELT_SRC_CAMEOCOUNTRYCODE: String = https://www.gdeltproject.org/data/lookups/CAMEO.country.txt\nGDELT_SRC_FIPSCOUNTRYCODE: String = https://www.gdeltproject.org/data/lookups/FIPS.country.txt\n"}]},"apps":[],"jobName":"paragraph_1548333379721_1154135133","id":"20190118-152612_1675243185","dateCreated":"2019-01-24T13:36:19+0100","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16974"},{"text":"%md\n## Petites Fonctions\n- fonctions de cast\n- chargement et Lecture des fichiers de decode pour les dropdown voire les requettes d'affichage\n- données de \"decode\" directement dans le code pour les dropdown","user":"anonymous","dateUpdated":"2019-01-24T13:54:34+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Petites Fonctions</h2>\n<ul>\n  <li>fonctions de cast</li>\n  <li>chargement et Lecture des fichiers de decode pour les dropdown voire les requettes d&rsquo;affichage</li>\n  <li>données de &ldquo;decode&rdquo; directement dans le code pour les dropdown</li>\n</ul>\n</div>"}]},"apps":[],"jobName":"paragraph_1548334361467_1403539551","id":"20190124-135241_1927928642","dateCreated":"2019-01-24T13:52:41+0100","dateStarted":"2019-01-24T13:54:34+0100","dateFinished":"2019-01-24T13:54:34+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16975"},{"text":"\n\n\n\n// Fonction qui permet de créer une table des codes events cameo\ndef createCameoEventCodesTable() : String = {\n    sqlContext.read.\n        option(\"delimiter\",\"\\t\").\n        option(\"infer_schema\",\"true\").\n        option(\"header\", \"True\").\n        csv(LOCAL_SRC_CAMEOEVENTCODE).\n        withColumnRenamed(\"_c0\",\"code\").\n        withColumnRenamed(\"_c1\",\"desc\").\n        createOrReplaceTempView(\"cameoEvents\")\n\n    spark.catalog.cacheTable(\"cameoEvents\")\n    return \"cameoEvents\"\n}\n\n// Fonction qui permet de créer une table des codes events cameo\ndef createFIPSCountryCodesTable() : String = {\n    sqlContext.read.\n        option(\"delimiter\",\"\\t\").\n        option(\"infer_schema\",\"true\").\n        option(\"header\", \"False\").\n        csv(LOCAL_SRC_FIPSCOUNTRYCODE).\n        withColumnRenamed(\"_c0\",\"code\").\n        withColumnRenamed(\"_c1\",\"desc\").\n        createOrReplaceTempView(\"fipsCountries\")\n\n    spark.catalog.cacheTable(\"fipsCountries\")\n    return \"fipsCountries\"\n}\n\n// Fonction qui permet de créer une table des codes events cameo\ndef createCameoCountryCodesTable() : String = {\n    sqlContext.read.\n        option(\"delimiter\",\"\\t\").\n        option(\"infer_schema\",\"true\").\n        option(\"header\", \"True\").\n        csv(LOCAL_SRC_CAMEOCOUNTRYCODE).\n        withColumnRenamed(\"CODE\",\"code\").\n        withColumnRenamed(\"LABEL\",\"desc\").\n        createOrReplaceTempView(\"cameoCountries\")\n\n    spark.catalog.cacheTable(\"cameoCountries\")\n    return \"cameoCountries\"\n}\n\n// Fonction qui récupère la liste des valeurs d'une table de référence avec 2 colonnes\ndef listcodes(table: String) : Seq[(String, String)] = {\n  spark.sql(\"select * from \" + table).collect.map(x => ((x(0).asInstanceOf[String], x(1).asInstanceOf[String])))\n}\n\ndef getMonths () : Object = {\n     z.select(\"Mois\", \"12\", Seq((\"01\",\"Janvier\"),(\"02\",\"Février\"),(\"03\",\"Mars\"),(\"04\",\"Avril\"),(\"05\",\"Mai\"),(\"06\",\"Juin\"),(\"07\",\"Juillet\"),(\"08\",\"Août\"),(\"09\",\"Septembre\"),(\"10\",\"Octobre\"),(\"11\",\"Novembre\"),(\"12\",\"Décembre\")))\n}\n\n\ndef getLangues () : Object = {\n    z.select( \"Langue\", \"eng\", Seq(\n        (\"afr\",\"Afrikaans\"),(\"ara\",\"Arabe\"),(\"axe\",\"Azéri\"),(\"ben\",\"Bengali\"),\n(\"bos\",\"Bosnien\"),(\"bul\",\"Bulgare\"),(\"cat\",\"Catalan\"),(\"ces\",\"Tchèque\"),\n(\"dan\",\"Danois\"),(\"deu\",\"Allemand\"),(\"ell\",\"Grec moderne\"),(\"eng\",\"Anglais\"),\n(\"est\",\"Estonien\"),(\"fas\",\"Persan\"),(\"fin\",\"Finnois\"),(\"fra\",\"Français\"),\n(\"glg\",\"Galicien\"),(\"guj\",\"Gujarati\"),(\"heb\",\"Hébreu\"),(\"hin\",\"Hindi\"),\n(\"hrv\",\"Croate\"),(\"hun\",\"Hongrois\"),(\"hye\",\"Arménien\"),(\"ind\",\"Indonésien\"),\n(\"isl\",\"Islandais\"),(\"ita\",\"Italien\"),(\"jpn\",\"Japonais\"),(\"kan\",\"Kannada\"),\n(\"kat\",\"Géorgien\"),(\"kaz\",\"Kazakh\"),(\"kor\",\"Coréen\"),(\"lav\",\"Letton\"),\n(\"lit\",\"Lituanien\"),(\"mal\",\"Malayalam\"),(\"mar\",\"Marathi\"),(\"mkd\",\"Macédonien\"),\n(\"mon\",\"Mongol\"),(\"msa\",\"Malais\"),(\"nep\",\"Népalais\"),(\"nld\",\"Néerlandais\"),\n(\"nno\",\"Norvégien Nynorsk\"),(\"nor\",\"Norvégien\"),(\"pan\",\"Pendjabi\"),(\"pol\",\"Polonais\"),\n(\"por\",\"Portugais\"),(\"ron\",\"Roumain\"),(\"rus\",\"Russe\"),\n(\"sin\",\"Cingalais\"),(\"slk\",\"Slovaque\"),(\"slv\",\"Slovène\"),\n(\"som\",\"Somali\"),(\"spa\",\"Espagnol\"),(\"sqi\",\"Albanais\"),\n(\"srp\",\"Serbe\"),(\"swa\",\"Swahili\"),(\"swe\",\"Suédois\"),\n(\"tam\",\"Tamoul\"),(\"tel\",\"Télougou\"),(\"tha\",\"Thaï\"),\n(\"tur\",\"Turc\"),(\"ukr\",\"Ukrainien\"),(\"urd\",\"Ourdou\"),\n(\"vie\",\"Vietnamien\"),(\"zho\",\"Chinois\")\n))\n}\n\ndef getDays() : Object = {\n    var jours = Seq[(String, String)]()\n    for(i<- 1 to 31){\n        jours = jours :+ (f\"${i}%02d\",f\"${i}%02d\")\n    }\n    return z.select(\"Jour\",\"01\", jours)\n}\n\n\ndef toDouble(s : String): Double = {\n    if(s.isEmpty) {\n        0\n    }\n    else {\n        try\n        {\n            s.toDouble\n        }\n        catch { case _:  Throwable => 0 }\n    }\n    \n}\n\ndef toInt(s : String): Int = {\n    if(s.isEmpty) {\n        0\n    }\n    else {\n        try\n        {\n            s.toInt\n        }\n        catch { case _:  Throwable => 0 }\n    }\n}\n\ndef toBigInt(s : String): BigInt = {\n    if(s.isEmpty) {\n        BigInt(0)\n    }\n    else {\n        try\n        {\n            BigInt(s)\n        }\n        catch { case _:  Throwable =>  BigInt(0) }\n    }\n}\n","user":"anonymous","dateUpdated":"2019-01-24T13:55:49+0100","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"createCameoEventCodesTable: ()String\ncreateFIPSCountryCodesTable: ()String\ncreateCameoCountryCodesTable: ()String\nlistcodes: (table: String)Seq[(String, String)]\ngetMonths: ()Object\ngetLangues: ()Object\ngetDays: ()Object\ntoDouble: (s: String)Double\ntoInt: (s: String)Int\ntoBigInt: (s: String)BigInt\n"}]},"apps":[],"jobName":"paragraph_1548333379722_-1072600932","id":"20190118-151211_345692492","dateCreated":"2019-01-24T13:36:19+0100","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16976"},{"text":"%md\n# Mise en memoire des tables de decode","user":"anonymous","dateUpdated":"2019-01-24T13:56:15+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Mise en memoire des tables de decode</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1548334553115_1205508221","id":"20190124-135553_1102792633","dateCreated":"2019-01-24T13:55:53+0100","dateStarted":"2019-01-24T13:56:15+0100","dateFinished":"2019-01-24T13:56:15+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16977"},{"text":"createCameoEventCodesTable()\ncreateCameoCountryCodesTable()\ncreateFIPSCountryCodesTable()","user":"anonymous","dateUpdated":"2019-01-24T13:36:19+0100","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res25: String = cameoEvents\nres26: String = cameoCountries\nres27: String = fipsCountries\n"}]},"apps":[],"jobName":"paragraph_1548333379723_-1473043925","id":"20190122-100336_2283525","dateCreated":"2019-01-24T13:36:19+0100","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16978"},{"text":"%md\n## Imports mongo\n(ne plus utiliser du code avec apache.spark.sql à partir de ce point)","user":"anonymous","dateUpdated":"2019-01-24T13:58:22+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Imports mongo</h2>\n<p>(ne plus utiliser du code avec apache.spark.sql à partir de ce point)</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548334584955_-1300391506","id":"20190124-135624_6934698","dateCreated":"2019-01-24T13:56:24+0100","dateStarted":"2019-01-24T13:58:22+0100","dateFinished":"2019-01-24T13:58:22+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16979"},{"text":"import com.mongodb.spark._\nimport com.mongodb.spark.config._","user":"anonymous","dateUpdated":"2019-01-24T13:36:19+0100","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import com.mongodb.spark._\nimport com.mongodb.spark.config._\n"}]},"apps":[],"jobName":"paragraph_1548333379723_-113805537","id":"20190122-131437_38752288","dateCreated":"2019-01-24T13:36:19+0100","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16980"},{"text":"%md\nfin des imports pré demo. Maintenant on peut requeter les données comme une appli client.\n\n# DEMO\n\n## Requete 1 : compteurs event et mension par jour,pays,langue :","user":"anonymous","dateUpdated":"2019-01-24T14:09:31+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>fin des imports pré demo. Maintenant on peut requeter les données comme une appli client.</p>\n<h1>DEMO</h1>\n<h2>Requete 1 : compteurs event et mension par jour,pays,langue :</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1548334712481_995742065","id":"20190124-135832_1726502784","dateCreated":"2019-01-24T13:58:32+0100","dateStarted":"2019-01-24T14:09:31+0100","dateFinished":"2019-01-24T14:09:31+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16981"},{"text":"// Lecture Requete 1 depuis Mongo\n\n// Requete1 : très peu de données splittées sur plusieurs batch\n// le groupement de 1er etage des batch par JOUR fait qu'en jouant tous les batch SANS 2e etage global\n// on a de l'ordre de 3 à 5 entrées utiles si on filtre sur les 3 input, donc on laisse le group by et on n'a pas besoin de 2e consolidation\n\n// On charge le lien vers MongoDB\nval Requete1FromMongo = MongoSpark.\n                        load(sc, ReadConfig(Map(\"uri\" -> MONGO_URI_REQUETE1)) ).\n                        toDF()\n\n// formalisme sql\nRequete1FromMongo.createOrReplaceTempView(\"TableRequete1\")\n\n// creation des dropdown/inputs pour zeppelin : ils n'apparaissent dans le notebook que quand on execute la  cellule \n// donc autant mettre des valeurs par defaut pour avoir deja un visuel dès la première execution\n// au lieu d'avoir un retour vide si on execute la requete avec des valeurs vides qui n'ont pas d'entrées en base\n\nval dd_fipsCountry = z.select(\"Fips Country codes\", \"FR\", listcodes(\"fipsCountries\"))\n//val cameoEvents = z.select(\"Cameo events codes\", listcodes(\"cameoEvents\"))\nval dd_Langue = z.select(\"Langue\", \"eng\", listcodes(\"fipsCountries\"))\n\nval mois = getMonths()\nvar jour = getDays()\nval mylangue = getLangues()\n\n// la query eventuellement à mettre dans une autre appli \nz.show(spark.sql(\"\"\"\nselect\n-- invert comments from next 2 lines once clean data if 2nd stage is added :\n-- Jour, CodePays, Langue, NbEvents, NbMentions\nJour, CodePays, Langue, sum(NbEvents) NbEvents, sum(NbMentions) NbMentions\n\nfrom TableRequete1\nwhere CodePays ='\"\"\" + dd_fipsCountry  +\"\"\"'  \nand Jour = '2018\"\"\" + mois + jour + \"\"\"' \nand Langue ='\"\"\" + mylangue  +\"\"\"'  \n\n-- comment next line if clean data\ngroup by CodePays,Jour,Langue\n\"\"\"))\n\n","user":"anonymous","dateUpdated":"2019-01-24T14:09:19+0100","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"runOnSelectionChange":true,"results":{"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Jour":"string","CodePays":"string","Langue":"string","NbEvents":"string","NbMentions":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{"Fips Country codes":"FR","Mois":"12","Jour":"10","Langue":"fra"},"forms":{"Fips Country codes":{"type":"Select","options":[{"value":"AF","displayName":"Afghanistan","$$hashKey":"object:17452"},{"value":"AX","displayName":"Akrotiri Sovereign Base Area","$$hashKey":"object:17453"},{"value":"AL","displayName":"Albania","$$hashKey":"object:17454"},{"value":"AG","displayName":"Algeria","$$hashKey":"object:17455"},{"value":"AQ","displayName":"American Samoa","$$hashKey":"object:17456"},{"value":"AN","displayName":"Andorra","$$hashKey":"object:17457"},{"value":"AO","displayName":"Angola","$$hashKey":"object:17458"},{"value":"AV","displayName":"Anguilla","$$hashKey":"object:17459"},{"value":"AY","displayName":"Antarctica","$$hashKey":"object:17460"},{"value":"AC","displayName":"Antigua and Barbuda","$$hashKey":"object:17461"},{"value":"AR","displayName":"Argentina","$$hashKey":"object:17462"},{"value":"AM","displayName":"Armenia","$$hashKey":"object:17463"},{"value":"AA","displayName":"Aruba","$$hashKey":"object:17464"},{"value":"AT","displayName":"Ashmore and Cartier Islands","$$hashKey":"object:17465"},{"value":"AS","displayName":"Australia","$$hashKey":"object:17466"},{"value":"AU","displayName":"Austria","$$hashKey":"object:17467"},{"value":"AJ","displayName":"Azerbaijan","$$hashKey":"object:17468"},{"value":"BF","displayName":"Bahamas, The","$$hashKey":"object:17469"},{"value":"BA","displayName":"Bahrain","$$hashKey":"object:17470"},{"value":"FQ","displayName":"Baker Island","$$hashKey":"object:17471"},{"value":"BG","displayName":"Bangladesh","$$hashKey":"object:17472"},{"value":"BB","displayName":"Barbados","$$hashKey":"object:17473"},{"value":"BS","displayName":"Bassas da India","$$hashKey":"object:17474"},{"value":"BO","displayName":"Belarus","$$hashKey":"object:17475"},{"value":"BE","displayName":"Belgium","$$hashKey":"object:17476"},{"value":"BH","displayName":"Belize","$$hashKey":"object:17477"},{"value":"BN","displayName":"Benin","$$hashKey":"object:17478"},{"value":"BD","displayName":"Bermuda","$$hashKey":"object:17479"},{"value":"BT","displayName":"Bhutan","$$hashKey":"object:17480"},{"value":"BL","displayName":"Bolivia","$$hashKey":"object:17481"},{"value":"BK","displayName":"Bosnia-Herzegovina","$$hashKey":"object:17482"},{"value":"BC","displayName":"Botswana","$$hashKey":"object:17483"},{"value":"BV","displayName":"Bouvet Island","$$hashKey":"object:17484"},{"value":"BR","displayName":"Brazil","$$hashKey":"object:17485"},{"value":"IO","displayName":"British Indian Ocean Territory","$$hashKey":"object:17486"},{"value":"VI","displayName":"British Virgin Islands","$$hashKey":"object:17487"},{"value":"BX","displayName":"Brunei","$$hashKey":"object:17488"},{"value":"BU","displayName":"Bulgaria","$$hashKey":"object:17489"},{"value":"UV","displayName":"Burkina Faso","$$hashKey":"object:17490"},{"value":"BY","displayName":"Burundi","$$hashKey":"object:17491"},{"value":"CB","displayName":"Cambodia","$$hashKey":"object:17492"},{"value":"CM","displayName":"Cameroon","$$hashKey":"object:17493"},{"value":"CA","displayName":"Canada","$$hashKey":"object:17494"},{"value":"CV","displayName":"Cape Verde","$$hashKey":"object:17495"},{"value":"CJ","displayName":"Cayman Islands","$$hashKey":"object:17496"},{"value":"CT","displayName":"Central African Republic","$$hashKey":"object:17497"},{"value":"CD","displayName":"Chad","$$hashKey":"object:17498"},{"value":"CI","displayName":"Chile","$$hashKey":"object:17499"},{"value":"CH","displayName":"China","$$hashKey":"object:17500"},{"value":"KT","displayName":"Christmas Island","$$hashKey":"object:17501"},{"value":"IP","displayName":"Clipperton Island","$$hashKey":"object:17502"},{"value":"CK","displayName":"Cocos Keeling Islands","$$hashKey":"object:17503"},{"value":"CO","displayName":"Colombia","$$hashKey":"object:17504"},{"value":"CN","displayName":"Comoros","$$hashKey":"object:17505"},{"value":"CF","displayName":"Congo","$$hashKey":"object:17506"},{"value":"CW","displayName":"Cook Islands","$$hashKey":"object:17507"},{"value":"CR","displayName":"Coral Sea Islands","$$hashKey":"object:17508"},{"value":"CS","displayName":"Costa Rica","$$hashKey":"object:17509"},{"value":"IV","displayName":"Cote dIvoire","$$hashKey":"object:17510"},{"value":"HR","displayName":"Croatia","$$hashKey":"object:17511"},{"value":"CU","displayName":"Cuba","$$hashKey":"object:17512"},{"value":"CY","displayName":"Cyprus","$$hashKey":"object:17513"},{"value":"EZ","displayName":"Czech Republic","$$hashKey":"object:17514"},{"value":"LO","displayName":"Czechoslovakia","$$hashKey":"object:17515"},{"value":"CG","displayName":"Democratic Republic of the Congo","$$hashKey":"object:17516"},{"value":"DA","displayName":"Denmark","$$hashKey":"object:17517"},{"value":"DX","displayName":"Dhekelia Sovereign Base Area","$$hashKey":"object:17518"},{"value":"DJ","displayName":"Djibouti","$$hashKey":"object:17519"},{"value":"DO","displayName":"Dominica","$$hashKey":"object:17520"},{"value":"DR","displayName":"Dominican Republic","$$hashKey":"object:17521"},{"value":"TT","displayName":"East Timor","$$hashKey":"object:17522"},{"value":"EC","displayName":"Ecuador","$$hashKey":"object:17523"},{"value":"EG","displayName":"Egypt","$$hashKey":"object:17524"},{"value":"ES","displayName":"El Salvador","$$hashKey":"object:17525"},{"value":"GV","displayName":"Equatorial Guinea","$$hashKey":"object:17526"},{"value":"EK","displayName":"Equatorial Guinea","$$hashKey":"object:17527"},{"value":"ER","displayName":"Eritrea","$$hashKey":"object:17528"},{"value":"EN","displayName":"Estonia","$$hashKey":"object:17529"},{"value":"ET","displayName":"Ethiopia","$$hashKey":"object:17530"},{"value":"PJ","displayName":"Etorofu, Habomai, Kunashiri and Shikotan Islands","$$hashKey":"object:17531"},{"value":"EU","displayName":"Europa Island","$$hashKey":"object:17532"},{"value":"FK","displayName":"Falkland Islands Islas Malvinas","$$hashKey":"object:17533"},{"value":"FO","displayName":"Faroe Islands","$$hashKey":"object:17534"},{"value":"FJ","displayName":"Fiji","$$hashKey":"object:17535"},{"value":"FI","displayName":"Finland","$$hashKey":"object:17536"},{"value":"FR","displayName":"France","$$hashKey":"object:17537"},{"value":"FG","displayName":"French Guiana","$$hashKey":"object:17538"},{"value":"FP","displayName":"French Polynesia","$$hashKey":"object:17539"},{"value":"FS","displayName":"French Southern and Antarctic Lands","$$hashKey":"object:17540"},{"value":"GB","displayName":"Gabon","$$hashKey":"object:17541"},{"value":"GA","displayName":"Gambia","$$hashKey":"object:17542"},{"value":"GZ","displayName":"Gaza Strip","$$hashKey":"object:17543"},{"value":"GG","displayName":"Georgia","$$hashKey":"object:17544"},{"value":"GM","displayName":"Germany","$$hashKey":"object:17545"},{"value":"GH","displayName":"Ghana","$$hashKey":"object:17546"},{"value":"GI","displayName":"Gibraltar","$$hashKey":"object:17547"},{"value":"GO","displayName":"Glorioso Islands","$$hashKey":"object:17548"},{"value":"GR","displayName":"Greece","$$hashKey":"object:17549"},{"value":"GL","displayName":"Greenland","$$hashKey":"object:17550"},{"value":"GJ","displayName":"Grenada","$$hashKey":"object:17551"},{"value":"GP","displayName":"Guadeloupe","$$hashKey":"object:17552"},{"value":"GQ","displayName":"Guam","$$hashKey":"object:17553"},{"value":"GT","displayName":"Guatemala","$$hashKey":"object:17554"},{"value":"GK","displayName":"Guernsey","$$hashKey":"object:17555"},{"value":"PU","displayName":"Guinea-Bissau","$$hashKey":"object:17556"},{"value":"GY","displayName":"Guyana","$$hashKey":"object:17557"},{"value":"HA","displayName":"Haiti","$$hashKey":"object:17558"},{"value":"HM","displayName":"Heard Island and McDonald Islands","$$hashKey":"object:17559"},{"value":"HO","displayName":"Honduras","$$hashKey":"object:17560"},{"value":"HK","displayName":"Hong Kong","$$hashKey":"object:17561"},{"value":"HQ","displayName":"Howland Island","$$hashKey":"object:17562"},{"value":"HU","displayName":"Hungary","$$hashKey":"object:17563"},{"value":"IC","displayName":"Iceland","$$hashKey":"object:17564"},{"value":"IN","displayName":"India","$$hashKey":"object:17565"},{"value":"ID","displayName":"Indonesia","$$hashKey":"object:17566"},{"value":"IR","displayName":"Iran","$$hashKey":"object:17567"},{"value":"IZ","displayName":"Iraq","$$hashKey":"object:17568"},{"value":"EI","displayName":"Ireland","$$hashKey":"object:17569"},{"value":"IM","displayName":"Isle of Man","$$hashKey":"object:17570"},{"value":"IS","displayName":"Israel","$$hashKey":"object:17571"},{"value":"IT","displayName":"Italy","$$hashKey":"object:17572"},{"value":"JM","displayName":"Jamaica","$$hashKey":"object:17573"},{"value":"JN","displayName":"Jan Mayen","$$hashKey":"object:17574"},{"value":"JA","displayName":"Japan","$$hashKey":"object:17575"},{"value":"DQ","displayName":"Jarvis Island","$$hashKey":"object:17576"},{"value":"JE","displayName":"Jersey","$$hashKey":"object:17577"},{"value":"JQ","displayName":"Johnston Atoll","$$hashKey":"object:17578"},{"value":"JO","displayName":"Jordan","$$hashKey":"object:17579"},{"value":"JU","displayName":"Juan de Nova Island","$$hashKey":"object:17580"},{"value":"KZ","displayName":"Kazakhstan","$$hashKey":"object:17581"},{"value":"KE","displayName":"Kenya","$$hashKey":"object:17582"},{"value":"KQ","displayName":"Kingman Reef","$$hashKey":"object:17583"},{"value":"KR","displayName":"Kiribati","$$hashKey":"object:17584"},{"value":"KV","displayName":"Kosovo","$$hashKey":"object:17585"},{"value":"KU","displayName":"Kuwait","$$hashKey":"object:17586"},{"value":"KG","displayName":"Kyrgyzstan","$$hashKey":"object:17587"},{"value":"LA","displayName":"Laos","$$hashKey":"object:17588"},{"value":"LG","displayName":"Latvia","$$hashKey":"object:17589"},{"value":"LE","displayName":"Lebanon","$$hashKey":"object:17590"},{"value":"LT","displayName":"Lesotho","$$hashKey":"object:17591"},{"value":"LI","displayName":"Liberia","$$hashKey":"object:17592"},{"value":"LY","displayName":"Libya","$$hashKey":"object:17593"},{"value":"LS","displayName":"Liechtenstein","$$hashKey":"object:17594"},{"value":"LH","displayName":"Lithuania","$$hashKey":"object:17595"},{"value":"LU","displayName":"Luxembourg","$$hashKey":"object:17596"},{"value":"MC","displayName":"Macau","$$hashKey":"object:17597"},{"value":"MK","displayName":"Macedonia","$$hashKey":"object:17598"},{"value":"MA","displayName":"Madagascar","$$hashKey":"object:17599"},{"value":"MI","displayName":"Malawi","$$hashKey":"object:17600"},{"value":"MY","displayName":"Malaysia","$$hashKey":"object:17601"},{"value":"MV","displayName":"Maldives","$$hashKey":"object:17602"},{"value":"ML","displayName":"Mali","$$hashKey":"object:17603"},{"value":"MT","displayName":"Malta","$$hashKey":"object:17604"},{"value":"RM","displayName":"Marshall Islands","$$hashKey":"object:17605"},{"value":"MB","displayName":"Martinique","$$hashKey":"object:17606"},{"value":"MR","displayName":"Mauritania","$$hashKey":"object:17607"},{"value":"MP","displayName":"Mauritius","$$hashKey":"object:17608"},{"value":"MF","displayName":"Mayotte","$$hashKey":"object:17609"},{"value":"MX","displayName":"Mexico","$$hashKey":"object:17610"},{"value":"FM","displayName":"Micronesia","$$hashKey":"object:17611"},{"value":"MQ","displayName":"Midway Islands","$$hashKey":"object:17612"},{"value":"MD","displayName":"Moldova","$$hashKey":"object:17613"},{"value":"MN","displayName":"Monaco","$$hashKey":"object:17614"},{"value":"MG","displayName":"Mongolia","$$hashKey":"object:17615"},{"value":"MJ","displayName":"Montenegro","$$hashKey":"object:17616"},{"value":"MH","displayName":"Montserrat","$$hashKey":"object:17617"},{"value":"MO","displayName":"Morocco","$$hashKey":"object:17618"},{"value":"MZ","displayName":"Mozambique","$$hashKey":"object:17619"},{"value":"BM","displayName":"Myanmar","$$hashKey":"object:17620"},{"value":"WA","displayName":"Namibia","$$hashKey":"object:17621"},{"value":"NR","displayName":"Nauru","$$hashKey":"object:17622"},{"value":"BQ","displayName":"Navassa Island","$$hashKey":"object:17623"},{"value":"NP","displayName":"Nepal","$$hashKey":"object:17624"},{"value":"NL","displayName":"Netherlands","$$hashKey":"object:17625"},{"value":"NT","displayName":"Netherlands Antilles","$$hashKey":"object:17626"},{"value":"NC","displayName":"New Caledonia","$$hashKey":"object:17627"},{"value":"NZ","displayName":"New Zealand","$$hashKey":"object:17628"},{"value":"NU","displayName":"Nicaragua","$$hashKey":"object:17629"},{"value":"NG","displayName":"Niger","$$hashKey":"object:17630"},{"value":"NI","displayName":"Nigeria","$$hashKey":"object:17631"},{"value":"NE","displayName":"Niue","$$hashKey":"object:17632"},{"value":"NM","displayName":"No Mans Land","$$hashKey":"object:17633"},{"value":"NF","displayName":"Norfolk Island","$$hashKey":"object:17634"},{"value":"KN","displayName":"North Korea","$$hashKey":"object:17635"},{"value":"CQ","displayName":"Northern Mariana Islands","$$hashKey":"object:17636"},{"value":"NO","displayName":"Norway","$$hashKey":"object:17637"},{"value":"OS","displayName":"Oceans","$$hashKey":"object:17638"},{"value":"MU","displayName":"Oman","$$hashKey":"object:17639"},{"value":"PK","displayName":"Pakistan","$$hashKey":"object:17640"},{"value":"PS","displayName":"Palau","$$hashKey":"object:17641"},{"value":"LQ","displayName":"Palmyra Atoll","$$hashKey":"object:17642"},{"value":"PM","displayName":"Panama","$$hashKey":"object:17643"},{"value":"PP","displayName":"Papua New Guinea","$$hashKey":"object:17644"},{"value":"PF","displayName":"Paracel Islands","$$hashKey":"object:17645"},{"value":"PA","displayName":"Paraguay","$$hashKey":"object:17646"},{"value":"PE","displayName":"Peru","$$hashKey":"object:17647"},{"value":"RP","displayName":"Philippines","$$hashKey":"object:17648"},{"value":"PC","displayName":"Pitcairn Islands","$$hashKey":"object:17649"},{"value":"PL","displayName":"Poland","$$hashKey":"object:17650"},{"value":"PO","displayName":"Portugal","$$hashKey":"object:17651"},{"value":"RQ","displayName":"Puerto Rico","$$hashKey":"object:17652"},{"value":"QA","displayName":"Qatar","$$hashKey":"object:17653"},{"value":"RE","displayName":"Reunion","$$hashKey":"object:17654"},{"value":"RO","displayName":"Romania","$$hashKey":"object:17655"},{"value":"RS","displayName":"Russia","$$hashKey":"object:17656"},{"value":"RW","displayName":"Rwanda","$$hashKey":"object:17657"},{"value":"SH","displayName":"Saint Helena","$$hashKey":"object:17658"},{"value":"SC","displayName":"Saint Kitts and Nevis","$$hashKey":"object:17659"},{"value":"ST","displayName":"Saint Lucia","$$hashKey":"object:17660"},{"value":"RN","displayName":"Saint Martin","$$hashKey":"object:17661"},{"value":"SB","displayName":"Saint Pierre and Miquelon","$$hashKey":"object:17662"},{"value":"VC","displayName":"Saint Vincent and the Grenadines","$$hashKey":"object:17663"},{"value":"TB","displayName":"Saint-Barthelemy Island","$$hashKey":"object:17664"},{"value":"WS","displayName":"Samoa","$$hashKey":"object:17665"},{"value":"SM","displayName":"San Marino","$$hashKey":"object:17666"},{"value":"TP","displayName":"Sao Tome and Principe","$$hashKey":"object:17667"},{"value":"SA","displayName":"Saudi Arabia","$$hashKey":"object:17668"},{"value":"SG","displayName":"Senegal","$$hashKey":"object:17669"},{"value":"RI","displayName":"Serbia","$$hashKey":"object:17670"},{"value":"SE","displayName":"Seychelles","$$hashKey":"object:17671"},{"value":"SL","displayName":"Sierra Leone","$$hashKey":"object:17672"},{"value":"SN","displayName":"Singapore","$$hashKey":"object:17673"},{"value":"SI","displayName":"Slovenia","$$hashKey":"object:17674"},{"value":"BP","displayName":"Solomon Islands","$$hashKey":"object:17675"},{"value":"SO","displayName":"Somalia","$$hashKey":"object:17676"},{"value":"SF","displayName":"South Africa","$$hashKey":"object:17677"},{"value":"SX","displayName":"South Georgia and the South Sandwich Islands","$$hashKey":"object:17678"},{"value":"KS","displayName":"South Korea","$$hashKey":"object:17679"},{"value":"OD","displayName":"South Sudan","$$hashKey":"object:17680"},{"value":"SP","displayName":"Spain","$$hashKey":"object:17681"},{"value":"PG","displayName":"Spratly Islands","$$hashKey":"object:17682"},{"value":"CE","displayName":"Sri Lanka","$$hashKey":"object:17683"},{"value":"SU","displayName":"Sudan","$$hashKey":"object:17684"},{"value":"NS","displayName":"Suriname","$$hashKey":"object:17685"},{"value":"SV","displayName":"Svalbard","$$hashKey":"object:17686"},{"value":"WZ","displayName":"Swaziland","$$hashKey":"object:17687"},{"value":"SW","displayName":"Sweden","$$hashKey":"object:17688"},{"value":"SZ","displayName":"Switzerland","$$hashKey":"object:17689"},{"value":"SY","displayName":"Syria","$$hashKey":"object:17690"},{"value":"TW","displayName":"Taiwan","$$hashKey":"object:17691"},{"value":"TI","displayName":"Tajikistan","$$hashKey":"object:17692"},{"value":"TZ","displayName":"Tanzania","$$hashKey":"object:17693"},{"value":"TH","displayName":"Thailand","$$hashKey":"object:17694"},{"value":"TO","displayName":"Togo","$$hashKey":"object:17695"},{"value":"TL","displayName":"Tokelau","$$hashKey":"object:17696"},{"value":"TN","displayName":"Tonga","$$hashKey":"object:17697"},{"value":"TD","displayName":"Trinidad and Tobago","$$hashKey":"object:17698"},{"value":"TE","displayName":"Tromelin Island","$$hashKey":"object:17699"},{"value":"TS","displayName":"Tunisia","$$hashKey":"object:17700"},{"value":"TU","displayName":"Turkey","$$hashKey":"object:17701"},{"value":"TX","displayName":"Turkmenistan","$$hashKey":"object:17702"},{"value":"TK","displayName":"Turks and Caicos Islands","$$hashKey":"object:17703"},{"value":"TV","displayName":"Tuvalu","$$hashKey":"object:17704"},{"value":"UG","displayName":"Uganda","$$hashKey":"object:17705"},{"value":"UP","displayName":"Ukraine","$$hashKey":"object:17706"},{"value":"UF","displayName":"Undersea Features","$$hashKey":"object:17707"},{"value":"UU","displayName":"Undesignated Sovereignty","$$hashKey":"object:17708"},{"value":"AE","displayName":"United Arab Emirates","$$hashKey":"object:17709"},{"value":"UK","displayName":"United Kingdom","$$hashKey":"object:17710"},{"value":"US","displayName":"United States","$$hashKey":"object:17711"},{"value":"UY","displayName":"Uruguay","$$hashKey":"object:17712"},{"value":"UZ","displayName":"Uzbekistan","$$hashKey":"object:17713"},{"value":"NH","displayName":"Vanuatu","$$hashKey":"object:17714"},{"value":"VT","displayName":"Vatican City","$$hashKey":"object:17715"},{"value":"VE","displayName":"Venezuela","$$hashKey":"object:17716"},{"value":"VM","displayName":"Vietnam, Democratic Republic of","$$hashKey":"object:17717"},{"value":"VQ","displayName":"Virgin Islands","$$hashKey":"object:17718"},{"value":"WQ","displayName":"Wake Island","$$hashKey":"object:17719"},{"value":"WF","displayName":"Wallis and Futuna","$$hashKey":"object:17720"},{"value":"WE","displayName":"West Bank","$$hashKey":"object:17721"},{"value":"WI","displayName":"Western Sahara","$$hashKey":"object:17722"},{"value":"YM","displayName":"Yemen","$$hashKey":"object:17723"},{"value":"ZA","displayName":"Zambia","$$hashKey":"object:17724"},{"value":"ZI","displayName":"Zimbabwe","$$hashKey":"object:17725"}],"name":"Fips Country codes","displayName":"Fips Country codes","defaultValue":"FR","hidden":false,"$$hashKey":"object:17431"},"Langue":{"type":"Select","options":[{"value":"afr","displayName":"Afrikaans","$$hashKey":"object:17732"},{"value":"ara","displayName":"Arabe","$$hashKey":"object:17733"},{"value":"axe","displayName":"Azéri","$$hashKey":"object:17734"},{"value":"ben","displayName":"Bengali","$$hashKey":"object:17735"},{"value":"bos","displayName":"Bosnien","$$hashKey":"object:17736"},{"value":"bul","displayName":"Bulgare","$$hashKey":"object:17737"},{"value":"cat","displayName":"Catalan","$$hashKey":"object:17738"},{"value":"ces","displayName":"Tchèque","$$hashKey":"object:17739"},{"value":"dan","displayName":"Danois","$$hashKey":"object:17740"},{"value":"deu","displayName":"Allemand","$$hashKey":"object:17741"},{"value":"ell","displayName":"Grec moderne","$$hashKey":"object:17742"},{"value":"eng","displayName":"Anglais","$$hashKey":"object:17743"},{"value":"est","displayName":"Estonien","$$hashKey":"object:17744"},{"value":"fas","displayName":"Persan","$$hashKey":"object:17745"},{"value":"fin","displayName":"Finnois","$$hashKey":"object:17746"},{"value":"fra","displayName":"Français","$$hashKey":"object:17747"},{"value":"glg","displayName":"Galicien","$$hashKey":"object:17748"},{"value":"guj","displayName":"Gujarati","$$hashKey":"object:17749"},{"value":"heb","displayName":"Hébreu","$$hashKey":"object:17750"},{"value":"hin","displayName":"Hindi","$$hashKey":"object:17751"},{"value":"hrv","displayName":"Croate","$$hashKey":"object:17752"},{"value":"hun","displayName":"Hongrois","$$hashKey":"object:17753"},{"value":"hye","displayName":"Arménien","$$hashKey":"object:17754"},{"value":"ind","displayName":"Indonésien","$$hashKey":"object:17755"},{"value":"isl","displayName":"Islandais","$$hashKey":"object:17756"},{"value":"ita","displayName":"Italien","$$hashKey":"object:17757"},{"value":"jpn","displayName":"Japonais","$$hashKey":"object:17758"},{"value":"kan","displayName":"Kannada","$$hashKey":"object:17759"},{"value":"kat","displayName":"Géorgien","$$hashKey":"object:17760"},{"value":"kaz","displayName":"Kazakh","$$hashKey":"object:17761"},{"value":"kor","displayName":"Coréen","$$hashKey":"object:17762"},{"value":"lav","displayName":"Letton","$$hashKey":"object:17763"},{"value":"lit","displayName":"Lituanien","$$hashKey":"object:17764"},{"value":"mal","displayName":"Malayalam","$$hashKey":"object:17765"},{"value":"mar","displayName":"Marathi","$$hashKey":"object:17766"},{"value":"mkd","displayName":"Macédonien","$$hashKey":"object:17767"},{"value":"mon","displayName":"Mongol","$$hashKey":"object:17768"},{"value":"msa","displayName":"Malais","$$hashKey":"object:17769"},{"value":"nep","displayName":"Népalais","$$hashKey":"object:17770"},{"value":"nld","displayName":"Néerlandais","$$hashKey":"object:17771"},{"value":"nno","displayName":"Norvégien Nynorsk","$$hashKey":"object:17772"},{"value":"nor","displayName":"Norvégien","$$hashKey":"object:17773"},{"value":"pan","displayName":"Pendjabi","$$hashKey":"object:17774"},{"value":"pol","displayName":"Polonais","$$hashKey":"object:17775"},{"value":"por","displayName":"Portugais","$$hashKey":"object:17776"},{"value":"ron","displayName":"Roumain","$$hashKey":"object:17777"},{"value":"rus","displayName":"Russe","$$hashKey":"object:17778"},{"value":"sin","displayName":"Cingalais","$$hashKey":"object:17779"},{"value":"slk","displayName":"Slovaque","$$hashKey":"object:17780"},{"value":"slv","displayName":"Slovène","$$hashKey":"object:17781"},{"value":"som","displayName":"Somali","$$hashKey":"object:17782"},{"value":"spa","displayName":"Espagnol","$$hashKey":"object:17783"},{"value":"sqi","displayName":"Albanais","$$hashKey":"object:17784"},{"value":"srp","displayName":"Serbe","$$hashKey":"object:17785"},{"value":"swa","displayName":"Swahili","$$hashKey":"object:17786"},{"value":"swe","displayName":"Suédois","$$hashKey":"object:17787"},{"value":"tam","displayName":"Tamoul","$$hashKey":"object:17788"},{"value":"tel","displayName":"Télougou","$$hashKey":"object:17789"},{"value":"tha","displayName":"Thaï","$$hashKey":"object:17790"},{"value":"tur","displayName":"Turc","$$hashKey":"object:17791"},{"value":"ukr","displayName":"Ukrainien","$$hashKey":"object:17792"},{"value":"urd","displayName":"Ourdou","$$hashKey":"object:17793"},{"value":"vie","displayName":"Vietnamien","$$hashKey":"object:17794"},{"value":"zho","displayName":"Chinois","$$hashKey":"object:17795"}],"name":"Langue","displayName":"Langue","defaultValue":"eng","hidden":false,"$$hashKey":"object:17432"},"Mois":{"type":"Select","options":[{"value":"01","displayName":"Janvier","$$hashKey":"object:17802"},{"value":"02","displayName":"Février","$$hashKey":"object:17803"},{"value":"03","displayName":"Mars","$$hashKey":"object:17804"},{"value":"04","displayName":"Avril","$$hashKey":"object:17805"},{"value":"05","displayName":"Mai","$$hashKey":"object:17806"},{"value":"06","displayName":"Juin","$$hashKey":"object:17807"},{"value":"07","displayName":"Juillet","$$hashKey":"object:17808"},{"value":"08","displayName":"Août","$$hashKey":"object:17809"},{"value":"09","displayName":"Septembre","$$hashKey":"object:17810"},{"value":"10","displayName":"Octobre","$$hashKey":"object:17811"},{"value":"11","displayName":"Novembre","$$hashKey":"object:17812"},{"value":"12","displayName":"Décembre","$$hashKey":"object:17813"}],"name":"Mois","displayName":"Mois","defaultValue":"12","hidden":false,"$$hashKey":"object:17433"},"Jour":{"type":"Select","options":[{"value":"01","displayName":"01","$$hashKey":"object:17820"},{"value":"02","displayName":"02","$$hashKey":"object:17821"},{"value":"03","displayName":"03","$$hashKey":"object:17822"},{"value":"04","displayName":"04","$$hashKey":"object:17823"},{"value":"05","displayName":"05","$$hashKey":"object:17824"},{"value":"06","displayName":"06","$$hashKey":"object:17825"},{"value":"07","displayName":"07","$$hashKey":"object:17826"},{"value":"08","displayName":"08","$$hashKey":"object:17827"},{"value":"09","displayName":"09","$$hashKey":"object:17828"},{"value":"10","displayName":"10","$$hashKey":"object:17829"},{"value":"11","displayName":"11","$$hashKey":"object:17830"},{"value":"12","displayName":"12","$$hashKey":"object:17831"},{"value":"13","displayName":"13","$$hashKey":"object:17832"},{"value":"14","displayName":"14","$$hashKey":"object:17833"},{"value":"15","displayName":"15","$$hashKey":"object:17834"},{"value":"16","displayName":"16","$$hashKey":"object:17835"},{"value":"17","displayName":"17","$$hashKey":"object:17836"},{"value":"18","displayName":"18","$$hashKey":"object:17837"},{"value":"19","displayName":"19","$$hashKey":"object:17838"},{"value":"20","displayName":"20","$$hashKey":"object:17839"},{"value":"21","displayName":"21","$$hashKey":"object:17840"},{"value":"22","displayName":"22","$$hashKey":"object:17841"},{"value":"23","displayName":"23","$$hashKey":"object:17842"},{"value":"24","displayName":"24","$$hashKey":"object:17843"},{"value":"25","displayName":"25","$$hashKey":"object:17844"},{"value":"26","displayName":"26","$$hashKey":"object:17845"},{"value":"27","displayName":"27","$$hashKey":"object:17846"},{"value":"28","displayName":"28","$$hashKey":"object:17847"},{"value":"29","displayName":"29","$$hashKey":"object:17848"},{"value":"30","displayName":"30","$$hashKey":"object:17849"},{"value":"31","displayName":"31","$$hashKey":"object:17850"}],"name":"Jour","displayName":"Jour","defaultValue":"01","hidden":false,"$$hashKey":"object:17434"}}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Requete1FromMongo: org.apache.spark.sql.DataFrame = [CodePays: string, Jour: int ... 4 more fields]\ndd_fipsCountry: Object = FR\ndd_Langue: Object = fra\nmois: Object = 12\njour: Object = 10\nmylangue: Object = fra\n"},{"type":"TABLE","data":"Jour\tCodePays\tLangue\tNbEvents\tNbMentions\n20181210\tFR\tfra\t1551\t3697\n"}]},"apps":[],"jobName":"paragraph_1548333379724_-1620186570","id":"20190122-091535_1666676258","dateCreated":"2019-01-24T13:36:19+0100","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16982"},{"text":"%md\n\n## Requete 2 : liste d'évenements pour un acteur donné\n","user":"anonymous","dateUpdated":"2019-01-24T14:15:03+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Requete 2 : liste d&rsquo;évenements pour un acteur donné</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1548335376732_-1980035930","id":"20190124-140936_1459954215","dateCreated":"2019-01-24T14:09:36+0100","dateStarted":"2019-01-24T14:15:03+0100","dateFinished":"2019-01-24T14:15:03+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16983"},{"text":"// Lecture Requete 2\n\nval inputActorName = z.input(\"actorName\", \"FRANCE\")\n\n// lien base\nval Requete2FromMongo = MongoSpark.\n                        load(sc, ReadConfig(Map(\"uri\" -> MONGO_URI_REQUETE2)) ).\n                        toDF()\n                        \n// attention la \"table\" de décode cameoEvents est celle issue du fichier s3 pas celle aussi stockée dans mongo :\n\n// TODO : requete à adapter en fonction du client, voir si moyen d'un mecanisme d'internationnalisation\n// pour avoir un fichier cameoeventcode en francais si GUI en francais plutot que celui en anglais fourni par le site\n                        \nRequete2FromMongo.createOrReplaceTempView(\"TableRequete2\")\n\nz.show(spark.sql(\"\"\"\nSELECT T.actor as Acteur, T.Jour, C.EVENTDESCRIPTION as Description, T.GoldsteinScale, T.SOURCEURL as Source\nfrom  TableRequete2 T inner join cameoEvents C on T.EventCode = C.CAMEOEVENTCODE\nwhere T.actor = '\"\"\" + inputActorName  +\"\"\"'  \norder by T.Jour desc --, T.GoldsteinScale\nlimit 20\n\"\"\"))\n","user":"anonymous","dateUpdated":"2019-01-24T14:17:20+0100","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Acteur":"string","Jour":"string","Description":"string","GoldsteinScale":"string","Source":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{"actorName":"FRANCE"},"forms":{"actorName":{"type":"TextBox","name":"actorName","displayName":"actorName","defaultValue":"FRANCE","hidden":false,"$$hashKey":"object:17873"}}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\ninputActorName: Object = FRANCE\nRequete2FromMongo: org.apache.spark.sql.DataFrame = [EventCode: string, GLOBALEVENTID: int ... 5 more fields]\n"},{"type":"TABLE","data":"Acteur\tJour\tDescription\tGoldsteinScale\tSource\nFRANCE\t20181231\tPraise or endorse\t3.4\thttps://www.denofgeek.com/uk/tv/les-miserables/62402/les-miserables-episode-1-review-a-faithful-retelling-with-a-timeless-moral\nFRANCE\t20181231\tDemonstrate military or police power, not specified below\t-7.2\thttps://www.blic.rs/vesti/svet/pojacane-mere-bezbjednosti-francuska-sirom-zemlje-rasporeduje-vise-od-147000/b8tlzpb\nFRANCE\t20181231\tDisapprove, not specified below\t-2.0\thttps://www.wiscnews.com/baraboonewsrepublic/news/local/k-gift-promotes-ringling-theatre-safety/article_5c85d36b-3f3b-5570-935e-cec35fa8f9ed.html\nFRANCE\t20181231\tDisapprove, not specified below\t-2.0\thttps://www.wiscnews.com/baraboonewsrepublic/news/local/k-gift-promotes-ringling-theatre-safety/article_5c85d36b-3f3b-5570-935e-cec35fa8f9ed.html\nFRANCE\t20181231\tPraise or endorse\t3.4\thttp://www.floppingaces.net/most-wanted/john-kerry-fights-for-border-security-for-his-palatial-home-in-france/\nFRANCE\t20181231\tComplain officially \t-2.0\thttp://www.floppingaces.net/most-wanted/john-kerry-fights-for-border-security-for-his-palatial-home-in-france/\nFRANCE\t20181231\tMake statement, not specified below\t0.0\thttps://www.wiscnews.com/baraboonewsrepublic/news/local/k-gift-promotes-ringling-theatre-safety/article_5c85d36b-3f3b-5570-935e-cec35fa8f9ed.html\nFRANCE\t20181231\tDemonstrate or rally\t-6.5\thttps://www.denofgeek.com/uk/tv/les-miserables/62402/les-miserables-episode-1-review-a-faithful-retelling-with-a-timeless-moral\nFRANCE\t20181231\tSign formal agreement\t8.0\thttp://www.fasopresse.net/politique/6185-5-aout-1960-les-peripeties-dune-independance?5e90491fecb379c63acce1d6f2f74023=7e5d800932637c2271d64d7752289832\nFRANCE\t20181231\tSign formal agreement\t8.0\thttp://www.fasopresse.net/politique/6185-5-aout-1960-les-peripeties-dune-independance?5e90491fecb379c63acce1d6f2f74023=7e5d800932637c2271d64d7752289832\nFRANCE\t20181231\tDemand, not specified below\t-5.0\thttps://www.dailymail.co.uk/money/cars/article-6517385/VIP-chauffeur-reveals-extreme-demands-rich-famous.html\nFRANCE\t20181231\tInvestigate, not specified below\t-2.0\thttp://www.diena.lt/naujienos/ivairenybes/sunku-patiketi/kalinys-pasinaudojo-virvinemis-kopeciomis-ir-pabego-kalejimo-894979\nFRANCE\t20181231\tExpress intent to meet or negotiate\t4.0\thttps://www.dailymail.co.uk/money/cars/article-6517385/VIP-chauffeur-reveals-extreme-demands-rich-famous.html\nFRANCE\t20181231\tCooperate militarily\t7.4\thttp://www.floppingaces.net/most-wanted/john-kerry-fights-for-border-security-for-his-palatial-home-in-france/\nFRANCE\t20181231\tProvide aid, not specified below\t7.0\thttps://naslovi.net/2018-12-31/rtv/vremeplov-rodjen-slavni-francuz-anri-matis/22739031\nFRANCE\t20181231\tUse conventional military force, not specified below\t-10.0\thttp://versionfinal.com.ve/mundo/detienen-a-un-militar-frances-con-cargadores-de-pistola-en-barcelona/\nFRANCE\t20181231\tSign formal agreement\t8.0\thttp://www.fasopresse.net/politique/6185-5-aout-1960-les-peripeties-dune-independance?5e90491fecb379c63acce1d6f2f74023=7e5d800932637c2271d64d7752289832\nFRANCE\t20181231\tThreaten, not specified below\t-4.4\thttp://www.alaan.tv/programs/news-and-info/studio-alaan/163337/studio\nFRANCE\t20181231\tMake statement, not specified below\t0.0\thttps://www.24heures.ch/monde/L-auteur-dune-quenelle-destinee-a-Valls-arrete/story/21803646\nFRANCE\t20181231\tSign formal agreement\t8.0\thttp://www.fasopresse.net/politique/6185-5-aout-1960-les-peripeties-dune-independance?5e90491fecb379c63acce1d6f2f74023=7e5d800932637c2271d64d7752289832\n"}]},"apps":[],"jobName":"paragraph_1548333379724_-1487567317","id":"20190122-122451_726040806","dateCreated":"2019-01-24T13:36:19+0100","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16984"},{"text":"%md\n\n## Requete 3 : top acteurs positifs, top acteurs negatifs\n\n# DEPRECATED \n-> voir requete 3.2 à la place\n( raisons :\npas le bon code pays\npas assez de champs\ntravaille sur 1er etage non consolidé =>/!\\ perfs\n)\n","user":"anonymous","dateUpdated":"2019-01-24T14:19:13+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Requete 3 : top acteurs positifs, top acteurs negatifs</h2>\n<h1>DEPRECATED</h1>\n<p>-&gt; voir requete 3.2 à la place<br/>( raisons :<br/>pas le bon code pays<br/>pas assez de champs<br/>travaille sur 1er etage non consolidé =&gt;/!\\ perfs<br/>)</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548335711215_-1788197432","id":"20190124-141511_1989054092","dateCreated":"2019-01-24T14:15:11+0100","dateStarted":"2019-01-24T14:19:13+0100","dateFinished":"2019-01-24T14:19:13+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16985"},{"text":"// Lecture Requete 3\n\n// lien vers base\nval Requete3FromMongo = MongoSpark.\n                        load(sc, ReadConfig(Map(\"uri\" -> MONGO_URI_REQUETE3)) ).\n                        toDF()\n                        \nRequete3FromMongo.createOrReplaceTempView(\"TableRequete3\")\n\nval dd_fipsCountry = z.select(\"Fips Country codes\", \"FR\", listcodes(\"fipsCountries\"))\nval dd_mois = getMonths()\nval mylangue = getLangues()\n\nz.show(spark.sql(\"\"\"\nselect\n  tt.Mois, tt.CountryCode, tt.Langue, tt.Actor,\n  sum(nbpos) as nbpos,\n  sum(nbneg) as nbneg,\n  sum(sommepos) as sommepos,\n  sum(sommeneg) as sommeneg,\n  abs(sum(nbpos)-sum(nbneg))/sum(nbttl) as deltanb,\n  abs(sum(sommepos)-sum(sommeneg)) as deltasomme,\n  sum(nbttl) as nbttl\nfrom\nTableRequete3 as tt\nwhere CountryCode ='\"\"\" + dd_fipsCountry  +\"\"\"'  \n  and Mois = '2018\"\"\" + dd_mois + \"\"\"' and Langue = '\"\"\" + mylangue +\"\"\"'  \ngroup by tt.Mois, tt.CountryCode, tt.Langue, tt.Actor\norder by 5 desc\nlimit 5\n\"\"\"))\n\n// TODO : probleme vizu zeppelin : il melange les 2 deux show en un seul tableau au lieu d'avoir 2 tableaux bien séparés\nz.show(spark.sql(\"\"\"\nselect\n  tt.Mois, tt.CountryCode, tt.Langue, tt.Actor,\n  sum(nbpos) as nbpos,\n  sum(nbneg) as nbneg,\n  sum(sommepos) as sommepos,\n  sum(sommeneg) as sommeneg,\n  abs(sum(nbpos)-sum(nbneg))/sum(nbttl) as deltanb,\n  abs(sum(sommepos)-sum(sommeneg)) as deltasomme,\n  sum(nbttl) as nbttl\nfrom\nTableRequete3 as tt\nwhere CountryCode ='\"\"\" + dd_fipsCountry  +\"\"\"'  \n  and Mois = '2018\"\"\" + dd_mois + \"\"\"' and Langue = '\"\"\" + mylangue +\"\"\"'  \ngroup by tt.Mois, tt.CountryCode, tt.Langue, tt.Actor\norder by 6 desc\nlimit 5\n\"\"\"))\n\n","user":"anonymous","dateUpdated":"2019-01-24T14:18:33+0100","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"runOnSelectionChange":true,"results":{"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Mois":"string","CountryCode":"string","Langue":"string","Actor":"string","nbpos":"string","nbneg":"string","sommepos":"string","sommeneg":"string","deltanb":"string","deltasomme":"string","nbttl":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{"Fips Country codes":"FR","Mois":"12","Langue":"eng"},"forms":{"Fips Country codes":{"type":"Select","options":[{"value":"AF","displayName":"Afghanistan","$$hashKey":"object:17925"},{"value":"AX","displayName":"Akrotiri Sovereign Base Area","$$hashKey":"object:17926"},{"value":"AL","displayName":"Albania","$$hashKey":"object:17927"},{"value":"AG","displayName":"Algeria","$$hashKey":"object:17928"},{"value":"AQ","displayName":"American Samoa","$$hashKey":"object:17929"},{"value":"AN","displayName":"Andorra","$$hashKey":"object:17930"},{"value":"AO","displayName":"Angola","$$hashKey":"object:17931"},{"value":"AV","displayName":"Anguilla","$$hashKey":"object:17932"},{"value":"AY","displayName":"Antarctica","$$hashKey":"object:17933"},{"value":"AC","displayName":"Antigua and Barbuda","$$hashKey":"object:17934"},{"value":"AR","displayName":"Argentina","$$hashKey":"object:17935"},{"value":"AM","displayName":"Armenia","$$hashKey":"object:17936"},{"value":"AA","displayName":"Aruba","$$hashKey":"object:17937"},{"value":"AT","displayName":"Ashmore and Cartier Islands","$$hashKey":"object:17938"},{"value":"AS","displayName":"Australia","$$hashKey":"object:17939"},{"value":"AU","displayName":"Austria","$$hashKey":"object:17940"},{"value":"AJ","displayName":"Azerbaijan","$$hashKey":"object:17941"},{"value":"BF","displayName":"Bahamas, The","$$hashKey":"object:17942"},{"value":"BA","displayName":"Bahrain","$$hashKey":"object:17943"},{"value":"FQ","displayName":"Baker Island","$$hashKey":"object:17944"},{"value":"BG","displayName":"Bangladesh","$$hashKey":"object:17945"},{"value":"BB","displayName":"Barbados","$$hashKey":"object:17946"},{"value":"BS","displayName":"Bassas da India","$$hashKey":"object:17947"},{"value":"BO","displayName":"Belarus","$$hashKey":"object:17948"},{"value":"BE","displayName":"Belgium","$$hashKey":"object:17949"},{"value":"BH","displayName":"Belize","$$hashKey":"object:17950"},{"value":"BN","displayName":"Benin","$$hashKey":"object:17951"},{"value":"BD","displayName":"Bermuda","$$hashKey":"object:17952"},{"value":"BT","displayName":"Bhutan","$$hashKey":"object:17953"},{"value":"BL","displayName":"Bolivia","$$hashKey":"object:17954"},{"value":"BK","displayName":"Bosnia-Herzegovina","$$hashKey":"object:17955"},{"value":"BC","displayName":"Botswana","$$hashKey":"object:17956"},{"value":"BV","displayName":"Bouvet Island","$$hashKey":"object:17957"},{"value":"BR","displayName":"Brazil","$$hashKey":"object:17958"},{"value":"IO","displayName":"British Indian Ocean Territory","$$hashKey":"object:17959"},{"value":"VI","displayName":"British Virgin Islands","$$hashKey":"object:17960"},{"value":"BX","displayName":"Brunei","$$hashKey":"object:17961"},{"value":"BU","displayName":"Bulgaria","$$hashKey":"object:17962"},{"value":"UV","displayName":"Burkina Faso","$$hashKey":"object:17963"},{"value":"BY","displayName":"Burundi","$$hashKey":"object:17964"},{"value":"CB","displayName":"Cambodia","$$hashKey":"object:17965"},{"value":"CM","displayName":"Cameroon","$$hashKey":"object:17966"},{"value":"CA","displayName":"Canada","$$hashKey":"object:17967"},{"value":"CV","displayName":"Cape Verde","$$hashKey":"object:17968"},{"value":"CJ","displayName":"Cayman Islands","$$hashKey":"object:17969"},{"value":"CT","displayName":"Central African Republic","$$hashKey":"object:17970"},{"value":"CD","displayName":"Chad","$$hashKey":"object:17971"},{"value":"CI","displayName":"Chile","$$hashKey":"object:17972"},{"value":"CH","displayName":"China","$$hashKey":"object:17973"},{"value":"KT","displayName":"Christmas Island","$$hashKey":"object:17974"},{"value":"IP","displayName":"Clipperton Island","$$hashKey":"object:17975"},{"value":"CK","displayName":"Cocos Keeling Islands","$$hashKey":"object:17976"},{"value":"CO","displayName":"Colombia","$$hashKey":"object:17977"},{"value":"CN","displayName":"Comoros","$$hashKey":"object:17978"},{"value":"CF","displayName":"Congo","$$hashKey":"object:17979"},{"value":"CW","displayName":"Cook Islands","$$hashKey":"object:17980"},{"value":"CR","displayName":"Coral Sea Islands","$$hashKey":"object:17981"},{"value":"CS","displayName":"Costa Rica","$$hashKey":"object:17982"},{"value":"IV","displayName":"Cote dIvoire","$$hashKey":"object:17983"},{"value":"HR","displayName":"Croatia","$$hashKey":"object:17984"},{"value":"CU","displayName":"Cuba","$$hashKey":"object:17985"},{"value":"CY","displayName":"Cyprus","$$hashKey":"object:17986"},{"value":"EZ","displayName":"Czech Republic","$$hashKey":"object:17987"},{"value":"LO","displayName":"Czechoslovakia","$$hashKey":"object:17988"},{"value":"CG","displayName":"Democratic Republic of the Congo","$$hashKey":"object:17989"},{"value":"DA","displayName":"Denmark","$$hashKey":"object:17990"},{"value":"DX","displayName":"Dhekelia Sovereign Base Area","$$hashKey":"object:17991"},{"value":"DJ","displayName":"Djibouti","$$hashKey":"object:17992"},{"value":"DO","displayName":"Dominica","$$hashKey":"object:17993"},{"value":"DR","displayName":"Dominican Republic","$$hashKey":"object:17994"},{"value":"TT","displayName":"East Timor","$$hashKey":"object:17995"},{"value":"EC","displayName":"Ecuador","$$hashKey":"object:17996"},{"value":"EG","displayName":"Egypt","$$hashKey":"object:17997"},{"value":"ES","displayName":"El Salvador","$$hashKey":"object:17998"},{"value":"GV","displayName":"Equatorial Guinea","$$hashKey":"object:17999"},{"value":"EK","displayName":"Equatorial Guinea","$$hashKey":"object:18000"},{"value":"ER","displayName":"Eritrea","$$hashKey":"object:18001"},{"value":"EN","displayName":"Estonia","$$hashKey":"object:18002"},{"value":"ET","displayName":"Ethiopia","$$hashKey":"object:18003"},{"value":"PJ","displayName":"Etorofu, Habomai, Kunashiri and Shikotan Islands","$$hashKey":"object:18004"},{"value":"EU","displayName":"Europa Island","$$hashKey":"object:18005"},{"value":"FK","displayName":"Falkland Islands Islas Malvinas","$$hashKey":"object:18006"},{"value":"FO","displayName":"Faroe Islands","$$hashKey":"object:18007"},{"value":"FJ","displayName":"Fiji","$$hashKey":"object:18008"},{"value":"FI","displayName":"Finland","$$hashKey":"object:18009"},{"value":"FR","displayName":"France","$$hashKey":"object:18010"},{"value":"FG","displayName":"French Guiana","$$hashKey":"object:18011"},{"value":"FP","displayName":"French Polynesia","$$hashKey":"object:18012"},{"value":"FS","displayName":"French Southern and Antarctic Lands","$$hashKey":"object:18013"},{"value":"GB","displayName":"Gabon","$$hashKey":"object:18014"},{"value":"GA","displayName":"Gambia","$$hashKey":"object:18015"},{"value":"GZ","displayName":"Gaza Strip","$$hashKey":"object:18016"},{"value":"GG","displayName":"Georgia","$$hashKey":"object:18017"},{"value":"GM","displayName":"Germany","$$hashKey":"object:18018"},{"value":"GH","displayName":"Ghana","$$hashKey":"object:18019"},{"value":"GI","displayName":"Gibraltar","$$hashKey":"object:18020"},{"value":"GO","displayName":"Glorioso Islands","$$hashKey":"object:18021"},{"value":"GR","displayName":"Greece","$$hashKey":"object:18022"},{"value":"GL","displayName":"Greenland","$$hashKey":"object:18023"},{"value":"GJ","displayName":"Grenada","$$hashKey":"object:18024"},{"value":"GP","displayName":"Guadeloupe","$$hashKey":"object:18025"},{"value":"GQ","displayName":"Guam","$$hashKey":"object:18026"},{"value":"GT","displayName":"Guatemala","$$hashKey":"object:18027"},{"value":"GK","displayName":"Guernsey","$$hashKey":"object:18028"},{"value":"PU","displayName":"Guinea-Bissau","$$hashKey":"object:18029"},{"value":"GY","displayName":"Guyana","$$hashKey":"object:18030"},{"value":"HA","displayName":"Haiti","$$hashKey":"object:18031"},{"value":"HM","displayName":"Heard Island and McDonald Islands","$$hashKey":"object:18032"},{"value":"HO","displayName":"Honduras","$$hashKey":"object:18033"},{"value":"HK","displayName":"Hong Kong","$$hashKey":"object:18034"},{"value":"HQ","displayName":"Howland Island","$$hashKey":"object:18035"},{"value":"HU","displayName":"Hungary","$$hashKey":"object:18036"},{"value":"IC","displayName":"Iceland","$$hashKey":"object:18037"},{"value":"IN","displayName":"India","$$hashKey":"object:18038"},{"value":"ID","displayName":"Indonesia","$$hashKey":"object:18039"},{"value":"IR","displayName":"Iran","$$hashKey":"object:18040"},{"value":"IZ","displayName":"Iraq","$$hashKey":"object:18041"},{"value":"EI","displayName":"Ireland","$$hashKey":"object:18042"},{"value":"IM","displayName":"Isle of Man","$$hashKey":"object:18043"},{"value":"IS","displayName":"Israel","$$hashKey":"object:18044"},{"value":"IT","displayName":"Italy","$$hashKey":"object:18045"},{"value":"JM","displayName":"Jamaica","$$hashKey":"object:18046"},{"value":"JN","displayName":"Jan Mayen","$$hashKey":"object:18047"},{"value":"JA","displayName":"Japan","$$hashKey":"object:18048"},{"value":"DQ","displayName":"Jarvis Island","$$hashKey":"object:18049"},{"value":"JE","displayName":"Jersey","$$hashKey":"object:18050"},{"value":"JQ","displayName":"Johnston Atoll","$$hashKey":"object:18051"},{"value":"JO","displayName":"Jordan","$$hashKey":"object:18052"},{"value":"JU","displayName":"Juan de Nova Island","$$hashKey":"object:18053"},{"value":"KZ","displayName":"Kazakhstan","$$hashKey":"object:18054"},{"value":"KE","displayName":"Kenya","$$hashKey":"object:18055"},{"value":"KQ","displayName":"Kingman Reef","$$hashKey":"object:18056"},{"value":"KR","displayName":"Kiribati","$$hashKey":"object:18057"},{"value":"KV","displayName":"Kosovo","$$hashKey":"object:18058"},{"value":"KU","displayName":"Kuwait","$$hashKey":"object:18059"},{"value":"KG","displayName":"Kyrgyzstan","$$hashKey":"object:18060"},{"value":"LA","displayName":"Laos","$$hashKey":"object:18061"},{"value":"LG","displayName":"Latvia","$$hashKey":"object:18062"},{"value":"LE","displayName":"Lebanon","$$hashKey":"object:18063"},{"value":"LT","displayName":"Lesotho","$$hashKey":"object:18064"},{"value":"LI","displayName":"Liberia","$$hashKey":"object:18065"},{"value":"LY","displayName":"Libya","$$hashKey":"object:18066"},{"value":"LS","displayName":"Liechtenstein","$$hashKey":"object:18067"},{"value":"LH","displayName":"Lithuania","$$hashKey":"object:18068"},{"value":"LU","displayName":"Luxembourg","$$hashKey":"object:18069"},{"value":"MC","displayName":"Macau","$$hashKey":"object:18070"},{"value":"MK","displayName":"Macedonia","$$hashKey":"object:18071"},{"value":"MA","displayName":"Madagascar","$$hashKey":"object:18072"},{"value":"MI","displayName":"Malawi","$$hashKey":"object:18073"},{"value":"MY","displayName":"Malaysia","$$hashKey":"object:18074"},{"value":"MV","displayName":"Maldives","$$hashKey":"object:18075"},{"value":"ML","displayName":"Mali","$$hashKey":"object:18076"},{"value":"MT","displayName":"Malta","$$hashKey":"object:18077"},{"value":"RM","displayName":"Marshall Islands","$$hashKey":"object:18078"},{"value":"MB","displayName":"Martinique","$$hashKey":"object:18079"},{"value":"MR","displayName":"Mauritania","$$hashKey":"object:18080"},{"value":"MP","displayName":"Mauritius","$$hashKey":"object:18081"},{"value":"MF","displayName":"Mayotte","$$hashKey":"object:18082"},{"value":"MX","displayName":"Mexico","$$hashKey":"object:18083"},{"value":"FM","displayName":"Micronesia","$$hashKey":"object:18084"},{"value":"MQ","displayName":"Midway Islands","$$hashKey":"object:18085"},{"value":"MD","displayName":"Moldova","$$hashKey":"object:18086"},{"value":"MN","displayName":"Monaco","$$hashKey":"object:18087"},{"value":"MG","displayName":"Mongolia","$$hashKey":"object:18088"},{"value":"MJ","displayName":"Montenegro","$$hashKey":"object:18089"},{"value":"MH","displayName":"Montserrat","$$hashKey":"object:18090"},{"value":"MO","displayName":"Morocco","$$hashKey":"object:18091"},{"value":"MZ","displayName":"Mozambique","$$hashKey":"object:18092"},{"value":"BM","displayName":"Myanmar","$$hashKey":"object:18093"},{"value":"WA","displayName":"Namibia","$$hashKey":"object:18094"},{"value":"NR","displayName":"Nauru","$$hashKey":"object:18095"},{"value":"BQ","displayName":"Navassa Island","$$hashKey":"object:18096"},{"value":"NP","displayName":"Nepal","$$hashKey":"object:18097"},{"value":"NL","displayName":"Netherlands","$$hashKey":"object:18098"},{"value":"NT","displayName":"Netherlands Antilles","$$hashKey":"object:18099"},{"value":"NC","displayName":"New Caledonia","$$hashKey":"object:18100"},{"value":"NZ","displayName":"New Zealand","$$hashKey":"object:18101"},{"value":"NU","displayName":"Nicaragua","$$hashKey":"object:18102"},{"value":"NG","displayName":"Niger","$$hashKey":"object:18103"},{"value":"NI","displayName":"Nigeria","$$hashKey":"object:18104"},{"value":"NE","displayName":"Niue","$$hashKey":"object:18105"},{"value":"NM","displayName":"No Mans Land","$$hashKey":"object:18106"},{"value":"NF","displayName":"Norfolk Island","$$hashKey":"object:18107"},{"value":"KN","displayName":"North Korea","$$hashKey":"object:18108"},{"value":"CQ","displayName":"Northern Mariana Islands","$$hashKey":"object:18109"},{"value":"NO","displayName":"Norway","$$hashKey":"object:18110"},{"value":"OS","displayName":"Oceans","$$hashKey":"object:18111"},{"value":"MU","displayName":"Oman","$$hashKey":"object:18112"},{"value":"PK","displayName":"Pakistan","$$hashKey":"object:18113"},{"value":"PS","displayName":"Palau","$$hashKey":"object:18114"},{"value":"LQ","displayName":"Palmyra Atoll","$$hashKey":"object:18115"},{"value":"PM","displayName":"Panama","$$hashKey":"object:18116"},{"value":"PP","displayName":"Papua New Guinea","$$hashKey":"object:18117"},{"value":"PF","displayName":"Paracel Islands","$$hashKey":"object:18118"},{"value":"PA","displayName":"Paraguay","$$hashKey":"object:18119"},{"value":"PE","displayName":"Peru","$$hashKey":"object:18120"},{"value":"RP","displayName":"Philippines","$$hashKey":"object:18121"},{"value":"PC","displayName":"Pitcairn Islands","$$hashKey":"object:18122"},{"value":"PL","displayName":"Poland","$$hashKey":"object:18123"},{"value":"PO","displayName":"Portugal","$$hashKey":"object:18124"},{"value":"RQ","displayName":"Puerto Rico","$$hashKey":"object:18125"},{"value":"QA","displayName":"Qatar","$$hashKey":"object:18126"},{"value":"RE","displayName":"Reunion","$$hashKey":"object:18127"},{"value":"RO","displayName":"Romania","$$hashKey":"object:18128"},{"value":"RS","displayName":"Russia","$$hashKey":"object:18129"},{"value":"RW","displayName":"Rwanda","$$hashKey":"object:18130"},{"value":"SH","displayName":"Saint Helena","$$hashKey":"object:18131"},{"value":"SC","displayName":"Saint Kitts and Nevis","$$hashKey":"object:18132"},{"value":"ST","displayName":"Saint Lucia","$$hashKey":"object:18133"},{"value":"RN","displayName":"Saint Martin","$$hashKey":"object:18134"},{"value":"SB","displayName":"Saint Pierre and Miquelon","$$hashKey":"object:18135"},{"value":"VC","displayName":"Saint Vincent and the Grenadines","$$hashKey":"object:18136"},{"value":"TB","displayName":"Saint-Barthelemy Island","$$hashKey":"object:18137"},{"value":"WS","displayName":"Samoa","$$hashKey":"object:18138"},{"value":"SM","displayName":"San Marino","$$hashKey":"object:18139"},{"value":"TP","displayName":"Sao Tome and Principe","$$hashKey":"object:18140"},{"value":"SA","displayName":"Saudi Arabia","$$hashKey":"object:18141"},{"value":"SG","displayName":"Senegal","$$hashKey":"object:18142"},{"value":"RI","displayName":"Serbia","$$hashKey":"object:18143"},{"value":"SE","displayName":"Seychelles","$$hashKey":"object:18144"},{"value":"SL","displayName":"Sierra Leone","$$hashKey":"object:18145"},{"value":"SN","displayName":"Singapore","$$hashKey":"object:18146"},{"value":"SI","displayName":"Slovenia","$$hashKey":"object:18147"},{"value":"BP","displayName":"Solomon Islands","$$hashKey":"object:18148"},{"value":"SO","displayName":"Somalia","$$hashKey":"object:18149"},{"value":"SF","displayName":"South Africa","$$hashKey":"object:18150"},{"value":"SX","displayName":"South Georgia and the South Sandwich Islands","$$hashKey":"object:18151"},{"value":"KS","displayName":"South Korea","$$hashKey":"object:18152"},{"value":"OD","displayName":"South Sudan","$$hashKey":"object:18153"},{"value":"SP","displayName":"Spain","$$hashKey":"object:18154"},{"value":"PG","displayName":"Spratly Islands","$$hashKey":"object:18155"},{"value":"CE","displayName":"Sri Lanka","$$hashKey":"object:18156"},{"value":"SU","displayName":"Sudan","$$hashKey":"object:18157"},{"value":"NS","displayName":"Suriname","$$hashKey":"object:18158"},{"value":"SV","displayName":"Svalbard","$$hashKey":"object:18159"},{"value":"WZ","displayName":"Swaziland","$$hashKey":"object:18160"},{"value":"SW","displayName":"Sweden","$$hashKey":"object:18161"},{"value":"SZ","displayName":"Switzerland","$$hashKey":"object:18162"},{"value":"SY","displayName":"Syria","$$hashKey":"object:18163"},{"value":"TW","displayName":"Taiwan","$$hashKey":"object:18164"},{"value":"TI","displayName":"Tajikistan","$$hashKey":"object:18165"},{"value":"TZ","displayName":"Tanzania","$$hashKey":"object:18166"},{"value":"TH","displayName":"Thailand","$$hashKey":"object:18167"},{"value":"TO","displayName":"Togo","$$hashKey":"object:18168"},{"value":"TL","displayName":"Tokelau","$$hashKey":"object:18169"},{"value":"TN","displayName":"Tonga","$$hashKey":"object:18170"},{"value":"TD","displayName":"Trinidad and Tobago","$$hashKey":"object:18171"},{"value":"TE","displayName":"Tromelin Island","$$hashKey":"object:18172"},{"value":"TS","displayName":"Tunisia","$$hashKey":"object:18173"},{"value":"TU","displayName":"Turkey","$$hashKey":"object:18174"},{"value":"TX","displayName":"Turkmenistan","$$hashKey":"object:18175"},{"value":"TK","displayName":"Turks and Caicos Islands","$$hashKey":"object:18176"},{"value":"TV","displayName":"Tuvalu","$$hashKey":"object:18177"},{"value":"UG","displayName":"Uganda","$$hashKey":"object:18178"},{"value":"UP","displayName":"Ukraine","$$hashKey":"object:18179"},{"value":"UF","displayName":"Undersea Features","$$hashKey":"object:18180"},{"value":"UU","displayName":"Undesignated Sovereignty","$$hashKey":"object:18181"},{"value":"AE","displayName":"United Arab Emirates","$$hashKey":"object:18182"},{"value":"UK","displayName":"United Kingdom","$$hashKey":"object:18183"},{"value":"US","displayName":"United States","$$hashKey":"object:18184"},{"value":"UY","displayName":"Uruguay","$$hashKey":"object:18185"},{"value":"UZ","displayName":"Uzbekistan","$$hashKey":"object:18186"},{"value":"NH","displayName":"Vanuatu","$$hashKey":"object:18187"},{"value":"VT","displayName":"Vatican City","$$hashKey":"object:18188"},{"value":"VE","displayName":"Venezuela","$$hashKey":"object:18189"},{"value":"VM","displayName":"Vietnam, Democratic Republic of","$$hashKey":"object:18190"},{"value":"VQ","displayName":"Virgin Islands","$$hashKey":"object:18191"},{"value":"WQ","displayName":"Wake Island","$$hashKey":"object:18192"},{"value":"WF","displayName":"Wallis and Futuna","$$hashKey":"object:18193"},{"value":"WE","displayName":"West Bank","$$hashKey":"object:18194"},{"value":"WI","displayName":"Western Sahara","$$hashKey":"object:18195"},{"value":"YM","displayName":"Yemen","$$hashKey":"object:18196"},{"value":"ZA","displayName":"Zambia","$$hashKey":"object:18197"},{"value":"ZI","displayName":"Zimbabwe","$$hashKey":"object:18198"}],"name":"Fips Country codes","displayName":"Fips Country codes","defaultValue":"FR","hidden":false,"$$hashKey":"object:17907"},"Mois":{"type":"Select","options":[{"value":"01","displayName":"Janvier","$$hashKey":"object:18205"},{"value":"02","displayName":"Février","$$hashKey":"object:18206"},{"value":"03","displayName":"Mars","$$hashKey":"object:18207"},{"value":"04","displayName":"Avril","$$hashKey":"object:18208"},{"value":"05","displayName":"Mai","$$hashKey":"object:18209"},{"value":"06","displayName":"Juin","$$hashKey":"object:18210"},{"value":"07","displayName":"Juillet","$$hashKey":"object:18211"},{"value":"08","displayName":"Août","$$hashKey":"object:18212"},{"value":"09","displayName":"Septembre","$$hashKey":"object:18213"},{"value":"10","displayName":"Octobre","$$hashKey":"object:18214"},{"value":"11","displayName":"Novembre","$$hashKey":"object:18215"},{"value":"12","displayName":"Décembre","$$hashKey":"object:18216"}],"name":"Mois","displayName":"Mois","defaultValue":"12","hidden":false,"$$hashKey":"object:17908"},"Langue":{"type":"Select","options":[{"value":"afr","displayName":"Afrikaans","$$hashKey":"object:18223"},{"value":"ara","displayName":"Arabe","$$hashKey":"object:18224"},{"value":"axe","displayName":"Azéri","$$hashKey":"object:18225"},{"value":"ben","displayName":"Bengali","$$hashKey":"object:18226"},{"value":"bos","displayName":"Bosnien","$$hashKey":"object:18227"},{"value":"bul","displayName":"Bulgare","$$hashKey":"object:18228"},{"value":"cat","displayName":"Catalan","$$hashKey":"object:18229"},{"value":"ces","displayName":"Tchèque","$$hashKey":"object:18230"},{"value":"dan","displayName":"Danois","$$hashKey":"object:18231"},{"value":"deu","displayName":"Allemand","$$hashKey":"object:18232"},{"value":"ell","displayName":"Grec moderne","$$hashKey":"object:18233"},{"value":"eng","displayName":"Anglais","$$hashKey":"object:18234"},{"value":"est","displayName":"Estonien","$$hashKey":"object:18235"},{"value":"fas","displayName":"Persan","$$hashKey":"object:18236"},{"value":"fin","displayName":"Finnois","$$hashKey":"object:18237"},{"value":"fra","displayName":"Français","$$hashKey":"object:18238"},{"value":"glg","displayName":"Galicien","$$hashKey":"object:18239"},{"value":"guj","displayName":"Gujarati","$$hashKey":"object:18240"},{"value":"heb","displayName":"Hébreu","$$hashKey":"object:18241"},{"value":"hin","displayName":"Hindi","$$hashKey":"object:18242"},{"value":"hrv","displayName":"Croate","$$hashKey":"object:18243"},{"value":"hun","displayName":"Hongrois","$$hashKey":"object:18244"},{"value":"hye","displayName":"Arménien","$$hashKey":"object:18245"},{"value":"ind","displayName":"Indonésien","$$hashKey":"object:18246"},{"value":"isl","displayName":"Islandais","$$hashKey":"object:18247"},{"value":"ita","displayName":"Italien","$$hashKey":"object:18248"},{"value":"jpn","displayName":"Japonais","$$hashKey":"object:18249"},{"value":"kan","displayName":"Kannada","$$hashKey":"object:18250"},{"value":"kat","displayName":"Géorgien","$$hashKey":"object:18251"},{"value":"kaz","displayName":"Kazakh","$$hashKey":"object:18252"},{"value":"kor","displayName":"Coréen","$$hashKey":"object:18253"},{"value":"lav","displayName":"Letton","$$hashKey":"object:18254"},{"value":"lit","displayName":"Lituanien","$$hashKey":"object:18255"},{"value":"mal","displayName":"Malayalam","$$hashKey":"object:18256"},{"value":"mar","displayName":"Marathi","$$hashKey":"object:18257"},{"value":"mkd","displayName":"Macédonien","$$hashKey":"object:18258"},{"value":"mon","displayName":"Mongol","$$hashKey":"object:18259"},{"value":"msa","displayName":"Malais","$$hashKey":"object:18260"},{"value":"nep","displayName":"Népalais","$$hashKey":"object:18261"},{"value":"nld","displayName":"Néerlandais","$$hashKey":"object:18262"},{"value":"nno","displayName":"Norvégien Nynorsk","$$hashKey":"object:18263"},{"value":"nor","displayName":"Norvégien","$$hashKey":"object:18264"},{"value":"pan","displayName":"Pendjabi","$$hashKey":"object:18265"},{"value":"pol","displayName":"Polonais","$$hashKey":"object:18266"},{"value":"por","displayName":"Portugais","$$hashKey":"object:18267"},{"value":"ron","displayName":"Roumain","$$hashKey":"object:18268"},{"value":"rus","displayName":"Russe","$$hashKey":"object:18269"},{"value":"sin","displayName":"Cingalais","$$hashKey":"object:18270"},{"value":"slk","displayName":"Slovaque","$$hashKey":"object:18271"},{"value":"slv","displayName":"Slovène","$$hashKey":"object:18272"},{"value":"som","displayName":"Somali","$$hashKey":"object:18273"},{"value":"spa","displayName":"Espagnol","$$hashKey":"object:18274"},{"value":"sqi","displayName":"Albanais","$$hashKey":"object:18275"},{"value":"srp","displayName":"Serbe","$$hashKey":"object:18276"},{"value":"swa","displayName":"Swahili","$$hashKey":"object:18277"},{"value":"swe","displayName":"Suédois","$$hashKey":"object:18278"},{"value":"tam","displayName":"Tamoul","$$hashKey":"object:18279"},{"value":"tel","displayName":"Télougou","$$hashKey":"object:18280"},{"value":"tha","displayName":"Thaï","$$hashKey":"object:18281"},{"value":"tur","displayName":"Turc","$$hashKey":"object:18282"},{"value":"ukr","displayName":"Ukrainien","$$hashKey":"object:18283"},{"value":"urd","displayName":"Ourdou","$$hashKey":"object:18284"},{"value":"vie","displayName":"Vietnamien","$$hashKey":"object:18285"},{"value":"zho","displayName":"Chinois","$$hashKey":"object:18286"}],"name":"Langue","displayName":"Langue","defaultValue":"eng","hidden":false,"$$hashKey":"object:17909"}}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Requete3FromMongo: org.apache.spark.sql.DataFrame = [Actor: string, CountryCode: string ... 8 more fields]\ndd_fipsCountry: Object = FR\ndd_mois: Object = 12\nmylangue: Object = eng\n"},{"type":"TABLE","data":"Mois\tCountryCode\tLangue\tActor\tnbpos\tnbneg\tsommepos\tsommeneg\tdeltanb\tdeltasomme\tnbttl\n201812\tFR\teng\tFRANCE\t16366\t116042\t46412.303307838025\t669801.4556264025\t0.7460666756485681\t623389.1523185645\t133602\n201812\tFR\teng\tPARIS\t7610\t57758\t15759.626242223381\t375715.98902778013\t0.7592774842157858\t359956.36278555676\t66047\n201812\tFR\teng\tFRENCH\t6748\t60660\t16847.21206070483\t392237.72636488936\t0.7951739701175533\t375390.51430418453\t67799\n201812\tFR\teng\tUNITED STATES\t964\t4880\t2211.2399466645174\t13949.8830644322\t0.6630545208262784\t11738.643117767682\t5906\n201812\tFR\teng\tPRESIDENT\t942\t10186\t1750.587347935138\t63414.989723724524\t0.8265379113018598\t61664.40237578939\t11184\n%table Mois\tCountryCode\tLangue\tActor\tnbpos\tnbneg\tsommepos\tsommeneg\tdeltanb\tdeltasomme\tnbttl\n201812\tFR\teng\tFRANCE\t16366\t116042\t46412.303307838025\t669801.4556264025\t0.7460666756485681\t623389.1523185645\t133602\n201812\tFR\teng\tFRENCH\t6748\t60660\t16847.21206070483\t392237.72636488936\t0.7951739701175533\t375390.51430418453\t67799\n201812\tFR\teng\tPARIS\t7610\t57758\t15759.626242223381\t375715.98902778013\t0.7592774842157858\t359956.36278555676\t66047\n201812\tFR\teng\tPOLICE\t47\t30918\t96.90211169307247\t242606.44063695168\t0.9966102789256198\t242509.5385252586\t30976\n201812\tFR\teng\tPROTESTER\t30\t22590\t45.49253947427683\t186224.5859646514\t0.9972593051012288\t186179.09342517713\t22622\n"}]},"apps":[],"jobName":"paragraph_1548333379725_810882870","id":"20190122-124104_780771289","dateCreated":"2019-01-24T13:36:19+0100","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16986"},{"text":"%md\n# BETTER 3\n\n## Requete 3(.2)\n\n- travaille sur table consolidée et sur la requete qui avait collecté plus de champs\n- meilleure info de pays qui peut se preter à une visualisation carte si on filtre les acteur non pays\n- requete directe sans agglomerats","user":"anonymous","dateUpdated":"2019-01-24T14:23:05+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>BETTER 3</h1>\n<h2>Requete 3(.2)</h2>\n<ul>\n  <li>travaille sur table consolidée et sur la requete qui avait collecté plus de champs</li>\n  <li>meilleure info de pays qui peut se preter à une visualisation carte si on filtre les acteur non pays</li>\n  <li>requete directe sans agglomerats</li>\n</ul>\n</div>"}]},"apps":[],"jobName":"paragraph_1548335968963_-1112999641","id":"20190124-141928_1532892584","dateCreated":"2019-01-24T14:19:28+0100","dateStarted":"2019-01-24T14:23:05+0100","dateFinished":"2019-01-24T14:23:05+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16987"},{"text":"// Lecture Requete 3bis\n\n// lien base\nval Requete32FromMongo = MongoSpark.\n                        load(sc, ReadConfig(Map(\"uri\" -> MONGO_URI_REQUETE32)) ).\n                        toDF()\n                        \nRequete32FromMongo.createOrReplaceTempView(\"TableRequete32\")\n\nval dd_fipsCountry = z.select(\"Fips Country codes\", \"FR\", listcodes(\"fipsCountries\"))\nval dd_mois = getMonths()\nval mylangue = getLangues()\n\nz.show(spark.sql(\"\"\"\nselect\n  Mois, CountryCode, Langue, Actor, nbpos, nbneg, sommepos, sommeneg\nfrom TableRequete32\nwhere CountryCode ='\"\"\" + dd_fipsCountry  +\"\"\"'  \n  and Mois = '2018\"\"\" + dd_mois + \"\"\"' and Langue = '\"\"\" + mylangue +\"\"\"'  \norder by nbpos desc\nlimit 5\n\"\"\"))\n\n// toujours le probleme zeppelin incapable d'afficher 2 tables bien séparées si on est dans une même cellule\n// donc ya une fausse ligne dans le retour entre le top positif et le top negatif\n\nz.show(spark.sql(\"\"\"\nselect\n  Mois, CountryCode, Langue, Actor, nbpos, nbneg, sommepos, sommeneg\nfrom TableRequete32\nwhere CountryCode ='\"\"\" + dd_fipsCountry  +\"\"\"'  \n  and Mois = '2018\"\"\" + dd_mois + \"\"\"' and Langue = '\"\"\" + mylangue +\"\"\"'  \norder by nbneg desc\nlimit 5\n\"\"\"))\n","user":"anonymous","dateUpdated":"2019-01-24T14:25:16+0100","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"runOnSelectionChange":true,"results":{"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Mois":"string","CountryCode":"string","Langue":"string","Actor":"string","nbpos":"string","nbneg":"string","sommepos":"string","sommeneg":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{"Fips Country codes":"FR","Mois":"12","Langue":"eng"},"forms":{"Fips Country codes":{"type":"Select","options":[{"value":"AF","displayName":"Afghanistan","$$hashKey":"object:18327"},{"value":"AX","displayName":"Akrotiri Sovereign Base Area","$$hashKey":"object:18328"},{"value":"AL","displayName":"Albania","$$hashKey":"object:18329"},{"value":"AG","displayName":"Algeria","$$hashKey":"object:18330"},{"value":"AQ","displayName":"American Samoa","$$hashKey":"object:18331"},{"value":"AN","displayName":"Andorra","$$hashKey":"object:18332"},{"value":"AO","displayName":"Angola","$$hashKey":"object:18333"},{"value":"AV","displayName":"Anguilla","$$hashKey":"object:18334"},{"value":"AY","displayName":"Antarctica","$$hashKey":"object:18335"},{"value":"AC","displayName":"Antigua and Barbuda","$$hashKey":"object:18336"},{"value":"AR","displayName":"Argentina","$$hashKey":"object:18337"},{"value":"AM","displayName":"Armenia","$$hashKey":"object:18338"},{"value":"AA","displayName":"Aruba","$$hashKey":"object:18339"},{"value":"AT","displayName":"Ashmore and Cartier Islands","$$hashKey":"object:18340"},{"value":"AS","displayName":"Australia","$$hashKey":"object:18341"},{"value":"AU","displayName":"Austria","$$hashKey":"object:18342"},{"value":"AJ","displayName":"Azerbaijan","$$hashKey":"object:18343"},{"value":"BF","displayName":"Bahamas, The","$$hashKey":"object:18344"},{"value":"BA","displayName":"Bahrain","$$hashKey":"object:18345"},{"value":"FQ","displayName":"Baker Island","$$hashKey":"object:18346"},{"value":"BG","displayName":"Bangladesh","$$hashKey":"object:18347"},{"value":"BB","displayName":"Barbados","$$hashKey":"object:18348"},{"value":"BS","displayName":"Bassas da India","$$hashKey":"object:18349"},{"value":"BO","displayName":"Belarus","$$hashKey":"object:18350"},{"value":"BE","displayName":"Belgium","$$hashKey":"object:18351"},{"value":"BH","displayName":"Belize","$$hashKey":"object:18352"},{"value":"BN","displayName":"Benin","$$hashKey":"object:18353"},{"value":"BD","displayName":"Bermuda","$$hashKey":"object:18354"},{"value":"BT","displayName":"Bhutan","$$hashKey":"object:18355"},{"value":"BL","displayName":"Bolivia","$$hashKey":"object:18356"},{"value":"BK","displayName":"Bosnia-Herzegovina","$$hashKey":"object:18357"},{"value":"BC","displayName":"Botswana","$$hashKey":"object:18358"},{"value":"BV","displayName":"Bouvet Island","$$hashKey":"object:18359"},{"value":"BR","displayName":"Brazil","$$hashKey":"object:18360"},{"value":"IO","displayName":"British Indian Ocean Territory","$$hashKey":"object:18361"},{"value":"VI","displayName":"British Virgin Islands","$$hashKey":"object:18362"},{"value":"BX","displayName":"Brunei","$$hashKey":"object:18363"},{"value":"BU","displayName":"Bulgaria","$$hashKey":"object:18364"},{"value":"UV","displayName":"Burkina Faso","$$hashKey":"object:18365"},{"value":"BY","displayName":"Burundi","$$hashKey":"object:18366"},{"value":"CB","displayName":"Cambodia","$$hashKey":"object:18367"},{"value":"CM","displayName":"Cameroon","$$hashKey":"object:18368"},{"value":"CA","displayName":"Canada","$$hashKey":"object:18369"},{"value":"CV","displayName":"Cape Verde","$$hashKey":"object:18370"},{"value":"CJ","displayName":"Cayman Islands","$$hashKey":"object:18371"},{"value":"CT","displayName":"Central African Republic","$$hashKey":"object:18372"},{"value":"CD","displayName":"Chad","$$hashKey":"object:18373"},{"value":"CI","displayName":"Chile","$$hashKey":"object:18374"},{"value":"CH","displayName":"China","$$hashKey":"object:18375"},{"value":"KT","displayName":"Christmas Island","$$hashKey":"object:18376"},{"value":"IP","displayName":"Clipperton Island","$$hashKey":"object:18377"},{"value":"CK","displayName":"Cocos Keeling Islands","$$hashKey":"object:18378"},{"value":"CO","displayName":"Colombia","$$hashKey":"object:18379"},{"value":"CN","displayName":"Comoros","$$hashKey":"object:18380"},{"value":"CF","displayName":"Congo","$$hashKey":"object:18381"},{"value":"CW","displayName":"Cook Islands","$$hashKey":"object:18382"},{"value":"CR","displayName":"Coral Sea Islands","$$hashKey":"object:18383"},{"value":"CS","displayName":"Costa Rica","$$hashKey":"object:18384"},{"value":"IV","displayName":"Cote dIvoire","$$hashKey":"object:18385"},{"value":"HR","displayName":"Croatia","$$hashKey":"object:18386"},{"value":"CU","displayName":"Cuba","$$hashKey":"object:18387"},{"value":"CY","displayName":"Cyprus","$$hashKey":"object:18388"},{"value":"EZ","displayName":"Czech Republic","$$hashKey":"object:18389"},{"value":"LO","displayName":"Czechoslovakia","$$hashKey":"object:18390"},{"value":"CG","displayName":"Democratic Republic of the Congo","$$hashKey":"object:18391"},{"value":"DA","displayName":"Denmark","$$hashKey":"object:18392"},{"value":"DX","displayName":"Dhekelia Sovereign Base Area","$$hashKey":"object:18393"},{"value":"DJ","displayName":"Djibouti","$$hashKey":"object:18394"},{"value":"DO","displayName":"Dominica","$$hashKey":"object:18395"},{"value":"DR","displayName":"Dominican Republic","$$hashKey":"object:18396"},{"value":"TT","displayName":"East Timor","$$hashKey":"object:18397"},{"value":"EC","displayName":"Ecuador","$$hashKey":"object:18398"},{"value":"EG","displayName":"Egypt","$$hashKey":"object:18399"},{"value":"ES","displayName":"El Salvador","$$hashKey":"object:18400"},{"value":"GV","displayName":"Equatorial Guinea","$$hashKey":"object:18401"},{"value":"EK","displayName":"Equatorial Guinea","$$hashKey":"object:18402"},{"value":"ER","displayName":"Eritrea","$$hashKey":"object:18403"},{"value":"EN","displayName":"Estonia","$$hashKey":"object:18404"},{"value":"ET","displayName":"Ethiopia","$$hashKey":"object:18405"},{"value":"PJ","displayName":"Etorofu, Habomai, Kunashiri and Shikotan Islands","$$hashKey":"object:18406"},{"value":"EU","displayName":"Europa Island","$$hashKey":"object:18407"},{"value":"FK","displayName":"Falkland Islands Islas Malvinas","$$hashKey":"object:18408"},{"value":"FO","displayName":"Faroe Islands","$$hashKey":"object:18409"},{"value":"FJ","displayName":"Fiji","$$hashKey":"object:18410"},{"value":"FI","displayName":"Finland","$$hashKey":"object:18411"},{"value":"FR","displayName":"France","$$hashKey":"object:18412"},{"value":"FG","displayName":"French Guiana","$$hashKey":"object:18413"},{"value":"FP","displayName":"French Polynesia","$$hashKey":"object:18414"},{"value":"FS","displayName":"French Southern and Antarctic Lands","$$hashKey":"object:18415"},{"value":"GB","displayName":"Gabon","$$hashKey":"object:18416"},{"value":"GA","displayName":"Gambia","$$hashKey":"object:18417"},{"value":"GZ","displayName":"Gaza Strip","$$hashKey":"object:18418"},{"value":"GG","displayName":"Georgia","$$hashKey":"object:18419"},{"value":"GM","displayName":"Germany","$$hashKey":"object:18420"},{"value":"GH","displayName":"Ghana","$$hashKey":"object:18421"},{"value":"GI","displayName":"Gibraltar","$$hashKey":"object:18422"},{"value":"GO","displayName":"Glorioso Islands","$$hashKey":"object:18423"},{"value":"GR","displayName":"Greece","$$hashKey":"object:18424"},{"value":"GL","displayName":"Greenland","$$hashKey":"object:18425"},{"value":"GJ","displayName":"Grenada","$$hashKey":"object:18426"},{"value":"GP","displayName":"Guadeloupe","$$hashKey":"object:18427"},{"value":"GQ","displayName":"Guam","$$hashKey":"object:18428"},{"value":"GT","displayName":"Guatemala","$$hashKey":"object:18429"},{"value":"GK","displayName":"Guernsey","$$hashKey":"object:18430"},{"value":"PU","displayName":"Guinea-Bissau","$$hashKey":"object:18431"},{"value":"GY","displayName":"Guyana","$$hashKey":"object:18432"},{"value":"HA","displayName":"Haiti","$$hashKey":"object:18433"},{"value":"HM","displayName":"Heard Island and McDonald Islands","$$hashKey":"object:18434"},{"value":"HO","displayName":"Honduras","$$hashKey":"object:18435"},{"value":"HK","displayName":"Hong Kong","$$hashKey":"object:18436"},{"value":"HQ","displayName":"Howland Island","$$hashKey":"object:18437"},{"value":"HU","displayName":"Hungary","$$hashKey":"object:18438"},{"value":"IC","displayName":"Iceland","$$hashKey":"object:18439"},{"value":"IN","displayName":"India","$$hashKey":"object:18440"},{"value":"ID","displayName":"Indonesia","$$hashKey":"object:18441"},{"value":"IR","displayName":"Iran","$$hashKey":"object:18442"},{"value":"IZ","displayName":"Iraq","$$hashKey":"object:18443"},{"value":"EI","displayName":"Ireland","$$hashKey":"object:18444"},{"value":"IM","displayName":"Isle of Man","$$hashKey":"object:18445"},{"value":"IS","displayName":"Israel","$$hashKey":"object:18446"},{"value":"IT","displayName":"Italy","$$hashKey":"object:18447"},{"value":"JM","displayName":"Jamaica","$$hashKey":"object:18448"},{"value":"JN","displayName":"Jan Mayen","$$hashKey":"object:18449"},{"value":"JA","displayName":"Japan","$$hashKey":"object:18450"},{"value":"DQ","displayName":"Jarvis Island","$$hashKey":"object:18451"},{"value":"JE","displayName":"Jersey","$$hashKey":"object:18452"},{"value":"JQ","displayName":"Johnston Atoll","$$hashKey":"object:18453"},{"value":"JO","displayName":"Jordan","$$hashKey":"object:18454"},{"value":"JU","displayName":"Juan de Nova Island","$$hashKey":"object:18455"},{"value":"KZ","displayName":"Kazakhstan","$$hashKey":"object:18456"},{"value":"KE","displayName":"Kenya","$$hashKey":"object:18457"},{"value":"KQ","displayName":"Kingman Reef","$$hashKey":"object:18458"},{"value":"KR","displayName":"Kiribati","$$hashKey":"object:18459"},{"value":"KV","displayName":"Kosovo","$$hashKey":"object:18460"},{"value":"KU","displayName":"Kuwait","$$hashKey":"object:18461"},{"value":"KG","displayName":"Kyrgyzstan","$$hashKey":"object:18462"},{"value":"LA","displayName":"Laos","$$hashKey":"object:18463"},{"value":"LG","displayName":"Latvia","$$hashKey":"object:18464"},{"value":"LE","displayName":"Lebanon","$$hashKey":"object:18465"},{"value":"LT","displayName":"Lesotho","$$hashKey":"object:18466"},{"value":"LI","displayName":"Liberia","$$hashKey":"object:18467"},{"value":"LY","displayName":"Libya","$$hashKey":"object:18468"},{"value":"LS","displayName":"Liechtenstein","$$hashKey":"object:18469"},{"value":"LH","displayName":"Lithuania","$$hashKey":"object:18470"},{"value":"LU","displayName":"Luxembourg","$$hashKey":"object:18471"},{"value":"MC","displayName":"Macau","$$hashKey":"object:18472"},{"value":"MK","displayName":"Macedonia","$$hashKey":"object:18473"},{"value":"MA","displayName":"Madagascar","$$hashKey":"object:18474"},{"value":"MI","displayName":"Malawi","$$hashKey":"object:18475"},{"value":"MY","displayName":"Malaysia","$$hashKey":"object:18476"},{"value":"MV","displayName":"Maldives","$$hashKey":"object:18477"},{"value":"ML","displayName":"Mali","$$hashKey":"object:18478"},{"value":"MT","displayName":"Malta","$$hashKey":"object:18479"},{"value":"RM","displayName":"Marshall Islands","$$hashKey":"object:18480"},{"value":"MB","displayName":"Martinique","$$hashKey":"object:18481"},{"value":"MR","displayName":"Mauritania","$$hashKey":"object:18482"},{"value":"MP","displayName":"Mauritius","$$hashKey":"object:18483"},{"value":"MF","displayName":"Mayotte","$$hashKey":"object:18484"},{"value":"MX","displayName":"Mexico","$$hashKey":"object:18485"},{"value":"FM","displayName":"Micronesia","$$hashKey":"object:18486"},{"value":"MQ","displayName":"Midway Islands","$$hashKey":"object:18487"},{"value":"MD","displayName":"Moldova","$$hashKey":"object:18488"},{"value":"MN","displayName":"Monaco","$$hashKey":"object:18489"},{"value":"MG","displayName":"Mongolia","$$hashKey":"object:18490"},{"value":"MJ","displayName":"Montenegro","$$hashKey":"object:18491"},{"value":"MH","displayName":"Montserrat","$$hashKey":"object:18492"},{"value":"MO","displayName":"Morocco","$$hashKey":"object:18493"},{"value":"MZ","displayName":"Mozambique","$$hashKey":"object:18494"},{"value":"BM","displayName":"Myanmar","$$hashKey":"object:18495"},{"value":"WA","displayName":"Namibia","$$hashKey":"object:18496"},{"value":"NR","displayName":"Nauru","$$hashKey":"object:18497"},{"value":"BQ","displayName":"Navassa Island","$$hashKey":"object:18498"},{"value":"NP","displayName":"Nepal","$$hashKey":"object:18499"},{"value":"NL","displayName":"Netherlands","$$hashKey":"object:18500"},{"value":"NT","displayName":"Netherlands Antilles","$$hashKey":"object:18501"},{"value":"NC","displayName":"New Caledonia","$$hashKey":"object:18502"},{"value":"NZ","displayName":"New Zealand","$$hashKey":"object:18503"},{"value":"NU","displayName":"Nicaragua","$$hashKey":"object:18504"},{"value":"NG","displayName":"Niger","$$hashKey":"object:18505"},{"value":"NI","displayName":"Nigeria","$$hashKey":"object:18506"},{"value":"NE","displayName":"Niue","$$hashKey":"object:18507"},{"value":"NM","displayName":"No Mans Land","$$hashKey":"object:18508"},{"value":"NF","displayName":"Norfolk Island","$$hashKey":"object:18509"},{"value":"KN","displayName":"North Korea","$$hashKey":"object:18510"},{"value":"CQ","displayName":"Northern Mariana Islands","$$hashKey":"object:18511"},{"value":"NO","displayName":"Norway","$$hashKey":"object:18512"},{"value":"OS","displayName":"Oceans","$$hashKey":"object:18513"},{"value":"MU","displayName":"Oman","$$hashKey":"object:18514"},{"value":"PK","displayName":"Pakistan","$$hashKey":"object:18515"},{"value":"PS","displayName":"Palau","$$hashKey":"object:18516"},{"value":"LQ","displayName":"Palmyra Atoll","$$hashKey":"object:18517"},{"value":"PM","displayName":"Panama","$$hashKey":"object:18518"},{"value":"PP","displayName":"Papua New Guinea","$$hashKey":"object:18519"},{"value":"PF","displayName":"Paracel Islands","$$hashKey":"object:18520"},{"value":"PA","displayName":"Paraguay","$$hashKey":"object:18521"},{"value":"PE","displayName":"Peru","$$hashKey":"object:18522"},{"value":"RP","displayName":"Philippines","$$hashKey":"object:18523"},{"value":"PC","displayName":"Pitcairn Islands","$$hashKey":"object:18524"},{"value":"PL","displayName":"Poland","$$hashKey":"object:18525"},{"value":"PO","displayName":"Portugal","$$hashKey":"object:18526"},{"value":"RQ","displayName":"Puerto Rico","$$hashKey":"object:18527"},{"value":"QA","displayName":"Qatar","$$hashKey":"object:18528"},{"value":"RE","displayName":"Reunion","$$hashKey":"object:18529"},{"value":"RO","displayName":"Romania","$$hashKey":"object:18530"},{"value":"RS","displayName":"Russia","$$hashKey":"object:18531"},{"value":"RW","displayName":"Rwanda","$$hashKey":"object:18532"},{"value":"SH","displayName":"Saint Helena","$$hashKey":"object:18533"},{"value":"SC","displayName":"Saint Kitts and Nevis","$$hashKey":"object:18534"},{"value":"ST","displayName":"Saint Lucia","$$hashKey":"object:18535"},{"value":"RN","displayName":"Saint Martin","$$hashKey":"object:18536"},{"value":"SB","displayName":"Saint Pierre and Miquelon","$$hashKey":"object:18537"},{"value":"VC","displayName":"Saint Vincent and the Grenadines","$$hashKey":"object:18538"},{"value":"TB","displayName":"Saint-Barthelemy Island","$$hashKey":"object:18539"},{"value":"WS","displayName":"Samoa","$$hashKey":"object:18540"},{"value":"SM","displayName":"San Marino","$$hashKey":"object:18541"},{"value":"TP","displayName":"Sao Tome and Principe","$$hashKey":"object:18542"},{"value":"SA","displayName":"Saudi Arabia","$$hashKey":"object:18543"},{"value":"SG","displayName":"Senegal","$$hashKey":"object:18544"},{"value":"RI","displayName":"Serbia","$$hashKey":"object:18545"},{"value":"SE","displayName":"Seychelles","$$hashKey":"object:18546"},{"value":"SL","displayName":"Sierra Leone","$$hashKey":"object:18547"},{"value":"SN","displayName":"Singapore","$$hashKey":"object:18548"},{"value":"SI","displayName":"Slovenia","$$hashKey":"object:18549"},{"value":"BP","displayName":"Solomon Islands","$$hashKey":"object:18550"},{"value":"SO","displayName":"Somalia","$$hashKey":"object:18551"},{"value":"SF","displayName":"South Africa","$$hashKey":"object:18552"},{"value":"SX","displayName":"South Georgia and the South Sandwich Islands","$$hashKey":"object:18553"},{"value":"KS","displayName":"South Korea","$$hashKey":"object:18554"},{"value":"OD","displayName":"South Sudan","$$hashKey":"object:18555"},{"value":"SP","displayName":"Spain","$$hashKey":"object:18556"},{"value":"PG","displayName":"Spratly Islands","$$hashKey":"object:18557"},{"value":"CE","displayName":"Sri Lanka","$$hashKey":"object:18558"},{"value":"SU","displayName":"Sudan","$$hashKey":"object:18559"},{"value":"NS","displayName":"Suriname","$$hashKey":"object:18560"},{"value":"SV","displayName":"Svalbard","$$hashKey":"object:18561"},{"value":"WZ","displayName":"Swaziland","$$hashKey":"object:18562"},{"value":"SW","displayName":"Sweden","$$hashKey":"object:18563"},{"value":"SZ","displayName":"Switzerland","$$hashKey":"object:18564"},{"value":"SY","displayName":"Syria","$$hashKey":"object:18565"},{"value":"TW","displayName":"Taiwan","$$hashKey":"object:18566"},{"value":"TI","displayName":"Tajikistan","$$hashKey":"object:18567"},{"value":"TZ","displayName":"Tanzania","$$hashKey":"object:18568"},{"value":"TH","displayName":"Thailand","$$hashKey":"object:18569"},{"value":"TO","displayName":"Togo","$$hashKey":"object:18570"},{"value":"TL","displayName":"Tokelau","$$hashKey":"object:18571"},{"value":"TN","displayName":"Tonga","$$hashKey":"object:18572"},{"value":"TD","displayName":"Trinidad and Tobago","$$hashKey":"object:18573"},{"value":"TE","displayName":"Tromelin Island","$$hashKey":"object:18574"},{"value":"TS","displayName":"Tunisia","$$hashKey":"object:18575"},{"value":"TU","displayName":"Turkey","$$hashKey":"object:18576"},{"value":"TX","displayName":"Turkmenistan","$$hashKey":"object:18577"},{"value":"TK","displayName":"Turks and Caicos Islands","$$hashKey":"object:18578"},{"value":"TV","displayName":"Tuvalu","$$hashKey":"object:18579"},{"value":"UG","displayName":"Uganda","$$hashKey":"object:18580"},{"value":"UP","displayName":"Ukraine","$$hashKey":"object:18581"},{"value":"UF","displayName":"Undersea Features","$$hashKey":"object:18582"},{"value":"UU","displayName":"Undesignated Sovereignty","$$hashKey":"object:18583"},{"value":"AE","displayName":"United Arab Emirates","$$hashKey":"object:18584"},{"value":"UK","displayName":"United Kingdom","$$hashKey":"object:18585"},{"value":"US","displayName":"United States","$$hashKey":"object:18586"},{"value":"UY","displayName":"Uruguay","$$hashKey":"object:18587"},{"value":"UZ","displayName":"Uzbekistan","$$hashKey":"object:18588"},{"value":"NH","displayName":"Vanuatu","$$hashKey":"object:18589"},{"value":"VT","displayName":"Vatican City","$$hashKey":"object:18590"},{"value":"VE","displayName":"Venezuela","$$hashKey":"object:18591"},{"value":"VM","displayName":"Vietnam, Democratic Republic of","$$hashKey":"object:18592"},{"value":"VQ","displayName":"Virgin Islands","$$hashKey":"object:18593"},{"value":"WQ","displayName":"Wake Island","$$hashKey":"object:18594"},{"value":"WF","displayName":"Wallis and Futuna","$$hashKey":"object:18595"},{"value":"WE","displayName":"West Bank","$$hashKey":"object:18596"},{"value":"WI","displayName":"Western Sahara","$$hashKey":"object:18597"},{"value":"YM","displayName":"Yemen","$$hashKey":"object:18598"},{"value":"ZA","displayName":"Zambia","$$hashKey":"object:18599"},{"value":"ZI","displayName":"Zimbabwe","$$hashKey":"object:18600"}],"name":"Fips Country codes","displayName":"Fips Country codes","defaultValue":"FR","hidden":false,"$$hashKey":"object:18309"},"Mois":{"type":"Select","options":[{"value":"01","displayName":"Janvier","$$hashKey":"object:18607"},{"value":"02","displayName":"Février","$$hashKey":"object:18608"},{"value":"03","displayName":"Mars","$$hashKey":"object:18609"},{"value":"04","displayName":"Avril","$$hashKey":"object:18610"},{"value":"05","displayName":"Mai","$$hashKey":"object:18611"},{"value":"06","displayName":"Juin","$$hashKey":"object:18612"},{"value":"07","displayName":"Juillet","$$hashKey":"object:18613"},{"value":"08","displayName":"Août","$$hashKey":"object:18614"},{"value":"09","displayName":"Septembre","$$hashKey":"object:18615"},{"value":"10","displayName":"Octobre","$$hashKey":"object:18616"},{"value":"11","displayName":"Novembre","$$hashKey":"object:18617"},{"value":"12","displayName":"Décembre","$$hashKey":"object:18618"}],"name":"Mois","displayName":"Mois","defaultValue":"12","hidden":false,"$$hashKey":"object:18310"},"Langue":{"type":"Select","options":[{"value":"afr","displayName":"Afrikaans","$$hashKey":"object:18625"},{"value":"ara","displayName":"Arabe","$$hashKey":"object:18626"},{"value":"axe","displayName":"Azéri","$$hashKey":"object:18627"},{"value":"ben","displayName":"Bengali","$$hashKey":"object:18628"},{"value":"bos","displayName":"Bosnien","$$hashKey":"object:18629"},{"value":"bul","displayName":"Bulgare","$$hashKey":"object:18630"},{"value":"cat","displayName":"Catalan","$$hashKey":"object:18631"},{"value":"ces","displayName":"Tchèque","$$hashKey":"object:18632"},{"value":"dan","displayName":"Danois","$$hashKey":"object:18633"},{"value":"deu","displayName":"Allemand","$$hashKey":"object:18634"},{"value":"ell","displayName":"Grec moderne","$$hashKey":"object:18635"},{"value":"eng","displayName":"Anglais","$$hashKey":"object:18636"},{"value":"est","displayName":"Estonien","$$hashKey":"object:18637"},{"value":"fas","displayName":"Persan","$$hashKey":"object:18638"},{"value":"fin","displayName":"Finnois","$$hashKey":"object:18639"},{"value":"fra","displayName":"Français","$$hashKey":"object:18640"},{"value":"glg","displayName":"Galicien","$$hashKey":"object:18641"},{"value":"guj","displayName":"Gujarati","$$hashKey":"object:18642"},{"value":"heb","displayName":"Hébreu","$$hashKey":"object:18643"},{"value":"hin","displayName":"Hindi","$$hashKey":"object:18644"},{"value":"hrv","displayName":"Croate","$$hashKey":"object:18645"},{"value":"hun","displayName":"Hongrois","$$hashKey":"object:18646"},{"value":"hye","displayName":"Arménien","$$hashKey":"object:18647"},{"value":"ind","displayName":"Indonésien","$$hashKey":"object:18648"},{"value":"isl","displayName":"Islandais","$$hashKey":"object:18649"},{"value":"ita","displayName":"Italien","$$hashKey":"object:18650"},{"value":"jpn","displayName":"Japonais","$$hashKey":"object:18651"},{"value":"kan","displayName":"Kannada","$$hashKey":"object:18652"},{"value":"kat","displayName":"Géorgien","$$hashKey":"object:18653"},{"value":"kaz","displayName":"Kazakh","$$hashKey":"object:18654"},{"value":"kor","displayName":"Coréen","$$hashKey":"object:18655"},{"value":"lav","displayName":"Letton","$$hashKey":"object:18656"},{"value":"lit","displayName":"Lituanien","$$hashKey":"object:18657"},{"value":"mal","displayName":"Malayalam","$$hashKey":"object:18658"},{"value":"mar","displayName":"Marathi","$$hashKey":"object:18659"},{"value":"mkd","displayName":"Macédonien","$$hashKey":"object:18660"},{"value":"mon","displayName":"Mongol","$$hashKey":"object:18661"},{"value":"msa","displayName":"Malais","$$hashKey":"object:18662"},{"value":"nep","displayName":"Népalais","$$hashKey":"object:18663"},{"value":"nld","displayName":"Néerlandais","$$hashKey":"object:18664"},{"value":"nno","displayName":"Norvégien Nynorsk","$$hashKey":"object:18665"},{"value":"nor","displayName":"Norvégien","$$hashKey":"object:18666"},{"value":"pan","displayName":"Pendjabi","$$hashKey":"object:18667"},{"value":"pol","displayName":"Polonais","$$hashKey":"object:18668"},{"value":"por","displayName":"Portugais","$$hashKey":"object:18669"},{"value":"ron","displayName":"Roumain","$$hashKey":"object:18670"},{"value":"rus","displayName":"Russe","$$hashKey":"object:18671"},{"value":"sin","displayName":"Cingalais","$$hashKey":"object:18672"},{"value":"slk","displayName":"Slovaque","$$hashKey":"object:18673"},{"value":"slv","displayName":"Slovène","$$hashKey":"object:18674"},{"value":"som","displayName":"Somali","$$hashKey":"object:18675"},{"value":"spa","displayName":"Espagnol","$$hashKey":"object:18676"},{"value":"sqi","displayName":"Albanais","$$hashKey":"object:18677"},{"value":"srp","displayName":"Serbe","$$hashKey":"object:18678"},{"value":"swa","displayName":"Swahili","$$hashKey":"object:18679"},{"value":"swe","displayName":"Suédois","$$hashKey":"object:18680"},{"value":"tam","displayName":"Tamoul","$$hashKey":"object:18681"},{"value":"tel","displayName":"Télougou","$$hashKey":"object:18682"},{"value":"tha","displayName":"Thaï","$$hashKey":"object:18683"},{"value":"tur","displayName":"Turc","$$hashKey":"object:18684"},{"value":"ukr","displayName":"Ukrainien","$$hashKey":"object:18685"},{"value":"urd","displayName":"Ourdou","$$hashKey":"object:18686"},{"value":"vie","displayName":"Vietnamien","$$hashKey":"object:18687"},{"value":"zho","displayName":"Chinois","$$hashKey":"object:18688"}],"name":"Langue","displayName":"Langue","defaultValue":"eng","hidden":false,"$$hashKey":"object:18311"}}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Requete32FromMongo: org.apache.spark.sql.DataFrame = [Actor: string, ActorCode: string ... 14 more fields]\ndd_fipsCountry: Object = FR\ndd_mois: Object = 12\nmylangue: Object = eng\n"},{"type":"TABLE","data":"Mois\tCountryCode\tLangue\tActor\tnbpos\tnbneg\tsommepos\tsommeneg\n201812\tFR\teng\tPARIS\t2916\t17160\t4044.4132134552165\t118512.69069189277\n201812\tFR\teng\tFRANCE\t2501\t20069\t5053.01327561046\t93602.8718621615\n201812\tFR\teng\tFRENCH\t1175\t9125\t2954.2854901449864\t57552.363921597534\n201812\tFR\teng\tCROWN PRINCE\t632\t105\t2174.599839829237\t317.6907196280485\n201812\tFR\teng\tFRANCE\t428\t3577\t1090.781313699596\t19992.04644960941\n%table Mois\tCountryCode\tLangue\tActor\tnbpos\tnbneg\tsommepos\tsommeneg\n201812\tFR\teng\tFRANCE\t2501\t20069\t5053.01327561046\t93602.8718621615\n201812\tFR\teng\tPARIS\t2916\t17160\t4044.4132134552165\t118512.69069189277\n201812\tFR\teng\tFRENCH\t1175\t9125\t2954.2854901449864\t57552.363921597534\n201812\tFR\teng\tPROTESTER\t2\t7395\t10.71428571428572\t65538.19970944921\n201812\tFR\teng\tPOLICE\t6\t6915\t8.44793610083624\t60193.45899565149\n"}]},"apps":[],"jobName":"paragraph_1548333379726_170325306","id":"20190123-171841_1676102110","dateCreated":"2019-01-24T13:36:19+0100","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16988"},{"text":"%md\n\n## Requete 4\n\n# DEPRECATED\n\n(raisons :\n- ancien format construit sur l'ancienne requete 3\n- pas la bonne metrique\n)","user":"anonymous","dateUpdated":"2019-01-24T14:30:07+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":false,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Requete 4</h2>\n<h1>DEPRECATED</h1>\n<p>(raisons :<br/>- ancien format construit sur l&rsquo;ancienne requete 3<br/>- pas la bonne metrique<br/>)</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548336318517_-88061289","id":"20190124-142518_455936502","dateCreated":"2019-01-24T14:25:18+0100","dateStarted":"2019-01-24T14:28:46+0100","dateFinished":"2019-01-24T14:28:46+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16989"},{"text":"// Lecture Requete 4\n\n// lien\nval Requete4FromMongo = MongoSpark.\n                        load(sc, ReadConfig(Map(\"uri\" -> MONGO_URI_REQUETE4)) ).\n                        toDF()\n                        \nRequete4FromMongo.createOrReplaceTempView(\"TableRequete4\")\n\n// pas d'input : a la limite ajouter le \"10\" du limit 10 en input ??\n\nz.show(spark.sql(\"\"\"\nselect\n Actor, stat\nfrom\nTableRequete4\norder by stat\nlimit 10\n\"\"\"))","user":"anonymous","dateUpdated":"2019-01-24T14:29:37+0100","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"runOnSelectionChange":true,"results":{"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Actor":"string","stat":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{"Fips Country codes":"FR","Mois":"12"},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Requete4FromMongo: org.apache.spark.sql.DataFrame = [Actor: string, _id: struct<oid: string> ... 1 more field]\n"},{"type":"TABLE","data":"Actor\tstat\nNEW HAMPSHIRE\t0.02564102564102564\nVADODARA\t0.051759834368530024\nPALEMBANG\t0.05578512396694215\nOSAGE\t0.06865671641791045\nLILONGWE\t0.07228915662650602\nSOUTH CAROLINA\t0.07695517405817835\nWEST BENGAL\t0.08261562998405103\nCHHATTISGARH\t0.09070087036188731\nYORUBA\t0.09073724007561437\nMONTERREY\t0.09686609686609686\n"}]},"apps":[],"jobName":"paragraph_1548333379727_-1315492017","id":"20190122-215305_1497022689","dateCreated":"2019-01-24T13:36:19+0100","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16990"},{"text":"%md\n\n# Requete 4 : (V2)\n\nActeur(s) qui divise(nt) le plus\n\nmétriques retenues : \n- stat1  taux du nb positifs (goldenstein event) proche du taux nb de negatifs\n- stat2  cumul des valeurs positives proche du cumul des valeurs negatives rapportées au nb d'evenements\n","user":"anonymous","dateUpdated":"2019-01-24T14:32:39+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Requete 4 : (V2)</h1>\n<p>Acteur(s) qui divise(nt) le plus</p>\n<p>métriques retenues :<br/>- stat1 taux du nb positifs (goldenstein event) proche du taux nb de negatifs<br/>- stat2 cumul des valeurs positives proche du cumul des valeurs negatives rapportées au nb d&rsquo;evenements</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1548336619278_-1014961664","id":"20190124-143019_1201916313","dateCreated":"2019-01-24T14:30:19+0100","dateStarted":"2019-01-24T14:32:39+0100","dateFinished":"2019-01-24T14:32:39+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16991"},{"text":"// Lecture Requete 42\n\nval Requete42FromMongo = MongoSpark.\n                        load(sc, ReadConfig(Map(\"uri\" -> MONGO_URI_REQUETE42)) ).\n                        toDF()\n                        \nRequete42FromMongo.createOrReplaceTempView(\"TableRequete42\")\n\n// ici trié par stat1 mais on a encore la possibilité de calculer d'autres stats à partir des cumuls si besoin\n\nz.show(spark.sql(\"\"\"\nselect\n        Actor, cumnbpos, cumnbneg, cumsommepos, cumsommeneg, ttl, stat1, stat2\n        from TableRequete42\n        where ttl > 3000\n        order by stat1\n        limit 10\n\"\"\"))","user":"anonymous","dateUpdated":"2019-01-24T14:34:08+0100","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"1":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Actor":"string","cumnbpos":"string","cumnbneg":"string","cumsommepos":"string","cumsommeneg":"string","ttl":"string","stat1":"string","stat2":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Requete42FromMongo: org.apache.spark.sql.DataFrame = [Actor: string, _id: struct<oid: string> ... 9 more fields]\n"},{"type":"TABLE","data":"Actor\tcumnbpos\tcumnbneg\tcumsommepos\tcumsommeneg\tttl\tstat1\tstat2\nWEBSITE\t2122\t2141\t3655.7930654893353\t7528.837086297667\t4366\t0.004351809436555199\t0.8870920798919679\nBUSINESS\t9202\t9351\t22371.791471401193\t27965.307560849345\t19111\t0.007796556956726493\t0.2926856830855608\nOBAMA\t3557\t3695\t7724.978463315731\t7452.300110323952\t7465\t0.018486269256530477\t0.03652757575241506\nTOURIST\t1662\t1534\t4633.217829535283\t4982.930478589365\t3305\t0.03872919818456883\t0.10581320697551629\nAMBASSADOR\t2261\t2460\t7721.643560586336\t7253.550870318313\t4926\t0.04039788875355258\t0.09502490667235547\nINVESTOR\t2764\t2423\t5628.995505478369\t5505.148217609569\t5343\t0.06382182294591053\t0.023179353896462637\nROME\t1556\t1771\t3640.1788264511883\t6904.99073783406\t3351\t0.06415995225305879\t0.9742798899978728\nROMANIA\t2633\t3028\t8267.534034372955\t7561.004405187178\t5966\t0.06620851491786792\t0.118426018971803\nSINGAPORE\t2516\t2926\t5249.5010715724875\t5316.9725850284485\t5596\t0.07326661901358113\t0.012057096757677096\nINDUSTRY\t3993\t3414\t10202.850492092924\t7534.474734410533\t7788\t0.07434514637904469\t0.34262657391915663\n"}]},"apps":[],"jobName":"paragraph_1548333379727_-1659780538","id":"20190123-164536_1743008278","dateCreated":"2019-01-24T13:36:19+0100","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16992"},{"text":"%md\n\n## Requete 5\n\n","user":"anonymous","dateUpdated":"2019-01-24T14:34:45+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548336866099_-153615496","id":"20190124-143426_458702026","dateCreated":"2019-01-24T14:34:26+0100","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:16993"},{"text":"// Lecture Requete 5bis \n\n// visu moche si on n'a pas plus d'un mois !!\n// à cette etape on n'a plus les info à la journée donc impossible de changer d'echelle\n\nval Requete5bisFromMongo = MongoSpark.\n                        load(sc, ReadConfig(Map(\"uri\" -> MONGO_URI_REQUETE5BIS)) ).\n                        toDF()\n                        \nRequete5bisFromMongo.createOrReplaceTempView(\"TableRequete5bis\")\n\nval dd_camCountry1 = z.select(\"Country 1\", \"USA\", listcodes(\"cameoCountries\"))\nval dd_camCountry2 = z.select(\"Country 2\", \"KOR\", listcodes(\"cameoCountries\"))\n\n\nz.show(spark.sql(\"\"\"\nselect\n        ActorCode1, ActorCode2, Mois, avg, nbpos, nbneg, nbttl, sommeneg, sommepos, delta\n        from TableRequete5bis\n        where 1=1\n        and ActorCode1 = '\"\"\" + dd_camCountry1  +\"\"\"'  \n        and ActorCode2 = '\"\"\" + dd_camCountry2  +\"\"\"'  \n        and Mois > '201800'\n        order by Mois desc\n        limit 12\n\"\"\"))\n\n// voir le settings pour la forme d'affichage\n// zeppelin refait un group by/sum alors qu'un a qu'une ligne !\n\n\n","user":"anonymous","dateUpdated":"2019-01-24T14:39:19+0100","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"runOnSelectionChange":true,"results":{"1":{"graph":{"mode":"lineChart","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"ActorCode1":"string","ActorCode2":"string","Mois":"string","avg":"string","nbpos":"string","nbneg":"string","nbttl":"string","sommeneg":"string","sommepos":"string","delta":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"lineChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default","isDateFormat":false,"dateFormat":"YYYYMM"}},"commonSetting":{},"keys":[{"name":"Mois","index":2,"aggr":"sum"}],"groups":[],"values":[{"name":"avg","index":3,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{"Country 1":"USA","Country 2":"KOR"},"forms":{"Country 1":{"type":"Select","options":[{"value":"WSB","displayName":"West Bank","$$hashKey":"object:26280"},{"value":"BAG","displayName":"Baghdad","$$hashKey":"object:26281"},{"value":"GZS","displayName":"Gaza Strip","$$hashKey":"object:26282"},{"value":"AFR","displayName":"Africa","$$hashKey":"object:26283"},{"value":"ASA","displayName":"Asia","$$hashKey":"object:26284"},{"value":"BLK","displayName":"Balkans","$$hashKey":"object:26285"},{"value":"CRB","displayName":"Caribbean","$$hashKey":"object:26286"},{"value":"CAU","displayName":"Caucasus","$$hashKey":"object:26287"},{"value":"CFR","displayName":"Central Africa","$$hashKey":"object:26288"},{"value":"CAS","displayName":"Central Asia","$$hashKey":"object:26289"},{"value":"CEU","displayName":"Central Europe","$$hashKey":"object:26290"},{"value":"EIN","displayName":"East Indies","$$hashKey":"object:26291"},{"value":"EAF","displayName":"Eastern Africa","$$hashKey":"object:26292"},{"value":"EEU","displayName":"Eastern Europe","$$hashKey":"object:26293"},{"value":"EUR","displayName":"Europe","$$hashKey":"object:26294"},{"value":"LAM","displayName":"Latin America","$$hashKey":"object:26295"},{"value":"MEA","displayName":"Middle East","$$hashKey":"object:26296"},{"value":"MDT","displayName":"Mediterranean","$$hashKey":"object:26297"},{"value":"NAF","displayName":"North Africa","$$hashKey":"object:26298"},{"value":"NMR","displayName":"North America","$$hashKey":"object:26299"},{"value":"PGS","displayName":"Persian Gulf","$$hashKey":"object:26300"},{"value":"SCN","displayName":"Scandinavia","$$hashKey":"object:26301"},{"value":"SAM","displayName":"South America","$$hashKey":"object:26302"},{"value":"SAS","displayName":"South Asia","$$hashKey":"object:26303"},{"value":"SEA","displayName":"Southeast Asia","$$hashKey":"object:26304"},{"value":"SAF","displayName":"Southern Africa","$$hashKey":"object:26305"},{"value":"WAF","displayName":"West Africa","$$hashKey":"object:26306"},{"value":"WST","displayName":"The West","$$hashKey":"object:26307"},{"value":"AFG","displayName":"Afghanistan","$$hashKey":"object:26308"},{"value":"ALA","displayName":"Aland Islands","$$hashKey":"object:26309"},{"value":"ALB","displayName":"Albania","$$hashKey":"object:26310"},{"value":"DZA","displayName":"Algeria","$$hashKey":"object:26311"},{"value":"ASM","displayName":"American Samoa","$$hashKey":"object:26312"},{"value":"AND","displayName":"Andorra","$$hashKey":"object:26313"},{"value":"AGO","displayName":"Angola","$$hashKey":"object:26314"},{"value":"AIA","displayName":"Anguilla","$$hashKey":"object:26315"},{"value":"ATG","displayName":"Antigua and Barbuda","$$hashKey":"object:26316"},{"value":"ARG","displayName":"Argentina","$$hashKey":"object:26317"},{"value":"ARM","displayName":"Armenia","$$hashKey":"object:26318"},{"value":"ABW","displayName":"Aruba","$$hashKey":"object:26319"},{"value":"AUS","displayName":"Australia","$$hashKey":"object:26320"},{"value":"AUT","displayName":"Austria","$$hashKey":"object:26321"},{"value":"AZE","displayName":"Azerbaijan","$$hashKey":"object:26322"},{"value":"BHS","displayName":"Bahamas","$$hashKey":"object:26323"},{"value":"BHR","displayName":"Bahrain","$$hashKey":"object:26324"},{"value":"BGD","displayName":"Bangladesh","$$hashKey":"object:26325"},{"value":"BRB","displayName":"Barbados","$$hashKey":"object:26326"},{"value":"BLR","displayName":"Belarus","$$hashKey":"object:26327"},{"value":"BEL","displayName":"Belgium","$$hashKey":"object:26328"},{"value":"BLZ","displayName":"Belize","$$hashKey":"object:26329"},{"value":"BEN","displayName":"Benin","$$hashKey":"object:26330"},{"value":"BMU","displayName":"Bermuda","$$hashKey":"object:26331"},{"value":"BTN","displayName":"Bhutan","$$hashKey":"object:26332"},{"value":"BOL","displayName":"Bolivia","$$hashKey":"object:26333"},{"value":"BIH","displayName":"Bosnia and Herzegovina","$$hashKey":"object:26334"},{"value":"BWA","displayName":"Botswana","$$hashKey":"object:26335"},{"value":"BRA","displayName":"Brazil","$$hashKey":"object:26336"},{"value":"VGB","displayName":"British Virgin Islands","$$hashKey":"object:26337"},{"value":"BRN","displayName":"Brunei Darussalam","$$hashKey":"object:26338"},{"value":"BGR","displayName":"Bulgaria","$$hashKey":"object:26339"},{"value":"BFA","displayName":"Burkina Faso","$$hashKey":"object:26340"},{"value":"BDI","displayName":"Burundi","$$hashKey":"object:26341"},{"value":"KHM","displayName":"Cambodia","$$hashKey":"object:26342"},{"value":"CMR","displayName":"Cameroon","$$hashKey":"object:26343"},{"value":"CAN","displayName":"Canada","$$hashKey":"object:26344"},{"value":"CPV","displayName":"Cape Verde","$$hashKey":"object:26345"},{"value":"CYM","displayName":"Cayman Islands","$$hashKey":"object:26346"},{"value":"CAF","displayName":"Central African Republic","$$hashKey":"object:26347"},{"value":"TCD","displayName":"Chad","$$hashKey":"object:26348"},{"value":"CHL","displayName":"Chile","$$hashKey":"object:26349"},{"value":"CHN","displayName":"China","$$hashKey":"object:26350"},{"value":"COL","displayName":"Columbia","$$hashKey":"object:26351"},{"value":"COM","displayName":"Comoros","$$hashKey":"object:26352"},{"value":"COD","displayName":"Democratic Republic of the Congo","$$hashKey":"object:26353"},{"value":"COG","displayName":"People's Republic of the Congo","$$hashKey":"object:26354"},{"value":"COK","displayName":"Cook Islands","$$hashKey":"object:26355"},{"value":"CRI","displayName":"Costa Rica","$$hashKey":"object:26356"},{"value":"CIV","displayName":"Ivory Coast","$$hashKey":"object:26357"},{"value":"HRV","displayName":"Croatia","$$hashKey":"object:26358"},{"value":"CUB","displayName":"Cuba","$$hashKey":"object:26359"},{"value":"CYP","displayName":"Cyprus","$$hashKey":"object:26360"},{"value":"CZE","displayName":"Czech Republic","$$hashKey":"object:26361"},{"value":"DNK","displayName":"Denmark","$$hashKey":"object:26362"},{"value":"DJI","displayName":"Djibouti","$$hashKey":"object:26363"},{"value":"DMA","displayName":"Dominica","$$hashKey":"object:26364"},{"value":"DOM","displayName":"Dominican Republic","$$hashKey":"object:26365"},{"value":"TMP","displayName":"East Timor","$$hashKey":"object:26366"},{"value":"ECU","displayName":"Ecuador","$$hashKey":"object:26367"},{"value":"EGY","displayName":"Egypt","$$hashKey":"object:26368"},{"value":"SLV","displayName":"El Salvador","$$hashKey":"object:26369"},{"value":"GNQ","displayName":"Equatorial Guinea","$$hashKey":"object:26370"},{"value":"ERI","displayName":"Eritrea","$$hashKey":"object:26371"},{"value":"EST","displayName":"Estonia","$$hashKey":"object:26372"},{"value":"ETH","displayName":"Ethiopia","$$hashKey":"object:26373"},{"value":"FRO","displayName":"Faeroe Islands","$$hashKey":"object:26374"},{"value":"FLK","displayName":"Falkland Islands","$$hashKey":"object:26375"},{"value":"FJI","displayName":"Fiji","$$hashKey":"object:26376"},{"value":"FIN","displayName":"Finland","$$hashKey":"object:26377"},{"value":"FRA","displayName":"France","$$hashKey":"object:26378"},{"value":"GUF","displayName":"French Guiana","$$hashKey":"object:26379"},{"value":"PYF","displayName":"French Polynesia","$$hashKey":"object:26380"},{"value":"GAB","displayName":"Gabon","$$hashKey":"object:26381"},{"value":"GMB","displayName":"Gambia","$$hashKey":"object:26382"},{"value":"GEO","displayName":"Georgia","$$hashKey":"object:26383"},{"value":"DEU","displayName":"Germany","$$hashKey":"object:26384"},{"value":"GHA","displayName":"Ghana","$$hashKey":"object:26385"},{"value":"GIB","displayName":"Gibraltar","$$hashKey":"object:26386"},{"value":"GRC","displayName":"Greece","$$hashKey":"object:26387"},{"value":"GRL","displayName":"Greenland","$$hashKey":"object:26388"},{"value":"GRD","displayName":"Grenada","$$hashKey":"object:26389"},{"value":"GLP","displayName":"Guadeloupe","$$hashKey":"object:26390"},{"value":"GUM","displayName":"Guam","$$hashKey":"object:26391"},{"value":"GTM","displayName":"Guatemala","$$hashKey":"object:26392"},{"value":"GIN","displayName":"Guinea","$$hashKey":"object:26393"},{"value":"GNB","displayName":"Guinea-Bissau","$$hashKey":"object:26394"},{"value":"GUY","displayName":"Guyana","$$hashKey":"object:26395"},{"value":"HTI","displayName":"Haiti","$$hashKey":"object:26396"},{"value":"VAT","displayName":"Vatican City","$$hashKey":"object:26397"},{"value":"HND","displayName":"Honduras","$$hashKey":"object:26398"},{"value":"HKG","displayName":"Hong Kong","$$hashKey":"object:26399"},{"value":"HUN","displayName":"Hungary","$$hashKey":"object:26400"},{"value":"ISL","displayName":"Iceland","$$hashKey":"object:26401"},{"value":"IND","displayName":"India","$$hashKey":"object:26402"},{"value":"IDN","displayName":"Indonesia","$$hashKey":"object:26403"},{"value":"IRN","displayName":"Iran","$$hashKey":"object:26404"},{"value":"IRQ","displayName":"Iraq","$$hashKey":"object:26405"},{"value":"IRL","displayName":"Ireland","$$hashKey":"object:26406"},{"value":"IMY","displayName":"Isle of Man","$$hashKey":"object:26407"},{"value":"ISR","displayName":"Israel","$$hashKey":"object:26408"},{"value":"ITA","displayName":"Italy","$$hashKey":"object:26409"},{"value":"JAM","displayName":"Jamaica","$$hashKey":"object:26410"},{"value":"JPN","displayName":"Japan","$$hashKey":"object:26411"},{"value":"JOR","displayName":"Jordan","$$hashKey":"object:26412"},{"value":"KAZ","displayName":"Kazakhstan","$$hashKey":"object:26413"},{"value":"KEN","displayName":"Kenya","$$hashKey":"object:26414"},{"value":"KIR","displayName":"Kiribati","$$hashKey":"object:26415"},{"value":"PRK","displayName":"North Korea","$$hashKey":"object:26416"},{"value":"KOR","displayName":"South Korea","$$hashKey":"object:26417"},{"value":"KWT","displayName":"Kuwait","$$hashKey":"object:26418"},{"value":"KGZ","displayName":"Kyrgyzstan","$$hashKey":"object:26419"},{"value":"LAO","displayName":"Laos","$$hashKey":"object:26420"},{"value":"LVA","displayName":"Latvia","$$hashKey":"object:26421"},{"value":"LBN","displayName":"Lebanon","$$hashKey":"object:26422"},{"value":"LSO","displayName":"Lesotho","$$hashKey":"object:26423"},{"value":"LBR","displayName":"Liberia","$$hashKey":"object:26424"},{"value":"LBY","displayName":"Libya","$$hashKey":"object:26425"},{"value":"LIE","displayName":"Liechtenstein","$$hashKey":"object:26426"},{"value":"LTU","displayName":"Lithuania","$$hashKey":"object:26427"},{"value":"LUX","displayName":"Luxembourg","$$hashKey":"object:26428"},{"value":"MAC","displayName":"Macao","$$hashKey":"object:26429"},{"value":"MKD","displayName":"Macedonia","$$hashKey":"object:26430"},{"value":"MDG","displayName":"Madagascar","$$hashKey":"object:26431"},{"value":"MWI","displayName":"Malawi","$$hashKey":"object:26432"},{"value":"MYS","displayName":"Malaysia","$$hashKey":"object:26433"},{"value":"MDV","displayName":"Maldives","$$hashKey":"object:26434"},{"value":"MLI","displayName":"Mali","$$hashKey":"object:26435"},{"value":"MLT","displayName":"Malta","$$hashKey":"object:26436"},{"value":"MHL","displayName":"Marshall Islands","$$hashKey":"object:26437"},{"value":"MTQ","displayName":"Martinique","$$hashKey":"object:26438"},{"value":"MRT","displayName":"Mauritania","$$hashKey":"object:26439"},{"value":"MUS","displayName":"Mauritius","$$hashKey":"object:26440"},{"value":"MYT","displayName":"Mayotte","$$hashKey":"object:26441"},{"value":"MEX","displayName":"Mexico","$$hashKey":"object:26442"},{"value":"FSM","displayName":"Micronesia","$$hashKey":"object:26443"},{"value":"MDA","displayName":"Moldova","$$hashKey":"object:26444"},{"value":"MCO","displayName":"Monaco","$$hashKey":"object:26445"},{"value":"MNG","displayName":"Mongolia","$$hashKey":"object:26446"},{"value":"MTN","displayName":"Montenegro","$$hashKey":"object:26447"},{"value":"MSR","displayName":"Montserrat","$$hashKey":"object:26448"},{"value":"MAR","displayName":"Morocco","$$hashKey":"object:26449"},{"value":"MOZ","displayName":"Mozambique","$$hashKey":"object:26450"},{"value":"MMR","displayName":"Myanmar","$$hashKey":"object:26451"},{"value":"NAM","displayName":"Namibia","$$hashKey":"object:26452"},{"value":"NRU","displayName":"Nauru","$$hashKey":"object:26453"},{"value":"NPL","displayName":"Nepal","$$hashKey":"object:26454"},{"value":"NLD","displayName":"Netherlands","$$hashKey":"object:26455"},{"value":"ANT","displayName":"Netherlands Antilles","$$hashKey":"object:26456"},{"value":"NCL","displayName":"New Caledonia","$$hashKey":"object:26457"},{"value":"NZL","displayName":"New Zealand","$$hashKey":"object:26458"},{"value":"NIC","displayName":"Nicaragua","$$hashKey":"object:26459"},{"value":"NER","displayName":"Niger","$$hashKey":"object:26460"},{"value":"NGA","displayName":"Nigeria","$$hashKey":"object:26461"},{"value":"NIU","displayName":"Niue","$$hashKey":"object:26462"},{"value":"NFK","displayName":"Norfolk Island","$$hashKey":"object:26463"},{"value":"MNP","displayName":"Northern Mariana Islands","$$hashKey":"object:26464"},{"value":"NOR","displayName":"Norway","$$hashKey":"object:26465"},{"value":"PSE","displayName":"Occupied Palestinian Territory","$$hashKey":"object:26466"},{"value":"OMN","displayName":"Oman","$$hashKey":"object:26467"},{"value":"PAK","displayName":"Pakistan","$$hashKey":"object:26468"},{"value":"PLW","displayName":"Palau","$$hashKey":"object:26469"},{"value":"PAN","displayName":"Panama","$$hashKey":"object:26470"},{"value":"PNG","displayName":"Papua New Guinea","$$hashKey":"object:26471"},{"value":"PRY","displayName":"Paraguay","$$hashKey":"object:26472"},{"value":"PER","displayName":"Peru","$$hashKey":"object:26473"},{"value":"PHL","displayName":"Philippines","$$hashKey":"object:26474"},{"value":"PCN","displayName":"Pitcairn","$$hashKey":"object:26475"},{"value":"POL","displayName":"Poland","$$hashKey":"object:26476"},{"value":"PRT","displayName":"Portugal","$$hashKey":"object:26477"},{"value":"PRI","displayName":"Puerto Rico","$$hashKey":"object:26478"},{"value":"QAT","displayName":"Qatar","$$hashKey":"object:26479"},{"value":"REU","displayName":"Runion","$$hashKey":"object:26480"},{"value":"ROM","displayName":"Romania","$$hashKey":"object:26481"},{"value":"RUS","displayName":"Russia","$$hashKey":"object:26482"},{"value":"RWA","displayName":"Rwanda","$$hashKey":"object:26483"},{"value":"SHN","displayName":"Saint Helena","$$hashKey":"object:26484"},{"value":"KNA","displayName":"Saint Kitts-Nevis","$$hashKey":"object:26485"},{"value":"LCA","displayName":"Saint Lucia","$$hashKey":"object:26486"},{"value":"SPM","displayName":"Saint Pierre and Miquelon","$$hashKey":"object:26487"},{"value":"VCT","displayName":"Saint Vincent and the Grenadines","$$hashKey":"object:26488"},{"value":"WSM","displayName":"Samoa","$$hashKey":"object:26489"},{"value":"SMR","displayName":"San Marino","$$hashKey":"object:26490"},{"value":"STP","displayName":"Sao Tome and Principe","$$hashKey":"object:26491"},{"value":"SAU","displayName":"Saudi Arabia","$$hashKey":"object:26492"},{"value":"SEN","displayName":"Senegal","$$hashKey":"object:26493"},{"value":"SRB","displayName":"Serbia","$$hashKey":"object:26494"},{"value":"SYC","displayName":"Seychelles","$$hashKey":"object:26495"},{"value":"SLE","displayName":"Sierra Leone","$$hashKey":"object:26496"},{"value":"SGP","displayName":"Singapore","$$hashKey":"object:26497"},{"value":"SVK","displayName":"Slovakia","$$hashKey":"object:26498"},{"value":"SVN","displayName":"Slovenia","$$hashKey":"object:26499"},{"value":"SLB","displayName":"Solomon Islands","$$hashKey":"object:26500"},{"value":"SOM","displayName":"Somalia","$$hashKey":"object:26501"},{"value":"ZAF","displayName":"South Africa","$$hashKey":"object:26502"},{"value":"ESP","displayName":"Spain","$$hashKey":"object:26503"},{"value":"LKA","displayName":"Sri Lanka","$$hashKey":"object:26504"},{"value":"SDN","displayName":"Sudan","$$hashKey":"object:26505"},{"value":"SUR","displayName":"Suriname","$$hashKey":"object:26506"},{"value":"SJM","displayName":"Svalbard and Jan Mayen Islands","$$hashKey":"object:26507"},{"value":"SWZ","displayName":"Swaziland","$$hashKey":"object:26508"},{"value":"SWE","displayName":"Sweden","$$hashKey":"object:26509"},{"value":"CHE","displayName":"Switzerland","$$hashKey":"object:26510"},{"value":"SYR","displayName":"Syria","$$hashKey":"object:26511"},{"value":"TWN","displayName":"Taiwan","$$hashKey":"object:26512"},{"value":"TJK","displayName":"Tajikistan","$$hashKey":"object:26513"},{"value":"TZA","displayName":"Tanzania","$$hashKey":"object:26514"},{"value":"THA","displayName":"Thailand","$$hashKey":"object:26515"},{"value":"TGO","displayName":"Togo","$$hashKey":"object:26516"},{"value":"TKL","displayName":"Tokelau","$$hashKey":"object:26517"},{"value":"TON","displayName":"Tonga","$$hashKey":"object:26518"},{"value":"TTO","displayName":"Trinidad and Tobago","$$hashKey":"object:26519"},{"value":"TUN","displayName":"Tunisia","$$hashKey":"object:26520"},{"value":"TUR","displayName":"Turkey","$$hashKey":"object:26521"},{"value":"TKM","displayName":"Turkmenistan","$$hashKey":"object:26522"},{"value":"TCA","displayName":"Turks and Caicos Islands","$$hashKey":"object:26523"},{"value":"TUV","displayName":"Tuvalu","$$hashKey":"object:26524"},{"value":"UGA","displayName":"Uganda","$$hashKey":"object:26525"},{"value":"UKR","displayName":"Ukraine","$$hashKey":"object:26526"},{"value":"ARE","displayName":"United Arab Emirates","$$hashKey":"object:26527"},{"value":"GBR","displayName":"United Kingdom","$$hashKey":"object:26528"},{"value":"USA","displayName":"United States","$$hashKey":"object:26529"},{"value":"VIR","displayName":"United States Virgin Islands","$$hashKey":"object:26530"},{"value":"URY","displayName":"Uruguay","$$hashKey":"object:26531"},{"value":"UZB","displayName":"Uzbekistan","$$hashKey":"object:26532"},{"value":"VUT","displayName":"Vanuatu","$$hashKey":"object:26533"},{"value":"VEN","displayName":"Venezuela","$$hashKey":"object:26534"},{"value":"VNM","displayName":"Vietnam","$$hashKey":"object:26535"},{"value":"WLF","displayName":"Wallis and Futuna Islands","$$hashKey":"object:26536"},{"value":"ESH","displayName":"Western Sahara","$$hashKey":"object:26537"},{"value":"YEM","displayName":"Yemen","$$hashKey":"object:26538"},{"value":"ZMB","displayName":"Zambia","$$hashKey":"object:26539"},{"value":"ZWE","displayName":"Zimbabwe","$$hashKey":"object:26540"}],"name":"Country 1","displayName":"Country 1","defaultValue":"USA","hidden":false,"$$hashKey":"object:26268"},"Country 2":{"type":"Select","options":[{"value":"WSB","displayName":"West Bank","$$hashKey":"object:26547"},{"value":"BAG","displayName":"Baghdad","$$hashKey":"object:26548"},{"value":"GZS","displayName":"Gaza Strip","$$hashKey":"object:26549"},{"value":"AFR","displayName":"Africa","$$hashKey":"object:26550"},{"value":"ASA","displayName":"Asia","$$hashKey":"object:26551"},{"value":"BLK","displayName":"Balkans","$$hashKey":"object:26552"},{"value":"CRB","displayName":"Caribbean","$$hashKey":"object:26553"},{"value":"CAU","displayName":"Caucasus","$$hashKey":"object:26554"},{"value":"CFR","displayName":"Central Africa","$$hashKey":"object:26555"},{"value":"CAS","displayName":"Central Asia","$$hashKey":"object:26556"},{"value":"CEU","displayName":"Central Europe","$$hashKey":"object:26557"},{"value":"EIN","displayName":"East Indies","$$hashKey":"object:26558"},{"value":"EAF","displayName":"Eastern Africa","$$hashKey":"object:26559"},{"value":"EEU","displayName":"Eastern Europe","$$hashKey":"object:26560"},{"value":"EUR","displayName":"Europe","$$hashKey":"object:26561"},{"value":"LAM","displayName":"Latin America","$$hashKey":"object:26562"},{"value":"MEA","displayName":"Middle East","$$hashKey":"object:26563"},{"value":"MDT","displayName":"Mediterranean","$$hashKey":"object:26564"},{"value":"NAF","displayName":"North Africa","$$hashKey":"object:26565"},{"value":"NMR","displayName":"North America","$$hashKey":"object:26566"},{"value":"PGS","displayName":"Persian Gulf","$$hashKey":"object:26567"},{"value":"SCN","displayName":"Scandinavia","$$hashKey":"object:26568"},{"value":"SAM","displayName":"South America","$$hashKey":"object:26569"},{"value":"SAS","displayName":"South Asia","$$hashKey":"object:26570"},{"value":"SEA","displayName":"Southeast Asia","$$hashKey":"object:26571"},{"value":"SAF","displayName":"Southern Africa","$$hashKey":"object:26572"},{"value":"WAF","displayName":"West Africa","$$hashKey":"object:26573"},{"value":"WST","displayName":"The West","$$hashKey":"object:26574"},{"value":"AFG","displayName":"Afghanistan","$$hashKey":"object:26575"},{"value":"ALA","displayName":"Aland Islands","$$hashKey":"object:26576"},{"value":"ALB","displayName":"Albania","$$hashKey":"object:26577"},{"value":"DZA","displayName":"Algeria","$$hashKey":"object:26578"},{"value":"ASM","displayName":"American Samoa","$$hashKey":"object:26579"},{"value":"AND","displayName":"Andorra","$$hashKey":"object:26580"},{"value":"AGO","displayName":"Angola","$$hashKey":"object:26581"},{"value":"AIA","displayName":"Anguilla","$$hashKey":"object:26582"},{"value":"ATG","displayName":"Antigua and Barbuda","$$hashKey":"object:26583"},{"value":"ARG","displayName":"Argentina","$$hashKey":"object:26584"},{"value":"ARM","displayName":"Armenia","$$hashKey":"object:26585"},{"value":"ABW","displayName":"Aruba","$$hashKey":"object:26586"},{"value":"AUS","displayName":"Australia","$$hashKey":"object:26587"},{"value":"AUT","displayName":"Austria","$$hashKey":"object:26588"},{"value":"AZE","displayName":"Azerbaijan","$$hashKey":"object:26589"},{"value":"BHS","displayName":"Bahamas","$$hashKey":"object:26590"},{"value":"BHR","displayName":"Bahrain","$$hashKey":"object:26591"},{"value":"BGD","displayName":"Bangladesh","$$hashKey":"object:26592"},{"value":"BRB","displayName":"Barbados","$$hashKey":"object:26593"},{"value":"BLR","displayName":"Belarus","$$hashKey":"object:26594"},{"value":"BEL","displayName":"Belgium","$$hashKey":"object:26595"},{"value":"BLZ","displayName":"Belize","$$hashKey":"object:26596"},{"value":"BEN","displayName":"Benin","$$hashKey":"object:26597"},{"value":"BMU","displayName":"Bermuda","$$hashKey":"object:26598"},{"value":"BTN","displayName":"Bhutan","$$hashKey":"object:26599"},{"value":"BOL","displayName":"Bolivia","$$hashKey":"object:26600"},{"value":"BIH","displayName":"Bosnia and Herzegovina","$$hashKey":"object:26601"},{"value":"BWA","displayName":"Botswana","$$hashKey":"object:26602"},{"value":"BRA","displayName":"Brazil","$$hashKey":"object:26603"},{"value":"VGB","displayName":"British Virgin Islands","$$hashKey":"object:26604"},{"value":"BRN","displayName":"Brunei Darussalam","$$hashKey":"object:26605"},{"value":"BGR","displayName":"Bulgaria","$$hashKey":"object:26606"},{"value":"BFA","displayName":"Burkina Faso","$$hashKey":"object:26607"},{"value":"BDI","displayName":"Burundi","$$hashKey":"object:26608"},{"value":"KHM","displayName":"Cambodia","$$hashKey":"object:26609"},{"value":"CMR","displayName":"Cameroon","$$hashKey":"object:26610"},{"value":"CAN","displayName":"Canada","$$hashKey":"object:26611"},{"value":"CPV","displayName":"Cape Verde","$$hashKey":"object:26612"},{"value":"CYM","displayName":"Cayman Islands","$$hashKey":"object:26613"},{"value":"CAF","displayName":"Central African Republic","$$hashKey":"object:26614"},{"value":"TCD","displayName":"Chad","$$hashKey":"object:26615"},{"value":"CHL","displayName":"Chile","$$hashKey":"object:26616"},{"value":"CHN","displayName":"China","$$hashKey":"object:26617"},{"value":"COL","displayName":"Columbia","$$hashKey":"object:26618"},{"value":"COM","displayName":"Comoros","$$hashKey":"object:26619"},{"value":"COD","displayName":"Democratic Republic of the Congo","$$hashKey":"object:26620"},{"value":"COG","displayName":"People's Republic of the Congo","$$hashKey":"object:26621"},{"value":"COK","displayName":"Cook Islands","$$hashKey":"object:26622"},{"value":"CRI","displayName":"Costa Rica","$$hashKey":"object:26623"},{"value":"CIV","displayName":"Ivory Coast","$$hashKey":"object:26624"},{"value":"HRV","displayName":"Croatia","$$hashKey":"object:26625"},{"value":"CUB","displayName":"Cuba","$$hashKey":"object:26626"},{"value":"CYP","displayName":"Cyprus","$$hashKey":"object:26627"},{"value":"CZE","displayName":"Czech Republic","$$hashKey":"object:26628"},{"value":"DNK","displayName":"Denmark","$$hashKey":"object:26629"},{"value":"DJI","displayName":"Djibouti","$$hashKey":"object:26630"},{"value":"DMA","displayName":"Dominica","$$hashKey":"object:26631"},{"value":"DOM","displayName":"Dominican Republic","$$hashKey":"object:26632"},{"value":"TMP","displayName":"East Timor","$$hashKey":"object:26633"},{"value":"ECU","displayName":"Ecuador","$$hashKey":"object:26634"},{"value":"EGY","displayName":"Egypt","$$hashKey":"object:26635"},{"value":"SLV","displayName":"El Salvador","$$hashKey":"object:26636"},{"value":"GNQ","displayName":"Equatorial Guinea","$$hashKey":"object:26637"},{"value":"ERI","displayName":"Eritrea","$$hashKey":"object:26638"},{"value":"EST","displayName":"Estonia","$$hashKey":"object:26639"},{"value":"ETH","displayName":"Ethiopia","$$hashKey":"object:26640"},{"value":"FRO","displayName":"Faeroe Islands","$$hashKey":"object:26641"},{"value":"FLK","displayName":"Falkland Islands","$$hashKey":"object:26642"},{"value":"FJI","displayName":"Fiji","$$hashKey":"object:26643"},{"value":"FIN","displayName":"Finland","$$hashKey":"object:26644"},{"value":"FRA","displayName":"France","$$hashKey":"object:26645"},{"value":"GUF","displayName":"French Guiana","$$hashKey":"object:26646"},{"value":"PYF","displayName":"French Polynesia","$$hashKey":"object:26647"},{"value":"GAB","displayName":"Gabon","$$hashKey":"object:26648"},{"value":"GMB","displayName":"Gambia","$$hashKey":"object:26649"},{"value":"GEO","displayName":"Georgia","$$hashKey":"object:26650"},{"value":"DEU","displayName":"Germany","$$hashKey":"object:26651"},{"value":"GHA","displayName":"Ghana","$$hashKey":"object:26652"},{"value":"GIB","displayName":"Gibraltar","$$hashKey":"object:26653"},{"value":"GRC","displayName":"Greece","$$hashKey":"object:26654"},{"value":"GRL","displayName":"Greenland","$$hashKey":"object:26655"},{"value":"GRD","displayName":"Grenada","$$hashKey":"object:26656"},{"value":"GLP","displayName":"Guadeloupe","$$hashKey":"object:26657"},{"value":"GUM","displayName":"Guam","$$hashKey":"object:26658"},{"value":"GTM","displayName":"Guatemala","$$hashKey":"object:26659"},{"value":"GIN","displayName":"Guinea","$$hashKey":"object:26660"},{"value":"GNB","displayName":"Guinea-Bissau","$$hashKey":"object:26661"},{"value":"GUY","displayName":"Guyana","$$hashKey":"object:26662"},{"value":"HTI","displayName":"Haiti","$$hashKey":"object:26663"},{"value":"VAT","displayName":"Vatican City","$$hashKey":"object:26664"},{"value":"HND","displayName":"Honduras","$$hashKey":"object:26665"},{"value":"HKG","displayName":"Hong Kong","$$hashKey":"object:26666"},{"value":"HUN","displayName":"Hungary","$$hashKey":"object:26667"},{"value":"ISL","displayName":"Iceland","$$hashKey":"object:26668"},{"value":"IND","displayName":"India","$$hashKey":"object:26669"},{"value":"IDN","displayName":"Indonesia","$$hashKey":"object:26670"},{"value":"IRN","displayName":"Iran","$$hashKey":"object:26671"},{"value":"IRQ","displayName":"Iraq","$$hashKey":"object:26672"},{"value":"IRL","displayName":"Ireland","$$hashKey":"object:26673"},{"value":"IMY","displayName":"Isle of Man","$$hashKey":"object:26674"},{"value":"ISR","displayName":"Israel","$$hashKey":"object:26675"},{"value":"ITA","displayName":"Italy","$$hashKey":"object:26676"},{"value":"JAM","displayName":"Jamaica","$$hashKey":"object:26677"},{"value":"JPN","displayName":"Japan","$$hashKey":"object:26678"},{"value":"JOR","displayName":"Jordan","$$hashKey":"object:26679"},{"value":"KAZ","displayName":"Kazakhstan","$$hashKey":"object:26680"},{"value":"KEN","displayName":"Kenya","$$hashKey":"object:26681"},{"value":"KIR","displayName":"Kiribati","$$hashKey":"object:26682"},{"value":"PRK","displayName":"North Korea","$$hashKey":"object:26683"},{"value":"KOR","displayName":"South Korea","$$hashKey":"object:26684"},{"value":"KWT","displayName":"Kuwait","$$hashKey":"object:26685"},{"value":"KGZ","displayName":"Kyrgyzstan","$$hashKey":"object:26686"},{"value":"LAO","displayName":"Laos","$$hashKey":"object:26687"},{"value":"LVA","displayName":"Latvia","$$hashKey":"object:26688"},{"value":"LBN","displayName":"Lebanon","$$hashKey":"object:26689"},{"value":"LSO","displayName":"Lesotho","$$hashKey":"object:26690"},{"value":"LBR","displayName":"Liberia","$$hashKey":"object:26691"},{"value":"LBY","displayName":"Libya","$$hashKey":"object:26692"},{"value":"LIE","displayName":"Liechtenstein","$$hashKey":"object:26693"},{"value":"LTU","displayName":"Lithuania","$$hashKey":"object:26694"},{"value":"LUX","displayName":"Luxembourg","$$hashKey":"object:26695"},{"value":"MAC","displayName":"Macao","$$hashKey":"object:26696"},{"value":"MKD","displayName":"Macedonia","$$hashKey":"object:26697"},{"value":"MDG","displayName":"Madagascar","$$hashKey":"object:26698"},{"value":"MWI","displayName":"Malawi","$$hashKey":"object:26699"},{"value":"MYS","displayName":"Malaysia","$$hashKey":"object:26700"},{"value":"MDV","displayName":"Maldives","$$hashKey":"object:26701"},{"value":"MLI","displayName":"Mali","$$hashKey":"object:26702"},{"value":"MLT","displayName":"Malta","$$hashKey":"object:26703"},{"value":"MHL","displayName":"Marshall Islands","$$hashKey":"object:26704"},{"value":"MTQ","displayName":"Martinique","$$hashKey":"object:26705"},{"value":"MRT","displayName":"Mauritania","$$hashKey":"object:26706"},{"value":"MUS","displayName":"Mauritius","$$hashKey":"object:26707"},{"value":"MYT","displayName":"Mayotte","$$hashKey":"object:26708"},{"value":"MEX","displayName":"Mexico","$$hashKey":"object:26709"},{"value":"FSM","displayName":"Micronesia","$$hashKey":"object:26710"},{"value":"MDA","displayName":"Moldova","$$hashKey":"object:26711"},{"value":"MCO","displayName":"Monaco","$$hashKey":"object:26712"},{"value":"MNG","displayName":"Mongolia","$$hashKey":"object:26713"},{"value":"MTN","displayName":"Montenegro","$$hashKey":"object:26714"},{"value":"MSR","displayName":"Montserrat","$$hashKey":"object:26715"},{"value":"MAR","displayName":"Morocco","$$hashKey":"object:26716"},{"value":"MOZ","displayName":"Mozambique","$$hashKey":"object:26717"},{"value":"MMR","displayName":"Myanmar","$$hashKey":"object:26718"},{"value":"NAM","displayName":"Namibia","$$hashKey":"object:26719"},{"value":"NRU","displayName":"Nauru","$$hashKey":"object:26720"},{"value":"NPL","displayName":"Nepal","$$hashKey":"object:26721"},{"value":"NLD","displayName":"Netherlands","$$hashKey":"object:26722"},{"value":"ANT","displayName":"Netherlands Antilles","$$hashKey":"object:26723"},{"value":"NCL","displayName":"New Caledonia","$$hashKey":"object:26724"},{"value":"NZL","displayName":"New Zealand","$$hashKey":"object:26725"},{"value":"NIC","displayName":"Nicaragua","$$hashKey":"object:26726"},{"value":"NER","displayName":"Niger","$$hashKey":"object:26727"},{"value":"NGA","displayName":"Nigeria","$$hashKey":"object:26728"},{"value":"NIU","displayName":"Niue","$$hashKey":"object:26729"},{"value":"NFK","displayName":"Norfolk Island","$$hashKey":"object:26730"},{"value":"MNP","displayName":"Northern Mariana Islands","$$hashKey":"object:26731"},{"value":"NOR","displayName":"Norway","$$hashKey":"object:26732"},{"value":"PSE","displayName":"Occupied Palestinian Territory","$$hashKey":"object:26733"},{"value":"OMN","displayName":"Oman","$$hashKey":"object:26734"},{"value":"PAK","displayName":"Pakistan","$$hashKey":"object:26735"},{"value":"PLW","displayName":"Palau","$$hashKey":"object:26736"},{"value":"PAN","displayName":"Panama","$$hashKey":"object:26737"},{"value":"PNG","displayName":"Papua New Guinea","$$hashKey":"object:26738"},{"value":"PRY","displayName":"Paraguay","$$hashKey":"object:26739"},{"value":"PER","displayName":"Peru","$$hashKey":"object:26740"},{"value":"PHL","displayName":"Philippines","$$hashKey":"object:26741"},{"value":"PCN","displayName":"Pitcairn","$$hashKey":"object:26742"},{"value":"POL","displayName":"Poland","$$hashKey":"object:26743"},{"value":"PRT","displayName":"Portugal","$$hashKey":"object:26744"},{"value":"PRI","displayName":"Puerto Rico","$$hashKey":"object:26745"},{"value":"QAT","displayName":"Qatar","$$hashKey":"object:26746"},{"value":"REU","displayName":"Runion","$$hashKey":"object:26747"},{"value":"ROM","displayName":"Romania","$$hashKey":"object:26748"},{"value":"RUS","displayName":"Russia","$$hashKey":"object:26749"},{"value":"RWA","displayName":"Rwanda","$$hashKey":"object:26750"},{"value":"SHN","displayName":"Saint Helena","$$hashKey":"object:26751"},{"value":"KNA","displayName":"Saint Kitts-Nevis","$$hashKey":"object:26752"},{"value":"LCA","displayName":"Saint Lucia","$$hashKey":"object:26753"},{"value":"SPM","displayName":"Saint Pierre and Miquelon","$$hashKey":"object:26754"},{"value":"VCT","displayName":"Saint Vincent and the Grenadines","$$hashKey":"object:26755"},{"value":"WSM","displayName":"Samoa","$$hashKey":"object:26756"},{"value":"SMR","displayName":"San Marino","$$hashKey":"object:26757"},{"value":"STP","displayName":"Sao Tome and Principe","$$hashKey":"object:26758"},{"value":"SAU","displayName":"Saudi Arabia","$$hashKey":"object:26759"},{"value":"SEN","displayName":"Senegal","$$hashKey":"object:26760"},{"value":"SRB","displayName":"Serbia","$$hashKey":"object:26761"},{"value":"SYC","displayName":"Seychelles","$$hashKey":"object:26762"},{"value":"SLE","displayName":"Sierra Leone","$$hashKey":"object:26763"},{"value":"SGP","displayName":"Singapore","$$hashKey":"object:26764"},{"value":"SVK","displayName":"Slovakia","$$hashKey":"object:26765"},{"value":"SVN","displayName":"Slovenia","$$hashKey":"object:26766"},{"value":"SLB","displayName":"Solomon Islands","$$hashKey":"object:26767"},{"value":"SOM","displayName":"Somalia","$$hashKey":"object:26768"},{"value":"ZAF","displayName":"South Africa","$$hashKey":"object:26769"},{"value":"ESP","displayName":"Spain","$$hashKey":"object:26770"},{"value":"LKA","displayName":"Sri Lanka","$$hashKey":"object:26771"},{"value":"SDN","displayName":"Sudan","$$hashKey":"object:26772"},{"value":"SUR","displayName":"Suriname","$$hashKey":"object:26773"},{"value":"SJM","displayName":"Svalbard and Jan Mayen Islands","$$hashKey":"object:26774"},{"value":"SWZ","displayName":"Swaziland","$$hashKey":"object:26775"},{"value":"SWE","displayName":"Sweden","$$hashKey":"object:26776"},{"value":"CHE","displayName":"Switzerland","$$hashKey":"object:26777"},{"value":"SYR","displayName":"Syria","$$hashKey":"object:26778"},{"value":"TWN","displayName":"Taiwan","$$hashKey":"object:26779"},{"value":"TJK","displayName":"Tajikistan","$$hashKey":"object:26780"},{"value":"TZA","displayName":"Tanzania","$$hashKey":"object:26781"},{"value":"THA","displayName":"Thailand","$$hashKey":"object:26782"},{"value":"TGO","displayName":"Togo","$$hashKey":"object:26783"},{"value":"TKL","displayName":"Tokelau","$$hashKey":"object:26784"},{"value":"TON","displayName":"Tonga","$$hashKey":"object:26785"},{"value":"TTO","displayName":"Trinidad and Tobago","$$hashKey":"object:26786"},{"value":"TUN","displayName":"Tunisia","$$hashKey":"object:26787"},{"value":"TUR","displayName":"Turkey","$$hashKey":"object:26788"},{"value":"TKM","displayName":"Turkmenistan","$$hashKey":"object:26789"},{"value":"TCA","displayName":"Turks and Caicos Islands","$$hashKey":"object:26790"},{"value":"TUV","displayName":"Tuvalu","$$hashKey":"object:26791"},{"value":"UGA","displayName":"Uganda","$$hashKey":"object:26792"},{"value":"UKR","displayName":"Ukraine","$$hashKey":"object:26793"},{"value":"ARE","displayName":"United Arab Emirates","$$hashKey":"object:26794"},{"value":"GBR","displayName":"United Kingdom","$$hashKey":"object:26795"},{"value":"USA","displayName":"United States","$$hashKey":"object:26796"},{"value":"VIR","displayName":"United States Virgin Islands","$$hashKey":"object:26797"},{"value":"URY","displayName":"Uruguay","$$hashKey":"object:26798"},{"value":"UZB","displayName":"Uzbekistan","$$hashKey":"object:26799"},{"value":"VUT","displayName":"Vanuatu","$$hashKey":"object:26800"},{"value":"VEN","displayName":"Venezuela","$$hashKey":"object:26801"},{"value":"VNM","displayName":"Vietnam","$$hashKey":"object:26802"},{"value":"WLF","displayName":"Wallis and Futuna Islands","$$hashKey":"object:26803"},{"value":"ESH","displayName":"Western Sahara","$$hashKey":"object:26804"},{"value":"YEM","displayName":"Yemen","$$hashKey":"object:26805"},{"value":"ZMB","displayName":"Zambia","$$hashKey":"object:26806"},{"value":"ZWE","displayName":"Zimbabwe","$$hashKey":"object:26807"}],"name":"Country 2","displayName":"Country 2","defaultValue":"KOR","hidden":false,"$$hashKey":"object:26269"}}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Requete5bisFromMongo: org.apache.spark.sql.DataFrame = [ActorCode1: string, ActorCode2: string ... 9 more fields]\ndd_camCountry1: Object = USA\ndd_camCountry2: Object = KOR\n"},{"type":"TABLE","data":"ActorCode1\tActorCode2\tMois\tavg\tnbpos\tnbneg\tnbttl\tsommeneg\tsommepos\tdelta\nUSA\tKOR\t201812\t2.230461367426348\t1404\t315\t1799\t1385.3\t5397.900000000001\t4012.6000000000004\nUSA\tKOR\t201811\t1.96173285198556\t207\t45\t277\t197.1\t740.5000000000001\t543.4000000000001\nUSA\tKOR\t201810\t3.3333333333333335\t11\t1\t12\t10.0\t50.0\t40.0\n"}]},"apps":[],"jobName":"paragraph_1548333379728_1666482444","id":"20190123-204203_740249289","dateCreated":"2019-01-24T13:36:19+0100","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16994"},{"text":"// DEBUG affichage des codes pays : le code fips est sur 2 caractère ca ne va pas aller pour les libs de visu sur une carte !!\n\nval dfTestFIPS =  spark.sql(\"\"\"\nselect * from fipsCountries\n\"\"\").toDF()\n\ndfTestFIPS.show(5)","user":"anonymous","dateUpdated":"2019-01-24T14:38:49+0100","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"dfTestFIPS: org.apache.spark.sql.DataFrame = [code: string, desc: string]\n"}]},"apps":[],"jobName":"paragraph_1548333379729_1396652929","id":"20190121-123514_141465873","dateCreated":"2019-01-24T13:36:19+0100","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16995"},{"user":"anonymous","dateUpdated":"2019-01-24T13:36:19+0100","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1548333379729_-1566486342","id":"20190121-124600_330712567","dateCreated":"2019-01-24T13:36:19+0100","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16996"}],"name":"Gdelt-AWS-VizuZep","id":"2E33D759J","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}