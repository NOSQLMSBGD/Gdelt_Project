{"paragraphs":[{"text":"import sys.process._\nimport java.net.URL\nimport java.io.File\nimport java.io.File\nimport java.nio.file.{Files, StandardCopyOption}\nimport java.net.HttpURLConnection \nimport org.apache.spark.sql.functions._\n\n\ndef fileDownloader(urlOfFileToDownload: String, fileName: String) = {\n    val url = new URL(urlOfFileToDownload)\n    val connection = url.openConnection().asInstanceOf[HttpURLConnection]\n    connection.setConnectTimeout(5000)\n    connection.setReadTimeout(5000)\n    connection.connect()\n\n    if (connection.getResponseCode >= 400)\n        println(\"error\")\n    else\n        url #> new File(fileName) !!\n}","user":"anonymous","dateUpdated":"2019-01-18T15:42:26+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import sys.process._\nimport java.net.URL\nimport java.io.File\nimport java.io.File\nimport java.nio.file.{Files, StandardCopyOption}\nimport java.net.HttpURLConnection\nimport org.apache.spark.sql.functions._\nwarning: there was one feature warning; re-run with -feature for details\nfileDownloader: (urlOfFileToDownload: String, fileName: String)Any\n"}]},"apps":[],"jobName":"paragraph_1547822240022_573459580","id":"20181209-161931_737140067","dateCreated":"2019-01-18T14:37:20+0000","dateStarted":"2019-01-18T15:42:26+0000","dateFinished":"2019-01-18T15:42:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:206"},{"text":"%md\nOn peut tester cette function pour telecharger en local le *masterfilelist* GDELT. Sur quelle machine ce fichier sera stocque ? ","user":"anonymous","dateUpdated":"2019-01-18T14:37:20+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>On peut tester cette function pour telecharger en local le <em>masterfilelist</em> GDELT. Sur quelle machine ce fichier sera stocque ?</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1547822240022_-1354165598","id":"20181212-101024_1671681559","dateCreated":"2019-01-18T14:37:20+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:207"},{"text":"fileDownloader(\"http://data.gdeltproject.org/gdeltv2/masterfilelist-translation.txt\", \"/mnt/tmp/masterfilelist-translation.txt\") // save the list file to the Spark Master","user":"anonymous","dateUpdated":"2019-01-18T14:38:40+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res6: Any = \"\"\n"}]},"apps":[],"jobName":"paragraph_1547822240023_1507581541","id":"20181209-162121_1695304399","dateCreated":"2019-01-18T14:37:20+0000","dateStarted":"2019-01-18T14:38:40+0000","dateFinished":"2019-01-18T14:38:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:208"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1547826010327_-1743241039","id":"20190118-154010_418525843","dateCreated":"2019-01-18T15:40:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1656","text":"fileDownloader(\"https://www.gdeltproject.org/data/lookups/CAMEO.eventcodes.txt\", \"/mnt/tmp/CAMEO.eventcodes.txt\")","dateUpdated":"2019-01-18T15:43:10+0000","dateFinished":"2019-01-18T15:43:11+0000","dateStarted":"2019-01-18T15:43:10+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res5: Any = \"\"\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1547826331595_1759432498","id":"20190118-154531_1971811285","dateCreated":"2019-01-18T15:45:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2219","text":"fileDownloader(\"https://www.gdeltproject.org/data/lookups/FIPS.country.txt\", \"/mnt/tmp/FIPS.country.txt\")","dateUpdated":"2019-01-18T15:45:58+0000","dateFinished":"2019-01-18T15:45:59+0000","dateStarted":"2019-01-18T15:45:58+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res15: Any = \"\"\n"}]}},{"text":"%md\nOn peut verifier que le fichier a bien ete telecharge","user":"anonymous","dateUpdated":"2019-01-18T14:37:20+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>On peut verifier que le fichier a bien ete telecharge</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1547822240024_-1821826354","id":"20181212-101108_352331024","dateCreated":"2019-01-18T14:37:20+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:209"},{"text":"%sh\nls -lrth /mnt/tmp |grep masterfilelist","user":"anonymous","dateUpdated":"2019-01-18T14:37:20+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"-rw-r--r--  1 zeppelin zeppelin  41M Dec 12 09:54 masterfilelist.txt\n"}]},"apps":[],"jobName":"paragraph_1547822240024_-1289832508","id":"20181210-111357_801203770","dateCreated":"2019-01-18T14:37:20+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:210"},{"text":"%md\nNous allons uploader le *masterfilelist.txt* dans notre bucket S3 via l'api scala AWS","user":"anonymous","dateUpdated":"2019-01-18T14:37:20+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Nous allons uploader le <em>masterfilelist.txt</em> dans notre bucket S3 via l&rsquo;api scala AWS</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1547822240025_1120437377","id":"20181212-101200_46908780","dateCreated":"2019-01-18T14:37:20+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:211"},{"text":"import com.amazonaws.services.s3.AmazonS3Client\nimport com.amazonaws.auth.BasicAWSCredentials\n    \nval AWS_ID = \"AKIAJHC6TXFZCDOGODGQ\"\nval AWS_KEY = \"92yLIKXBJBjIxF8+3oYe80+4IuvOsOErt6qd23dE\"\nval awsClient = new AmazonS3Client(new BasicAWSCredentials(AWS_ID, AWS_KEY))\n\nsc.hadoopConfiguration.set(\"fs.s3a.access.key\",AWS_ID) // mettre votre ID du fichier credentials.csv\nsc.hadoopConfiguration.set(\"fs.s3a.secret.key\", AWS_KEY) // mettre votre secret du fichier credentials.csv\nspark.sparkContext.hadoopConfiguration.set(\"fs.s3a.connection.maximum\",\"1000\")\n\nawsClient.putObject(\"stephane-mulard-telecom-gdelt2018\", \"masterfilelist-translation.txt\", new File( \"/mnt/tmp/masterfilelist-translation.txt\") )\n","user":"anonymous","dateUpdated":"2019-01-18T15:44:34+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import com.amazonaws.services.s3.AmazonS3Client\nimport com.amazonaws.auth.BasicAWSCredentials\nAWS_ID: String = AKIAJHC6TXFZCDOGODGQ\nAWS_KEY: String = 92yLIKXBJBjIxF8+3oYe80+4IuvOsOErt6qd23dE\nwarning: there was one deprecation warning; re-run with -deprecation for details\nawsClient: com.amazonaws.services.s3.AmazonS3Client = com.amazonaws.services.s3.AmazonS3Client@46f70e9a\n"}]},"apps":[],"jobName":"paragraph_1547822240025_223102278","id":"20181212-095117_1356104178","dateCreated":"2019-01-18T14:37:20+0000","dateStarted":"2019-01-18T15:44:18+0000","dateFinished":"2019-01-18T15:44:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:212"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1547826219483_-1942308760","id":"20190118-154339_144624470","dateCreated":"2019-01-18T15:43:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2097","text":"awsClient.putObject(\"stephane-mulard-telecom-gdelt2018\", \"CAMEO.eventcodes.txt\", new File( \"/mnt/tmp/CAMEO.eventcodes.txt\") )","dateUpdated":"2019-01-18T15:44:23+0000","dateFinished":"2019-01-18T15:44:24+0000","dateStarted":"2019-01-18T15:44:23+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res12: com.amazonaws.services.s3.model.PutObjectResult = com.amazonaws.services.s3.model.PutObjectResult@4174708d\n"}]}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1547826370343_-1516290107","id":"20190118-154610_353018657","dateCreated":"2019-01-18T15:46:10+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2316","text":"awsClient.putObject(\"stephane-mulard-telecom-gdelt2018\", \"FIPS.country.txt\", new File( \"/mnt/tmp/FIPS.country.txt\") )","dateUpdated":"2019-01-18T15:46:28+0000","dateFinished":"2019-01-18T15:46:29+0000","dateStarted":"2019-01-18T15:46:28+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res17: com.amazonaws.services.s3.model.PutObjectResult = com.amazonaws.services.s3.model.PutObjectResult@65f9e2cc\n"}]}},{"text":"%md Verifions que le fichier a bien ete uploade dans le bucket S3 via un dataframe Spark","user":"anonymous","dateUpdated":"2019-01-18T14:37:20+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Verifions que le fichier a bien ete uploade dans le bucket S3 via un dataframe Spark</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1547822240025_-845365789","id":"20181212-101258_954978327","dateCreated":"2019-01-18T14:37:20+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:213"},{"text":"import org.apache.spark.sql.SQLContext\n\nval sqlContext = new SQLContext(sc)\nval filesDF = sqlContext.read.\n                    option(\"delimiter\",\" \").\n                    option(\"infer_schema\",\"true\").\n                    csv(\"s3a://stephane-mulard-telecom-gdelt2018/masterfilelist-translation.txt\").\n                    withColumnRenamed(\"_c0\",\"size\").\n                    withColumnRenamed(\"_c1\",\"hash\").\n                    withColumnRenamed(\"_c2\",\"url\").\n                    cache","user":"anonymous","dateUpdated":"2019-01-18T14:43:16+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.SQLContext\nwarning: there was one deprecation warning; re-run with -deprecation for details\nsqlContext: org.apache.spark.sql.SQLContext = org.apache.spark.sql.SQLContext@47e4a055\nfilesDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [size: string, hash: string ... 1 more field]\n"}]},"runtimeInfos":{},"apps":[],"jobName":"paragraph_1547822240026_-2066798796","id":"20181209-163052_14263535","dateCreated":"2019-01-18T14:37:20+0000","dateStarted":"2019-01-18T14:43:16+0000","dateFinished":"2019-01-18T14:43:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:214"},{"text":"filesDF.show(false)","user":"anonymous","dateUpdated":"2019-01-18T14:43:40+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+--------------------------------+--------------------------------------------------------------------------------+\n|size   |hash                            |url                                                                             |\n+-------+--------------------------------+--------------------------------------------------------------------------------+\n|49305  |18f9b16f0bc6b1e203b963264b7c90f1|http://data.gdeltproject.org/gdeltv2/20150218224500.translation.export.CSV.zip  |\n|133082 |d019304ace29aec800f688b616fceb06|http://data.gdeltproject.org/gdeltv2/20150218224500.translation.mentions.CSV.zip|\n|9117874|fb4bb6d180eb8cde5825a8e6dbab1865|http://data.gdeltproject.org/gdeltv2/20150218224500.translation.gkg.csv.zip     |\n|59173  |b634baabd40fbe078f723829e7e4639f|http://data.gdeltproject.org/gdeltv2/20150218230000.translation.export.CSV.zip  |\n|151173 |19921c77b5d898f313ded534fdc1cd61|http://data.gdeltproject.org/gdeltv2/20150218230000.translation.mentions.CSV.zip|\n|9347350|db36bcb7337c67995cf642cff397a449|http://data.gdeltproject.org/gdeltv2/20150218230000.translation.gkg.csv.zip     |\n|61560  |438901a1a6b75d89c7475e0740a78d74|http://data.gdeltproject.org/gdeltv2/20150218231500.translation.export.CSV.zip  |\n|128215 |943cfb011bed59bf6957e20ca59e87f3|http://data.gdeltproject.org/gdeltv2/20150218231500.translation.mentions.CSV.zip|\n|9637181|1e345742a552d8251dc1b4c991a56f8f|http://data.gdeltproject.org/gdeltv2/20150218231500.translation.gkg.csv.zip     |\n|49096  |9d763e90b5a57a90e0600f37ba067c14|http://data.gdeltproject.org/gdeltv2/20150218233000.translation.export.CSV.zip  |\n|113273 |ef8af93958669cc1124dc77c52e852a6|http://data.gdeltproject.org/gdeltv2/20150218233000.translation.mentions.CSV.zip|\n|8590990|71271dcb812a1581fddb38ff803d1a51|http://data.gdeltproject.org/gdeltv2/20150218233000.translation.gkg.csv.zip     |\n|54081  |defacc35f0e858bc87bd09619aa6fdfa|http://data.gdeltproject.org/gdeltv2/20150218234500.translation.export.CSV.zip  |\n|127165 |ca78766b7499a649f6d5408b63ad65a2|http://data.gdeltproject.org/gdeltv2/20150218234500.translation.mentions.CSV.zip|\n|9016447|da1dbe6c4989fdc48fe45ddbfa320387|http://data.gdeltproject.org/gdeltv2/20150218234500.translation.gkg.csv.zip     |\n|132648 |84ac55ff9e0dcf91a044ea9e2c972ad8|http://data.gdeltproject.org/gdeltv2/20150219000000.translation.export.CSV.zip  |\n|111309 |9059cd44cfc0a2e38e39a5974ca614a6|http://data.gdeltproject.org/gdeltv2/20150219000000.translation.mentions.CSV.zip|\n|8564348|9c0b6080979f107dee9f9126ac78e1a0|http://data.gdeltproject.org/gdeltv2/20150219000000.translation.gkg.csv.zip     |\n|121175 |076734aa904bb95533ff06ffe34738a5|http://data.gdeltproject.org/gdeltv2/20150219001500.translation.export.CSV.zip  |\n|122744 |d65f88aea37ca71902f519ea5e0859d7|http://data.gdeltproject.org/gdeltv2/20150219001500.translation.mentions.CSV.zip|\n+-------+--------------------------------+--------------------------------------------------------------------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{},"apps":[],"jobName":"paragraph_1547822240026_-2105776830","id":"20181209-185148_142944415","dateCreated":"2019-01-18T14:37:20+0000","dateStarted":"2019-01-18T14:43:40+0000","dateFinished":"2019-01-18T14:43:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:215"},{"text":"%md Par la suite on va charger uniquement les fichiers qui correspond a la journee du 1er decembre 2018","user":"anonymous","dateUpdated":"2019-01-18T14:37:20+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Par la suite on va charger uniquement les fichiers qui correspond a la journee du 1er decembre 2018</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1547822240027_-178353274","id":"20181212-101345_616653479","dateCreated":"2019-01-18T14:37:20+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:216"},{"text":"val sampleDF = filesDF.filter(col(\"url\").contains(\"/2018\"))\n\n","user":"anonymous","dateUpdated":"2019-01-18T14:48:52+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"sampleDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [size: string, hash: string ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1547822240027_-1166477482","id":"20181209-162427_816541907","dateCreated":"2019-01-18T14:37:20+0000","dateStarted":"2019-01-18T14:48:52+0000","dateFinished":"2019-01-18T14:48:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:217"},{"text":"val exporttrans = sampleDF.filter(col(\"url\").contains(\"export\"))\nexporttrans.show(false)","user":"anonymous","dateUpdated":"2019-01-18T14:50:32+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"exporttrans: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [size: string, hash: string ... 1 more field]\n+-----+--------------------------------+------------------------------------------------------------------------------+\n|size |hash                            |url                                                                           |\n+-----+--------------------------------+------------------------------------------------------------------------------+\n|75981|f193cffcb50694199bef1f45a3480c8c|http://data.gdeltproject.org/gdeltv2/20180101000000.translation.export.CSV.zip|\n|46109|8e21f8105843691a40766dae417c91b7|http://data.gdeltproject.org/gdeltv2/20180101001500.translation.export.CSV.zip|\n|43973|c5c365e81622b8f9f196105143970dd2|http://data.gdeltproject.org/gdeltv2/20180101003000.translation.export.CSV.zip|\n|54822|c3ff344f77889191e2087b1a2e33f0b9|http://data.gdeltproject.org/gdeltv2/20180101004500.translation.export.CSV.zip|\n|33184|27370b6b6feab5cafbf26f2fef75e2c4|http://data.gdeltproject.org/gdeltv2/20180101010000.translation.export.CSV.zip|\n|44304|e6cd1c52411dc441420f411e67670d36|http://data.gdeltproject.org/gdeltv2/20180101011500.translation.export.CSV.zip|\n|35381|9eeacced3378bc88945ab527cdc8ee62|http://data.gdeltproject.org/gdeltv2/20180101013000.translation.export.CSV.zip|\n|36583|b46af2846bcf4f159805c99ca64fe726|http://data.gdeltproject.org/gdeltv2/20180101014500.translation.export.CSV.zip|\n|27154|e9a43e11faa62f53f84736d9de57288f|http://data.gdeltproject.org/gdeltv2/20180101020000.translation.export.CSV.zip|\n|30525|81327a4fdc6ced2b54689750e6979bd9|http://data.gdeltproject.org/gdeltv2/20180101021500.translation.export.CSV.zip|\n|27946|a149a378e196b6a98231d5259e405637|http://data.gdeltproject.org/gdeltv2/20180101023000.translation.export.CSV.zip|\n|26677|36e42b70f6ddd2bac87016804be8fed1|http://data.gdeltproject.org/gdeltv2/20180101024500.translation.export.CSV.zip|\n|23645|a8988b334e3d7175a083ecfddffee9fc|http://data.gdeltproject.org/gdeltv2/20180101030000.translation.export.CSV.zip|\n|25114|4e48eb4173920a5553d1214b0b4fcc04|http://data.gdeltproject.org/gdeltv2/20180101031500.translation.export.CSV.zip|\n|24476|f249e4e6e71a19d7edb8a6e6bcd7686b|http://data.gdeltproject.org/gdeltv2/20180101033000.translation.export.CSV.zip|\n|21331|f79b6ea2ff81adec11adaab983a8ce37|http://data.gdeltproject.org/gdeltv2/20180101034500.translation.export.CSV.zip|\n|26942|399a4488ea077b9275b81abfab5b97c5|http://data.gdeltproject.org/gdeltv2/20180101040000.translation.export.CSV.zip|\n|24599|2406258fdf90412da1a73f1b9b424c1d|http://data.gdeltproject.org/gdeltv2/20180101041500.translation.export.CSV.zip|\n|22825|2776f897ab01d3ba29048bd53dd135a3|http://data.gdeltproject.org/gdeltv2/20180101043000.translation.export.CSV.zip|\n|22555|e590ff2a607341a836c1eba7bae067f5|http://data.gdeltproject.org/gdeltv2/20180101044500.translation.export.CSV.zip|\n+-----+--------------------------------+------------------------------------------------------------------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{},"apps":[],"jobName":"paragraph_1547822240028_-1993201206","id":"20181209-184529_2045997321","dateCreated":"2019-01-18T14:37:20+0000","dateStarted":"2019-01-18T14:50:32+0000","dateFinished":"2019-01-18T14:50:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:218"},{"text":"%md Nous allons charger tous ces fichiers dans le bucket S3 via un ETL Spark:","user":"anonymous","dateUpdated":"2019-01-18T14:37:20+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Nous allons charger tous ces fichiers dans le bucket S3 via un ETL Spark:</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1547822240028_1103743898","id":"20181212-101426_1390220831","dateCreated":"2019-01-18T14:37:20+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:219"},{"text":"\n\nobject AwsClient{\n    val s3 = new AmazonS3Client(new BasicAWSCredentials(AWS_ID, AWS_KEY))\n}\n\n\nexporttrans.select(\"url\").repartition(100).foreach( r=> {\n            val URL = r.getAs[String](0)\n            val fileName = r.getAs[String](0).split(\"/\").last\n            val dir = \"/mnt/tmp/\"\n            val localFileName = dir + fileName\n            fileDownloader(URL,  localFileName)\n            val localFile = new File(localFileName)\n            AwsClient.s3.putObject(\"stephane-mulard-telecom-gdelt2018\", fileName, localFile )\n            localFile.delete()\n            \n})","user":"anonymous","dateUpdated":"2019-01-18T14:51:37+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\ndefined object AwsClient\n"}]},"runtimeInfos":{},"apps":[],"jobName":"paragraph_1547822240029_4336027","id":"20181209-163933_1336720866","dateCreated":"2019-01-18T14:37:20+0000","dateStarted":"2019-01-18T14:51:37+0000","dateFinished":"2019-01-18T14:55:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:220"},{"text":"val mentiontrans = sampleDF.filter(col(\"url\").contains(\"mention\"))\nmentiontrans.show(false)","user":"anonymous","dateUpdated":"2019-01-18T14:56:22+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"mentiontrans: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [size: string, hash: string ... 1 more field]\n+-----+--------------------------------+--------------------------------------------------------------------------------+\n|size |hash                            |url                                                                             |\n+-----+--------------------------------+--------------------------------------------------------------------------------+\n|58751|61426577d41e3659d0cc734c217d88de|http://data.gdeltproject.org/gdeltv2/20180101000000.translation.mentions.CSV.zip|\n|47436|bb2819bb886c1591bb21dad65651b522|http://data.gdeltproject.org/gdeltv2/20180101001500.translation.mentions.CSV.zip|\n|43782|7827f86edc670e4e723b1211c0677552|http://data.gdeltproject.org/gdeltv2/20180101003000.translation.mentions.CSV.zip|\n|59142|9040a674def84595bdb419cc3a791950|http://data.gdeltproject.org/gdeltv2/20180101004500.translation.mentions.CSV.zip|\n|36967|213fa4bae9e93959accdc1eb18f1dd27|http://data.gdeltproject.org/gdeltv2/20180101010000.translation.mentions.CSV.zip|\n|51308|f26da164f056ff196fcaee52f607759e|http://data.gdeltproject.org/gdeltv2/20180101011500.translation.mentions.CSV.zip|\n|46063|359855ecc9b7eb0ed4a634b165d14b21|http://data.gdeltproject.org/gdeltv2/20180101013000.translation.mentions.CSV.zip|\n|47793|c7740cbc2a061b0c0aa2b988f3cd9a8e|http://data.gdeltproject.org/gdeltv2/20180101014500.translation.mentions.CSV.zip|\n|40088|1bb8649e7ce439c22d01e02a6e095084|http://data.gdeltproject.org/gdeltv2/20180101020000.translation.mentions.CSV.zip|\n|42222|41ca33a39b29416e7a6379ca56732cfa|http://data.gdeltproject.org/gdeltv2/20180101021500.translation.mentions.CSV.zip|\n|36620|f44869d7de359443ca16b33bab62bdfd|http://data.gdeltproject.org/gdeltv2/20180101023000.translation.mentions.CSV.zip|\n|34946|57127048e321c01e1e93560cd07c4622|http://data.gdeltproject.org/gdeltv2/20180101024500.translation.mentions.CSV.zip|\n|33172|b09403e8db7da42f9e8e3f7f37628bc6|http://data.gdeltproject.org/gdeltv2/20180101030000.translation.mentions.CSV.zip|\n|34516|eb8bdc22194b7460f4dc1268e7741293|http://data.gdeltproject.org/gdeltv2/20180101031500.translation.mentions.CSV.zip|\n|32944|e8769ac8828dd1b431634c8c8ec82aad|http://data.gdeltproject.org/gdeltv2/20180101033000.translation.mentions.CSV.zip|\n|35601|e5d4f5d910ab640e3f218dbbb96151de|http://data.gdeltproject.org/gdeltv2/20180101034500.translation.mentions.CSV.zip|\n|42115|66b11499bde9f645dc78a48a3f8510fe|http://data.gdeltproject.org/gdeltv2/20180101040000.translation.mentions.CSV.zip|\n|27921|f503daed27b19843db67928cf2a5493c|http://data.gdeltproject.org/gdeltv2/20180101041500.translation.mentions.CSV.zip|\n|35798|f6817ff1a74a06bb12bf6a25381d3c4c|http://data.gdeltproject.org/gdeltv2/20180101043000.translation.mentions.CSV.zip|\n|31271|db901c038228f3aeea2e14a7b230e8e9|http://data.gdeltproject.org/gdeltv2/20180101044500.translation.mentions.CSV.zip|\n+-----+--------------------------------+--------------------------------------------------------------------------------+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{},"apps":[],"jobName":"paragraph_1547823362944_-1012738064","id":"20190118-145602_328824791","dateCreated":"2019-01-18T14:56:02+0000","dateStarted":"2019-01-18T14:56:22+0000","dateFinished":"2019-01-18T14:56:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:221"},{"text":"object AwsClient{\n    val s3 = new AmazonS3Client(new BasicAWSCredentials(AWS_ID, AWS_KEY))\n}\n\n\nmentiontrans.select(\"url\").repartition(100).foreach( r=> {\n            val URL = r.getAs[String](0)\n            val fileName = r.getAs[String](0).split(\"/\").last\n            val dir = \"/mnt/tmp/\"\n            val localFileName = dir + fileName\n            fileDownloader(URL,  localFileName)\n            val localFile = new File(localFileName)\n            AwsClient.s3.putObject(\"stephane-mulard-telecom-gdelt2018\", fileName, localFile )\n            localFile.delete()\n            \n})","user":"anonymous","dateUpdated":"2019-01-18T14:57:14+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\ndefined object AwsClient\n"}]},"runtimeInfos":{},"apps":[],"jobName":"paragraph_1547823399986_-731136432","id":"20190118-145639_1362117179","dateCreated":"2019-01-18T14:56:39+0000","dateStarted":"2019-01-18T14:57:14+0000","dateFinished":"2019-01-18T15:02:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:222"}],"name":"gdeltETL-Web-S3","id":"2E3RUQCT1","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}